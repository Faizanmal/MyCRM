[{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\EXAMPLE_ENHANCED_LOGIN.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\eslint.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\next.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\postcss.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\public\\sw.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\advanced-reporting\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\ai-assistant\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\ai-insights\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\analytics\\enterprise\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\analytics\\pipeline\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\api\\ai\\chat\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'context' is defined but never used.","line":170,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":170,"endColumn":10}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * AI Chat API Route\r\n * ==================\r\n * \r\n * AI assistant chat endpoint with context-aware responses\r\n */\r\n\r\nimport { NextRequest, NextResponse } from 'next/server';\r\n\r\nconst AI_SERVICE_URL = process.env.AI_SERVICE_URL || 'http://localhost:8000/api/ai';\r\n\r\ninterface ChatRequest {\r\n  message: string;\r\n  context?: {\r\n    leadId?: string;\r\n    contactId?: string;\r\n    opportunityId?: string;\r\n    dealValue?: number;\r\n    companyName?: string;\r\n    contactName?: string;\r\n  };\r\n  history?: {\r\n    role: 'user' | 'assistant';\r\n    content: string;\r\n  }[];\r\n}\r\n\r\ninterface AIAction {\r\n  id: string;\r\n  label: string;\r\n  icon: string;\r\n  action: string;\r\n  params?: Record<string, unknown>;\r\n}\r\n\r\ninterface ChatResponse {\r\n  response: string;\r\n  type?: 'text' | 'email' | 'summary' | 'insights' | 'meeting_prep';\r\n  suggestions?: string[];\r\n  actions?: AIAction[];\r\n  metadata?: Record<string, unknown>;\r\n}\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const body: ChatRequest = await request.json();\r\n    const authHeader = request.headers.get('authorization');\r\n\r\n    if (!authHeader) {\r\n      return NextResponse.json(\r\n        { error: 'Authentication required' },\r\n        { status: 401 }\r\n      );\r\n    }\r\n\r\n    // Analyze intent from message\r\n    const intent = analyzeIntent(body.message);\r\n\r\n    // Forward to AI service\r\n    const response = await fetch(`${AI_SERVICE_URL}/chat/`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        Authorization: authHeader,\r\n      },\r\n      body: JSON.stringify({\r\n        message: body.message,\r\n        context: body.context,\r\n        history: body.history,\r\n        intent,\r\n      }),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      // Fallback to local processing if AI service is unavailable\r\n      const fallbackResponse = generateFallbackResponse(body.message, intent);\r\n      return NextResponse.json(fallbackResponse);\r\n    }\r\n\r\n    const data: ChatResponse = await response.json();\r\n\r\n    // Enhance response with suggestions based on intent\r\n    const enhancedResponse = {\r\n      ...data,\r\n      suggestions: data.suggestions || generateSuggestions(intent, body.context),\r\n      actions: data.actions || generateActions(intent, body.context),\r\n    };\r\n\r\n    return NextResponse.json(enhancedResponse);\r\n  } catch (error) {\r\n    console.error('[AI Chat] Error:', error);\r\n    return NextResponse.json(\r\n      {\r\n        response: \"I'm sorry, I encountered an error. Please try again.\",\r\n        type: 'text',\r\n        suggestions: ['Try again', 'Ask a different question'],\r\n      },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n\r\n// Intent analysis\r\ntype Intent = \r\n  | 'draft_email'\r\n  | 'meeting_prep'\r\n  | 'deal_analysis'\r\n  | 'ai_insights'\r\n  | 'task_management'\r\n  | 'search'\r\n  | 'general';\r\n\r\nfunction analyzeIntent(message: string): Intent {\r\n  const lowerMessage = message.toLowerCase();\r\n\r\n  if (\r\n    lowerMessage.includes('email') ||\r\n    lowerMessage.includes('draft') ||\r\n    lowerMessage.includes('write')\r\n  ) {\r\n    return 'draft_email';\r\n  }\r\n\r\n  if (\r\n    lowerMessage.includes('meeting') ||\r\n    lowerMessage.includes('prepare') ||\r\n    lowerMessage.includes('agenda')\r\n  ) {\r\n    return 'meeting_prep';\r\n  }\r\n\r\n  if (\r\n    lowerMessage.includes('deal') ||\r\n    lowerMessage.includes('analysis') ||\r\n    lowerMessage.includes('opportunity')\r\n  ) {\r\n    return 'deal_analysis';\r\n  }\r\n\r\n  if (\r\n    lowerMessage.includes('insight') ||\r\n    lowerMessage.includes('predict') ||\r\n    lowerMessage.includes('forecast')\r\n  ) {\r\n    return 'ai_insights';\r\n  }\r\n\r\n  if (\r\n    lowerMessage.includes('task') ||\r\n    lowerMessage.includes('remind') ||\r\n    lowerMessage.includes('schedule')\r\n  ) {\r\n    return 'task_management';\r\n  }\r\n\r\n  if (\r\n    lowerMessage.includes('find') ||\r\n    lowerMessage.includes('search') ||\r\n    lowerMessage.includes('look for')\r\n  ) {\r\n    return 'search';\r\n  }\r\n\r\n  return 'general';\r\n}\r\n\r\n// Generate suggestions based on intent\r\nfunction generateSuggestions(\r\n  intent: Intent,\r\n  context?: ChatRequest['context']\r\n): string[] {\r\n  const suggestionMap: Record<Intent, string[]> = {\r\n    draft_email: [\r\n      'Make it more formal',\r\n      'Add a call-to-action',\r\n      'Shorten the email',\r\n      'Add a follow-up date',\r\n    ],\r\n    meeting_prep: [\r\n      'Add talking points',\r\n      'Include recent activities',\r\n      'Generate questions to ask',\r\n      'Create an agenda',\r\n    ],\r\n    deal_analysis: [\r\n      'Show win probability',\r\n      'Compare to similar deals',\r\n      'List risk factors',\r\n      'Suggest next steps',\r\n    ],\r\n    ai_insights: [\r\n      'Show churn risk',\r\n      'Revenue forecast',\r\n      'Lead scoring analysis',\r\n      'Activity recommendations',\r\n    ],\r\n    task_management: [\r\n      'Create a task',\r\n      'Set a reminder',\r\n      'Show my tasks',\r\n      'Prioritize tasks',\r\n    ],\r\n    search: [\r\n      'Search by company',\r\n      'Find recent deals',\r\n      'Show active leads',\r\n      'Filter by stage',\r\n    ],\r\n    general: [\r\n      'Draft a follow-up email',\r\n      'Prepare for my next meeting',\r\n      'Analyze this deal',\r\n      'Show AI insights',\r\n    ],\r\n  };\r\n\r\n  return suggestionMap[intent] || suggestionMap.general;\r\n}\r\n\r\n// Generate actions based on intent\r\nfunction generateActions(\r\n  intent: Intent,\r\n  context?: ChatRequest['context']\r\n): AIAction[] {\r\n  const actions: AIAction[] = [];\r\n\r\n  if (intent === 'draft_email' || intent === 'meeting_prep') {\r\n    actions.push({\r\n      id: 'copy',\r\n      label: 'Copy to clipboard',\r\n      icon: 'copy',\r\n      action: 'copy',\r\n    });\r\n\r\n    if (intent === 'draft_email') {\r\n      actions.push({\r\n        id: 'send',\r\n        label: 'Open in email',\r\n        icon: 'mail',\r\n        action: 'open_email',\r\n      });\r\n    }\r\n  }\r\n\r\n  if (context?.leadId || context?.contactId) {\r\n    actions.push({\r\n      id: 'view',\r\n      label: 'View profile',\r\n      icon: 'user',\r\n      action: 'navigate',\r\n      params: {\r\n        type: context.leadId ? 'lead' : 'contact',\r\n        id: context.leadId || context.contactId,\r\n      },\r\n    });\r\n  }\r\n\r\n  if (intent === 'task_management') {\r\n    actions.push({\r\n      id: 'create_task',\r\n      label: 'Create task',\r\n      icon: 'plus',\r\n      action: 'create_task',\r\n    });\r\n  }\r\n\r\n  return actions;\r\n}\r\n\r\n// Fallback response when AI service is unavailable\r\nfunction generateFallbackResponse(message: string, intent: Intent): ChatResponse {\r\n  const responses: Record<Intent, string> = {\r\n    draft_email: `I'd be happy to help you draft an email. Here's a template you can customize:\\n\\nSubject: Follow-up from our conversation\\n\\nHi [Name],\\n\\nThank you for taking the time to speak with me. I wanted to follow up on our discussion about [topic].\\n\\n[Add your key points here]\\n\\nPlease let me know if you have any questions or would like to schedule a follow-up call.\\n\\nBest regards,\\n[Your name]`,\r\n    meeting_prep: `Here's a meeting preparation checklist:\\n\\n1. **Review recent interactions** - Check emails, calls, and notes\\n2. **Understand their needs** - What problems are they trying to solve?\\n3. **Prepare talking points** - Key benefits and value propositions\\n4. **Anticipate questions** - Have answers ready for common objections\\n5. **Set clear objectives** - What do you want to achieve from this meeting?\\n\\nWould you like me to help with any specific aspect?`,\r\n    deal_analysis: `To analyze this deal effectively, I would typically look at:\\n\\n• **Deal stage** and time in stage\\n• **Engagement level** - Recent activities and responses\\n• **Decision timeline** - Urgency and key dates\\n• **Competition** - Other vendors being considered\\n• **Budget confirmation** - Has budget been allocated?\\n\\nWould you like me to focus on any specific area?`,\r\n    ai_insights: `Here are the types of insights I can provide:\\n\\n• **Lead scoring** - Prioritize your best opportunities\\n• **Churn prediction** - Identify at-risk accounts\\n• **Revenue forecast** - Predict future performance\\n• **Activity recommendations** - Optimize your outreach\\n\\nWhat would you like to explore?`,\r\n    task_management: `I can help you manage tasks! Here are some options:\\n\\n• Create a new task\\n• View your upcoming tasks\\n• Set a reminder\\n• Prioritize your to-do list\\n\\nWhat would you like to do?`,\r\n    search: `I can help you find information in your CRM. What would you like to search for?\\n\\n• Leads by company or industry\\n• Contacts by name or role\\n• Deals by stage or value\\n• Activities by date or type`,\r\n    general: `I'm here to help! I can assist you with:\\n\\n• **Email drafting** - Create professional follow-ups\\n• **Meeting prep** - Prepare for upcoming calls\\n• **Deal analysis** - Understand opportunity health\\n• **AI insights** - Get predictive analytics\\n\\nWhat would you like to do?`,\r\n  };\r\n\r\n  return {\r\n    response: responses[intent],\r\n    type: 'text',\r\n    suggestions: generateSuggestions(intent),\r\n    actions: [],\r\n  };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\api\\graphql\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\api\\health\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\campaigns\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\collaboration\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\communications\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\compliance\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\contacts\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\conversation-intelligence\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\customer-success\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\dashboard\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\data-enrichment\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'XCircle' is defined but never used.","line":22,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Phone' is defined but never used.","line":27,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":27,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Globe' is defined but never used.","line":28,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":28,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Twitter' is defined but never used.","line":30,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":30,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Search' is defined but never used.","line":39,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":39,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'loading' is assigned a value but never used.","line":117,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":117,"endColumn":17},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`fetchData` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nE:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\data-enrichment\\page.tsx:122:5\n  120 |\n  121 |   useEffect(() => {\n> 122 |     fetchData();\n      |     ^^^^^^^^^ `fetchData` accessed before it is declared\n  123 |   }, []);\n  124 |\n  125 |   const fetchData = async () => {\n\nE:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\data-enrichment\\page.tsx:125:3\n  123 |   }, []);\n  124 |\n> 125 |   const fetchData = async () => {\n      |   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 126 |     setLoading(true);\n      | ^^^^^^^^^^^^^^^^^^^^^\n> 127 |     try {\n      …\n      | ^^^^^^^^^^^^^^^^^^^^^\n> 146 |     setLoading(false);\n      | ^^^^^^^^^^^^^^^^^^^^^\n> 147 |   };\n      | ^^^^^ `fetchData` is declared here\n  148 |\n  149 |   const loadDemoData = () => {\n  150 |     setProviders([","line":122,"column":5,"nodeType":null,"endLine":122,"endColumn":14},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchData'. Either include it or remove the dependency array.","line":123,"column":6,"nodeType":"ArrayExpression","endLine":123,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [fetchData]","fix":{"range":[3489,3491],"text":"[fetchData]"}}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":334,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":334,"endColumn":19},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":1071,"column":98,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[48104,48172],"text":" records haven&apos;t been updated in 90+ days.\r\n                        "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[48104,48172],"text":" records haven&lsquo;t been updated in 90+ days.\r\n                        "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[48104,48172],"text":" records haven&#39;t been updated in 90+ days.\r\n                        "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[48104,48172],"text":" records haven&rsquo;t been updated in 90+ days.\r\n                        "},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport MainLayout from '@/components/Layout/MainLayout';\r\nimport ProtectedRoute from '@/components/ProtectedRoute';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from '@/components/ui/dialog';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Switch } from '@/components/ui/switch';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { toast } from 'sonner';\r\nimport { \r\n  Database, \r\n  Sparkles, \r\n  RefreshCw, \r\n  CheckCircle2, \r\n  XCircle, \r\n  Clock,\r\n  Building2,\r\n  User,\r\n  Mail,\r\n  Phone,\r\n  Globe,\r\n  Linkedin,\r\n  Twitter,\r\n  AlertTriangle,\r\n  TrendingUp,\r\n  Settings,\r\n  Play,\r\n  Pause,\r\n  BarChart3,\r\n  Target,\r\n  Zap,\r\n  Search,\r\n  Filter,\r\n  Download\r\n} from 'lucide-react';\r\nimport { dataEnrichmentAPI } from '@/lib/ai-workflow-api';\r\n\r\ninterface EnrichmentProvider {\r\n  id: number;\r\n  name: string;\r\n  provider_type: string;\r\n  is_active: boolean;\r\n  priority: number;\r\n  api_endpoint: string;\r\n  success_rate: number;\r\n  average_response_time: number;\r\n  total_requests: number;\r\n  monthly_limit: number;\r\n  requests_this_month: number;\r\n}\r\n\r\ninterface EnrichmentProfile {\r\n  id: number;\r\n  name: string;\r\n  profile_type: string;\r\n  fields_to_enrich: string[];\r\n  auto_enrich: boolean;\r\n  enrichment_triggers: string[];\r\n  priority_score_threshold: number;\r\n  is_active: boolean;\r\n  created_at: string;\r\n  contacts_enriched: number;\r\n  companies_enriched: number;\r\n}\r\n\r\ninterface EnrichmentJob {\r\n  id: number;\r\n  profile_name: string;\r\n  record_type: string;\r\n  status: string;\r\n  total_records: number;\r\n  processed_records: number;\r\n  successful_records: number;\r\n  failed_records: number;\r\n  started_at: string;\r\n  completed_at?: string;\r\n  error_message?: string;\r\n}\r\n\r\ninterface EnrichmentResult {\r\n  id: number;\r\n  contact_name?: string;\r\n  company_name?: string;\r\n  record_type: string;\r\n  provider: string;\r\n  fields_enriched: string[];\r\n  data_quality_score: number;\r\n  enriched_at: string;\r\n  is_verified: boolean;\r\n}\r\n\r\ninterface DataQualityMetrics {\r\n  overall_score: number;\r\n  completeness: number;\r\n  accuracy: number;\r\n  freshness: number;\r\n  consistency: number;\r\n  total_records: number;\r\n  enriched_records: number;\r\n  records_needing_update: number;\r\n}\r\n\r\nexport default function DataEnrichmentPage() {\r\n  const [activeTab, setActiveTab] = useState('overview');\r\n  const [providers, setProviders] = useState<EnrichmentProvider[]>([]);\r\n  const [profiles, setProfiles] = useState<EnrichmentProfile[]>([]);\r\n  const [jobs, setJobs] = useState<EnrichmentJob[]>([]);\r\n  const [results, setResults] = useState<EnrichmentResult[]>([]);\r\n  const [qualityMetrics, setQualityMetrics] = useState<DataQualityMetrics | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [isCreateProfileDialogOpen, setIsCreateProfileDialogOpen] = useState(false);\r\n  const [isConfigProviderDialogOpen, setIsConfigProviderDialogOpen] = useState(false);\r\n\r\n  useEffect(() => {\r\n    fetchData();\r\n  }, []);\r\n\r\n  const fetchData = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const [providersRes, profilesRes, jobsRes] = await Promise.all([\r\n        dataEnrichmentAPI.getProviders().catch(() => ({ data: { results: [] } })),\r\n        dataEnrichmentAPI.getProfiles().catch(() => ({ data: { results: [] } })),\r\n        dataEnrichmentAPI.getJobs().catch(() => ({ data: { results: [] } }))\r\n      ]);\r\n      \r\n      setProviders(providersRes.data.results || []);\r\n      setProfiles(profilesRes.data.results || []);\r\n      setJobs(jobsRes.data.results || []);\r\n      \r\n      // Load demo data if empty\r\n      if ((providersRes.data.results || []).length === 0) {\r\n        loadDemoData();\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to fetch data:', error);\r\n      loadDemoData();\r\n    }\r\n    setLoading(false);\r\n  };\r\n\r\n  const loadDemoData = () => {\r\n    setProviders([\r\n      {\r\n        id: 1,\r\n        name: 'Clearbit',\r\n        provider_type: 'company',\r\n        is_active: true,\r\n        priority: 1,\r\n        api_endpoint: 'https://api.clearbit.com/v2',\r\n        success_rate: 94.5,\r\n        average_response_time: 320,\r\n        total_requests: 15420,\r\n        monthly_limit: 50000,\r\n        requests_this_month: 8750\r\n      },\r\n      {\r\n        id: 2,\r\n        name: 'ZoomInfo',\r\n        provider_type: 'contact',\r\n        is_active: true,\r\n        priority: 1,\r\n        api_endpoint: 'https://api.zoominfo.com/v1',\r\n        success_rate: 91.2,\r\n        average_response_time: 450,\r\n        total_requests: 12300,\r\n        monthly_limit: 25000,\r\n        requests_this_month: 6200\r\n      },\r\n      {\r\n        id: 3,\r\n        name: 'Hunter.io',\r\n        provider_type: 'email',\r\n        is_active: true,\r\n        priority: 2,\r\n        api_endpoint: 'https://api.hunter.io/v2',\r\n        success_rate: 88.7,\r\n        average_response_time: 280,\r\n        total_requests: 8900,\r\n        monthly_limit: 10000,\r\n        requests_this_month: 3400\r\n      },\r\n      {\r\n        id: 4,\r\n        name: 'LinkedIn Sales Navigator',\r\n        provider_type: 'social',\r\n        is_active: false,\r\n        priority: 3,\r\n        api_endpoint: 'https://api.linkedin.com/v2',\r\n        success_rate: 85.3,\r\n        average_response_time: 520,\r\n        total_requests: 4500,\r\n        monthly_limit: 15000,\r\n        requests_this_month: 0\r\n      }\r\n    ]);\r\n\r\n    setProfiles([\r\n      {\r\n        id: 1,\r\n        name: 'High-Value Lead Enrichment',\r\n        profile_type: 'contact',\r\n        fields_to_enrich: ['job_title', 'phone', 'linkedin_url', 'company_size', 'industry'],\r\n        auto_enrich: true,\r\n        enrichment_triggers: ['lead_score_above_70', 'new_contact_created'],\r\n        priority_score_threshold: 70,\r\n        is_active: true,\r\n        created_at: '2024-01-01T00:00:00Z',\r\n        contacts_enriched: 2450,\r\n        companies_enriched: 0\r\n      },\r\n      {\r\n        id: 2,\r\n        name: 'Company Intelligence',\r\n        profile_type: 'company',\r\n        fields_to_enrich: ['revenue', 'employee_count', 'technologies', 'funding_info', 'social_profiles'],\r\n        auto_enrich: true,\r\n        enrichment_triggers: ['new_company_created', 'opportunity_created'],\r\n        priority_score_threshold: 50,\r\n        is_active: true,\r\n        created_at: '2024-01-05T00:00:00Z',\r\n        contacts_enriched: 0,\r\n        companies_enriched: 890\r\n      },\r\n      {\r\n        id: 3,\r\n        name: 'Email Verification',\r\n        profile_type: 'contact',\r\n        fields_to_enrich: ['email_verified', 'email_deliverability'],\r\n        auto_enrich: false,\r\n        enrichment_triggers: ['manual'],\r\n        priority_score_threshold: 0,\r\n        is_active: true,\r\n        created_at: '2024-01-10T00:00:00Z',\r\n        contacts_enriched: 5600,\r\n        companies_enriched: 0\r\n      }\r\n    ]);\r\n\r\n    setJobs([\r\n      {\r\n        id: 1,\r\n        profile_name: 'High-Value Lead Enrichment',\r\n        record_type: 'contact',\r\n        status: 'completed',\r\n        total_records: 250,\r\n        processed_records: 250,\r\n        successful_records: 238,\r\n        failed_records: 12,\r\n        started_at: new Date(Date.now() - 3600000).toISOString(),\r\n        completed_at: new Date(Date.now() - 1800000).toISOString()\r\n      },\r\n      {\r\n        id: 2,\r\n        profile_name: 'Company Intelligence',\r\n        record_type: 'company',\r\n        status: 'running',\r\n        total_records: 150,\r\n        processed_records: 87,\r\n        successful_records: 82,\r\n        failed_records: 5,\r\n        started_at: new Date(Date.now() - 1200000).toISOString()\r\n      },\r\n      {\r\n        id: 3,\r\n        profile_name: 'Email Verification',\r\n        record_type: 'contact',\r\n        status: 'pending',\r\n        total_records: 500,\r\n        processed_records: 0,\r\n        successful_records: 0,\r\n        failed_records: 0,\r\n        started_at: new Date().toISOString()\r\n      }\r\n    ]);\r\n\r\n    setResults([\r\n      {\r\n        id: 1,\r\n        contact_name: 'John Smith',\r\n        record_type: 'contact',\r\n        provider: 'ZoomInfo',\r\n        fields_enriched: ['job_title', 'phone', 'linkedin_url'],\r\n        data_quality_score: 95,\r\n        enriched_at: new Date(Date.now() - 300000).toISOString(),\r\n        is_verified: true\r\n      },\r\n      {\r\n        id: 2,\r\n        company_name: 'TechCorp Inc',\r\n        record_type: 'company',\r\n        provider: 'Clearbit',\r\n        fields_enriched: ['revenue', 'employee_count', 'technologies', 'industry'],\r\n        data_quality_score: 92,\r\n        enriched_at: new Date(Date.now() - 600000).toISOString(),\r\n        is_verified: true\r\n      },\r\n      {\r\n        id: 3,\r\n        contact_name: 'Sarah Johnson',\r\n        record_type: 'contact',\r\n        provider: 'Hunter.io',\r\n        fields_enriched: ['email_verified'],\r\n        data_quality_score: 88,\r\n        enriched_at: new Date(Date.now() - 900000).toISOString(),\r\n        is_verified: true\r\n      }\r\n    ]);\r\n\r\n    setQualityMetrics({\r\n      overall_score: 87,\r\n      completeness: 82,\r\n      accuracy: 94,\r\n      freshness: 78,\r\n      consistency: 91,\r\n      total_records: 12500,\r\n      enriched_records: 9800,\r\n      records_needing_update: 1250\r\n    });\r\n  };\r\n\r\n  const triggerEnrichment = async (profileId: number) => {\r\n    try {\r\n      await dataEnrichmentAPI.triggerEnrichment(profileId, 'contact', []);\r\n      toast.success('Enrichment job started');\r\n      fetchData();\r\n    } catch (error) {\r\n      toast.info('Enrichment job queued (demo)');\r\n    }\r\n  };\r\n\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'completed': return 'bg-green-100 text-green-700';\r\n      case 'running': return 'bg-blue-100 text-blue-700';\r\n      case 'pending': return 'bg-yellow-100 text-yellow-700';\r\n      case 'failed': return 'bg-red-100 text-red-700';\r\n      default: return 'bg-gray-100 text-gray-700';\r\n    }\r\n  };\r\n\r\n  const getProviderIcon = (type: string) => {\r\n    switch (type) {\r\n      case 'company': return <Building2 className=\"h-5 w-5\" />;\r\n      case 'contact': return <User className=\"h-5 w-5\" />;\r\n      case 'email': return <Mail className=\"h-5 w-5\" />;\r\n      case 'social': return <Linkedin className=\"h-5 w-5\" />;\r\n      default: return <Database className=\"h-5 w-5\" />;\r\n    }\r\n  };\r\n\r\n  const getQualityColor = (score: number) => {\r\n    if (score >= 90) return 'text-green-600';\r\n    if (score >= 70) return 'text-yellow-600';\r\n    return 'text-red-600';\r\n  };\r\n\r\n  const getProgressColor = (score: number) => {\r\n    if (score >= 90) return 'bg-green-500';\r\n    if (score >= 70) return 'bg-yellow-500';\r\n    return 'bg-red-500';\r\n  };\r\n\r\n  return (\r\n    <ProtectedRoute>\r\n      <MainLayout>\r\n        <div className=\"p-6 space-y-6\">\r\n          {/* Header */}\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <h1 className=\"text-3xl font-bold flex items-center gap-2\">\r\n                <Database className=\"h-8 w-8 text-emerald-600\" />\r\n                Data Enrichment\r\n              </h1>\r\n              <p className=\"text-gray-500 mt-1\">\r\n                AI-powered data enrichment and quality management\r\n              </p>\r\n            </div>\r\n            <div className=\"flex gap-3\">\r\n              <Button variant=\"outline\" onClick={fetchData}>\r\n                <RefreshCw className=\"h-4 w-4 mr-2\" />\r\n                Refresh\r\n              </Button>\r\n              <Dialog open={isCreateProfileDialogOpen} onOpenChange={setIsCreateProfileDialogOpen}>\r\n                <DialogTrigger asChild>\r\n                  <Button>\r\n                    <Sparkles className=\"h-4 w-4 mr-2\" />\r\n                    Create Profile\r\n                  </Button>\r\n                </DialogTrigger>\r\n                <DialogContent className=\"max-w-lg\">\r\n                  <DialogHeader>\r\n                    <DialogTitle>Create Enrichment Profile</DialogTitle>\r\n                    <DialogDescription>\r\n                      Define what data to enrich and when to trigger enrichment\r\n                    </DialogDescription>\r\n                  </DialogHeader>\r\n                  <div className=\"space-y-4 py-4\">\r\n                    <div>\r\n                      <Label>Profile Name</Label>\r\n                      <Input placeholder=\"e.g., Enterprise Lead Enrichment\" />\r\n                    </div>\r\n                    <div>\r\n                      <Label>Profile Type</Label>\r\n                      <Select defaultValue=\"contact\">\r\n                        <SelectTrigger>\r\n                          <SelectValue />\r\n                        </SelectTrigger>\r\n                        <SelectContent>\r\n                          <SelectItem value=\"contact\">Contact</SelectItem>\r\n                          <SelectItem value=\"company\">Company</SelectItem>\r\n                          <SelectItem value=\"both\">Both</SelectItem>\r\n                        </SelectContent>\r\n                      </Select>\r\n                    </div>\r\n                    <div>\r\n                      <Label>Fields to Enrich</Label>\r\n                      <div className=\"flex flex-wrap gap-2 mt-2\">\r\n                        {['job_title', 'phone', 'linkedin_url', 'company_size', 'industry', 'revenue', 'technologies'].map(field => (\r\n                          <Badge key={field} variant=\"outline\" className=\"cursor-pointer hover:bg-gray-100\">\r\n                            {field.replace('_', ' ')}\r\n                          </Badge>\r\n                        ))}\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div>\r\n                        <Label>Auto-Enrich</Label>\r\n                        <p className=\"text-sm text-gray-500\">Automatically enrich matching records</p>\r\n                      </div>\r\n                      <Switch />\r\n                    </div>\r\n                    <div>\r\n                      <Label>Priority Score Threshold</Label>\r\n                      <Input type=\"number\" defaultValue={50} min={0} max={100} />\r\n                      <p className=\"text-xs text-gray-500 mt-1\">Only enrich records with score above this threshold</p>\r\n                    </div>\r\n                    <Button className=\"w-full\">Create Profile</Button>\r\n                  </div>\r\n                </DialogContent>\r\n              </Dialog>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Stats Cards */}\r\n          <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n            <Card>\r\n              <CardContent className=\"pt-6\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div>\r\n                    <p className=\"text-sm text-gray-500\">Data Quality Score</p>\r\n                    <p className={`text-2xl font-bold ${getQualityColor(qualityMetrics?.overall_score || 0)}`}>\r\n                      {qualityMetrics?.overall_score || 0}%\r\n                    </p>\r\n                  </div>\r\n                  <Target className=\"h-8 w-8 text-emerald-500\" />\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n            <Card>\r\n              <CardContent className=\"pt-6\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div>\r\n                    <p className=\"text-sm text-gray-500\">Records Enriched</p>\r\n                    <p className=\"text-2xl font-bold\">{qualityMetrics?.enriched_records?.toLocaleString() || 0}</p>\r\n                  </div>\r\n                  <CheckCircle2 className=\"h-8 w-8 text-green-500\" />\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n            <Card>\r\n              <CardContent className=\"pt-6\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div>\r\n                    <p className=\"text-sm text-gray-500\">Active Jobs</p>\r\n                    <p className=\"text-2xl font-bold text-blue-600\">\r\n                      {jobs.filter(j => j.status === 'running').length}\r\n                    </p>\r\n                  </div>\r\n                  <RefreshCw className=\"h-8 w-8 text-blue-500 animate-spin\" />\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n            <Card>\r\n              <CardContent className=\"pt-6\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div>\r\n                    <p className=\"text-sm text-gray-500\">Need Update</p>\r\n                    <p className=\"text-2xl font-bold text-yellow-600\">\r\n                      {qualityMetrics?.records_needing_update?.toLocaleString() || 0}\r\n                    </p>\r\n                  </div>\r\n                  <AlertTriangle className=\"h-8 w-8 text-yellow-500\" />\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n\r\n          {/* Main Content Tabs */}\r\n          <Tabs value={activeTab} onValueChange={setActiveTab}>\r\n            <TabsList className=\"grid w-full grid-cols-5\">\r\n              <TabsTrigger value=\"overview\">Overview</TabsTrigger>\r\n              <TabsTrigger value=\"providers\">Providers</TabsTrigger>\r\n              <TabsTrigger value=\"profiles\">Profiles</TabsTrigger>\r\n              <TabsTrigger value=\"jobs\">Jobs</TabsTrigger>\r\n              <TabsTrigger value=\"quality\">Data Quality</TabsTrigger>\r\n            </TabsList>\r\n\r\n            {/* Overview Tab */}\r\n            <TabsContent value=\"overview\" className=\"space-y-6\">\r\n              <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n                {/* Data Quality Overview */}\r\n                <Card>\r\n                  <CardHeader>\r\n                    <CardTitle className=\"flex items-center gap-2\">\r\n                      <BarChart3 className=\"h-5 w-5\" />\r\n                      Data Quality Breakdown\r\n                    </CardTitle>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    {qualityMetrics && (\r\n                      <div className=\"space-y-4\">\r\n                        <div>\r\n                          <div className=\"flex justify-between mb-1\">\r\n                            <span className=\"text-sm\">Completeness</span>\r\n                            <span className={`text-sm font-medium ${getQualityColor(qualityMetrics.completeness)}`}>\r\n                              {qualityMetrics.completeness}%\r\n                            </span>\r\n                          </div>\r\n                          <div className=\"w-full h-2 bg-gray-200 rounded-full\">\r\n                            <div \r\n                              className={`h-full rounded-full ${getProgressColor(qualityMetrics.completeness)}`}\r\n                              style={{ width: `${qualityMetrics.completeness}%` }}\r\n                            />\r\n                          </div>\r\n                        </div>\r\n                        <div>\r\n                          <div className=\"flex justify-between mb-1\">\r\n                            <span className=\"text-sm\">Accuracy</span>\r\n                            <span className={`text-sm font-medium ${getQualityColor(qualityMetrics.accuracy)}`}>\r\n                              {qualityMetrics.accuracy}%\r\n                            </span>\r\n                          </div>\r\n                          <div className=\"w-full h-2 bg-gray-200 rounded-full\">\r\n                            <div \r\n                              className={`h-full rounded-full ${getProgressColor(qualityMetrics.accuracy)}`}\r\n                              style={{ width: `${qualityMetrics.accuracy}%` }}\r\n                            />\r\n                          </div>\r\n                        </div>\r\n                        <div>\r\n                          <div className=\"flex justify-between mb-1\">\r\n                            <span className=\"text-sm\">Freshness</span>\r\n                            <span className={`text-sm font-medium ${getQualityColor(qualityMetrics.freshness)}`}>\r\n                              {qualityMetrics.freshness}%\r\n                            </span>\r\n                          </div>\r\n                          <div className=\"w-full h-2 bg-gray-200 rounded-full\">\r\n                            <div \r\n                              className={`h-full rounded-full ${getProgressColor(qualityMetrics.freshness)}`}\r\n                              style={{ width: `${qualityMetrics.freshness}%` }}\r\n                            />\r\n                          </div>\r\n                        </div>\r\n                        <div>\r\n                          <div className=\"flex justify-between mb-1\">\r\n                            <span className=\"text-sm\">Consistency</span>\r\n                            <span className={`text-sm font-medium ${getQualityColor(qualityMetrics.consistency)}`}>\r\n                              {qualityMetrics.consistency}%\r\n                            </span>\r\n                          </div>\r\n                          <div className=\"w-full h-2 bg-gray-200 rounded-full\">\r\n                            <div \r\n                              className={`h-full rounded-full ${getProgressColor(qualityMetrics.consistency)}`}\r\n                              style={{ width: `${qualityMetrics.consistency}%` }}\r\n                            />\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                  </CardContent>\r\n                </Card>\r\n\r\n                {/* Active Providers */}\r\n                <Card>\r\n                  <CardHeader>\r\n                    <CardTitle className=\"flex items-center gap-2\">\r\n                      <Zap className=\"h-5 w-5\" />\r\n                      Active Providers\r\n                    </CardTitle>\r\n                    <CardDescription>Data enrichment sources</CardDescription>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    <div className=\"space-y-3\">\r\n                      {providers.filter(p => p.is_active).map(provider => (\r\n                        <div key={provider.id} className=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\">\r\n                          <div className=\"flex items-center gap-3\">\r\n                            <div className=\"p-2 bg-white rounded-lg shadow-sm\">\r\n                              {getProviderIcon(provider.provider_type)}\r\n                            </div>\r\n                            <div>\r\n                              <p className=\"font-medium\">{provider.name}</p>\r\n                              <p className=\"text-xs text-gray-500 capitalize\">{provider.provider_type} data</p>\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"text-right\">\r\n                            <p className=\"text-sm font-medium text-green-600\">{provider.success_rate}%</p>\r\n                            <p className=\"text-xs text-gray-500\">success rate</p>\r\n                          </div>\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n\r\n                {/* Recent Enrichments */}\r\n                <Card>\r\n                  <CardHeader>\r\n                    <CardTitle className=\"flex items-center gap-2\">\r\n                      <Clock className=\"h-5 w-5\" />\r\n                      Recent Enrichments\r\n                    </CardTitle>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    <div className=\"space-y-3\">\r\n                      {results.slice(0, 5).map(result => (\r\n                        <div key={result.id} className=\"flex items-center justify-between p-3 border rounded-lg\">\r\n                          <div className=\"flex items-center gap-3\">\r\n                            {result.record_type === 'contact' ? (\r\n                              <User className=\"h-5 w-5 text-blue-500\" />\r\n                            ) : (\r\n                              <Building2 className=\"h-5 w-5 text-purple-500\" />\r\n                            )}\r\n                            <div>\r\n                              <p className=\"font-medium\">\r\n                                {result.contact_name || result.company_name}\r\n                              </p>\r\n                              <p className=\"text-xs text-gray-500\">\r\n                                {result.fields_enriched.length} fields • {result.provider}\r\n                              </p>\r\n                            </div>\r\n                          </div>\r\n                          <Badge className={getQualityColor(result.data_quality_score)}>\r\n                            {result.data_quality_score}%\r\n                          </Badge>\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n\r\n                {/* Running Jobs */}\r\n                <Card>\r\n                  <CardHeader>\r\n                    <CardTitle className=\"flex items-center gap-2\">\r\n                      <RefreshCw className=\"h-5 w-5\" />\r\n                      Running Jobs\r\n                    </CardTitle>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    <div className=\"space-y-4\">\r\n                      {jobs.filter(j => j.status === 'running').map(job => (\r\n                        <div key={job.id} className=\"p-3 border rounded-lg\">\r\n                          <div className=\"flex items-center justify-between mb-2\">\r\n                            <span className=\"font-medium\">{job.profile_name}</span>\r\n                            <Badge className={getStatusColor(job.status)}>{job.status}</Badge>\r\n                          </div>\r\n                          <div className=\"space-y-2\">\r\n                            <div className=\"flex justify-between text-sm text-gray-500\">\r\n                              <span>Progress</span>\r\n                              <span>{job.processed_records}/{job.total_records}</span>\r\n                            </div>\r\n                            <Progress value={(job.processed_records / job.total_records) * 100} />\r\n                          </div>\r\n                        </div>\r\n                      ))}\r\n                      {jobs.filter(j => j.status === 'running').length === 0 && (\r\n                        <p className=\"text-gray-500 text-center py-4\">No jobs currently running</p>\r\n                      )}\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n              </div>\r\n            </TabsContent>\r\n\r\n            {/* Providers Tab */}\r\n            <TabsContent value=\"providers\" className=\"space-y-4\">\r\n              <Card>\r\n                <CardHeader>\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <CardTitle>Enrichment Providers</CardTitle>\r\n                      <CardDescription>Manage your data enrichment sources</CardDescription>\r\n                    </div>\r\n                    <Button onClick={() => setIsConfigProviderDialogOpen(true)}>\r\n                      <Settings className=\"h-4 w-4 mr-2\" />\r\n                      Add Provider\r\n                    </Button>\r\n                  </div>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"space-y-4\">\r\n                    {providers.map(provider => (\r\n                      <div key={provider.id} className=\"border rounded-lg p-4\">\r\n                        <div className=\"flex items-start justify-between mb-4\">\r\n                          <div className=\"flex items-center gap-3\">\r\n                            <div className={`p-3 rounded-lg ${provider.is_active ? 'bg-emerald-100' : 'bg-gray-100'}`}>\r\n                              {getProviderIcon(provider.provider_type)}\r\n                            </div>\r\n                            <div>\r\n                              <div className=\"flex items-center gap-2\">\r\n                                <h3 className=\"font-semibold text-lg\">{provider.name}</h3>\r\n                                <Badge variant={provider.is_active ? 'default' : 'secondary'}>\r\n                                  {provider.is_active ? 'Active' : 'Inactive'}\r\n                                </Badge>\r\n                              </div>\r\n                              <p className=\"text-sm text-gray-500 capitalize\">{provider.provider_type} Data Provider</p>\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <Switch checked={provider.is_active} />\r\n                            <Button size=\"sm\" variant=\"outline\">\r\n                              <Settings className=\"h-4 w-4\" />\r\n                            </Button>\r\n                          </div>\r\n                        </div>\r\n\r\n                        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n                          <div className=\"p-3 bg-gray-50 rounded-lg\">\r\n                            <p className=\"text-xs text-gray-500\">Success Rate</p>\r\n                            <p className={`text-lg font-semibold ${getQualityColor(provider.success_rate)}`}>\r\n                              {provider.success_rate}%\r\n                            </p>\r\n                          </div>\r\n                          <div className=\"p-3 bg-gray-50 rounded-lg\">\r\n                            <p className=\"text-xs text-gray-500\">Avg Response</p>\r\n                            <p className=\"text-lg font-semibold\">{provider.average_response_time}ms</p>\r\n                          </div>\r\n                          <div className=\"p-3 bg-gray-50 rounded-lg\">\r\n                            <p className=\"text-xs text-gray-500\">Total Requests</p>\r\n                            <p className=\"text-lg font-semibold\">{provider.total_requests.toLocaleString()}</p>\r\n                          </div>\r\n                          <div className=\"p-3 bg-gray-50 rounded-lg\">\r\n                            <p className=\"text-xs text-gray-500\">Monthly Usage</p>\r\n                            <p className=\"text-lg font-semibold\">\r\n                              {provider.requests_this_month.toLocaleString()}/{provider.monthly_limit.toLocaleString()}\r\n                            </p>\r\n                          </div>\r\n                        </div>\r\n\r\n                        <div className=\"mt-4\">\r\n                          <div className=\"flex justify-between mb-1 text-sm\">\r\n                            <span className=\"text-gray-500\">Monthly API Usage</span>\r\n                            <span>{Math.round((provider.requests_this_month / provider.monthly_limit) * 100)}%</span>\r\n                          </div>\r\n                          <Progress value={(provider.requests_this_month / provider.monthly_limit) * 100} />\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            </TabsContent>\r\n\r\n            {/* Profiles Tab */}\r\n            <TabsContent value=\"profiles\" className=\"space-y-4\">\r\n              <Card>\r\n                <CardHeader>\r\n                  <CardTitle>Enrichment Profiles</CardTitle>\r\n                  <CardDescription>Configure what data to enrich and enrichment triggers</CardDescription>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"space-y-4\">\r\n                    {profiles.map(profile => (\r\n                      <div key={profile.id} className=\"border rounded-lg p-4\">\r\n                        <div className=\"flex items-start justify-between mb-4\">\r\n                          <div>\r\n                            <div className=\"flex items-center gap-2\">\r\n                              <h3 className=\"font-semibold\">{profile.name}</h3>\r\n                              <Badge variant={profile.is_active ? 'default' : 'secondary'}>\r\n                                {profile.is_active ? 'Active' : 'Inactive'}\r\n                              </Badge>\r\n                              <Badge variant=\"outline\" className=\"capitalize\">\r\n                                {profile.profile_type}\r\n                              </Badge>\r\n                            </div>\r\n                            <p className=\"text-sm text-gray-500 mt-1\">\r\n                              Created {new Date(profile.created_at).toLocaleDateString()}\r\n                            </p>\r\n                          </div>\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <Button size=\"sm\" variant=\"outline\" onClick={() => triggerEnrichment(profile.id)}>\r\n                              <Play className=\"h-4 w-4 mr-1\" />\r\n                              Run Now\r\n                            </Button>\r\n                            <Switch checked={profile.is_active} />\r\n                          </div>\r\n                        </div>\r\n\r\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4\">\r\n                          <div>\r\n                            <h4 className=\"text-sm font-medium mb-2\">Fields to Enrich</h4>\r\n                            <div className=\"flex flex-wrap gap-1\">\r\n                              {profile.fields_to_enrich.map(field => (\r\n                                <Badge key={field} variant=\"secondary\" className=\"text-xs\">\r\n                                  {field.replace('_', ' ')}\r\n                                </Badge>\r\n                              ))}\r\n                            </div>\r\n                          </div>\r\n                          <div>\r\n                            <h4 className=\"text-sm font-medium mb-2\">Triggers</h4>\r\n                            <div className=\"flex flex-wrap gap-1\">\r\n                              {profile.enrichment_triggers.map(trigger => (\r\n                                <Badge key={trigger} variant=\"outline\" className=\"text-xs\">\r\n                                  {trigger.replace(/_/g, ' ')}\r\n                                </Badge>\r\n                              ))}\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n\r\n                        <div className=\"flex items-center justify-between pt-3 border-t text-sm\">\r\n                          <div className=\"flex items-center gap-4\">\r\n                            <span className=\"text-gray-500\">\r\n                              Auto-enrich: <strong>{profile.auto_enrich ? 'Yes' : 'No'}</strong>\r\n                            </span>\r\n                            <span className=\"text-gray-500\">\r\n                              Threshold: <strong>{profile.priority_score_threshold}</strong>\r\n                            </span>\r\n                          </div>\r\n                          <div className=\"flex items-center gap-4\">\r\n                            {profile.contacts_enriched > 0 && (\r\n                              <span className=\"text-gray-500\">\r\n                                <User className=\"h-3 w-3 inline mr-1\" />\r\n                                {profile.contacts_enriched.toLocaleString()} contacts\r\n                              </span>\r\n                            )}\r\n                            {profile.companies_enriched > 0 && (\r\n                              <span className=\"text-gray-500\">\r\n                                <Building2 className=\"h-3 w-3 inline mr-1\" />\r\n                                {profile.companies_enriched.toLocaleString()} companies\r\n                              </span>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            </TabsContent>\r\n\r\n            {/* Jobs Tab */}\r\n            <TabsContent value=\"jobs\" className=\"space-y-4\">\r\n              <Card>\r\n                <CardHeader>\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <CardTitle>Enrichment Jobs</CardTitle>\r\n                      <CardDescription>View and manage enrichment job history</CardDescription>\r\n                    </div>\r\n                    <div className=\"flex gap-2\">\r\n                      <Button variant=\"outline\" size=\"sm\">\r\n                        <Filter className=\"h-4 w-4 mr-2\" />\r\n                        Filter\r\n                      </Button>\r\n                      <Button variant=\"outline\" size=\"sm\">\r\n                        <Download className=\"h-4 w-4 mr-2\" />\r\n                        Export\r\n                      </Button>\r\n                    </div>\r\n                  </div>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"space-y-4\">\r\n                    {jobs.map(job => (\r\n                      <div key={job.id} className=\"border rounded-lg p-4\">\r\n                        <div className=\"flex items-start justify-between mb-3\">\r\n                          <div>\r\n                            <div className=\"flex items-center gap-2\">\r\n                              <h3 className=\"font-medium\">{job.profile_name}</h3>\r\n                              <Badge className={getStatusColor(job.status)}>{job.status}</Badge>\r\n                              <Badge variant=\"outline\" className=\"capitalize\">{job.record_type}</Badge>\r\n                            </div>\r\n                            <p className=\"text-sm text-gray-500 mt-1\">\r\n                              Started: {new Date(job.started_at).toLocaleString()}\r\n                              {job.completed_at && ` • Completed: ${new Date(job.completed_at).toLocaleString()}`}\r\n                            </p>\r\n                          </div>\r\n                          <div className=\"flex gap-2\">\r\n                            {job.status === 'running' && (\r\n                              <Button size=\"sm\" variant=\"outline\">\r\n                                <Pause className=\"h-4 w-4\" />\r\n                              </Button>\r\n                            )}\r\n                            {job.status === 'pending' && (\r\n                              <Button size=\"sm\" variant=\"outline\">\r\n                                <Play className=\"h-4 w-4\" />\r\n                              </Button>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n\r\n                        <div className=\"space-y-2\">\r\n                          <div className=\"flex justify-between text-sm\">\r\n                            <span className=\"text-gray-500\">Progress</span>\r\n                            <span>{job.processed_records}/{job.total_records} records</span>\r\n                          </div>\r\n                          <Progress value={(job.processed_records / job.total_records) * 100} />\r\n                        </div>\r\n\r\n                        <div className=\"grid grid-cols-3 gap-4 mt-4 pt-3 border-t\">\r\n                          <div className=\"text-center\">\r\n                            <p className=\"text-2xl font-semibold text-green-600\">{job.successful_records}</p>\r\n                            <p className=\"text-xs text-gray-500\">Successful</p>\r\n                          </div>\r\n                          <div className=\"text-center\">\r\n                            <p className=\"text-2xl font-semibold text-red-600\">{job.failed_records}</p>\r\n                            <p className=\"text-xs text-gray-500\">Failed</p>\r\n                          </div>\r\n                          <div className=\"text-center\">\r\n                            <p className=\"text-2xl font-semibold text-gray-600\">\r\n                              {job.total_records - job.processed_records}\r\n                            </p>\r\n                            <p className=\"text-xs text-gray-500\">Remaining</p>\r\n                          </div>\r\n                        </div>\r\n\r\n                        {job.error_message && (\r\n                          <div className=\"mt-3 p-2 bg-red-50 rounded text-sm text-red-700\">\r\n                            <AlertTriangle className=\"h-4 w-4 inline mr-1\" />\r\n                            {job.error_message}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            </TabsContent>\r\n\r\n            {/* Data Quality Tab */}\r\n            <TabsContent value=\"quality\" className=\"space-y-4\">\r\n              <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n                <Card>\r\n                  <CardHeader>\r\n                    <CardTitle>Overall Data Quality</CardTitle>\r\n                    <CardDescription>Comprehensive view of your CRM data health</CardDescription>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    {qualityMetrics && (\r\n                      <div className=\"space-y-6\">\r\n                        <div className=\"text-center py-6\">\r\n                          <div className=\"inline-flex items-center justify-center w-32 h-32 rounded-full bg-emerald-100\">\r\n                            <span className={`text-4xl font-bold ${getQualityColor(qualityMetrics.overall_score)}`}>\r\n                              {qualityMetrics.overall_score}%\r\n                            </span>\r\n                          </div>\r\n                          <p className=\"mt-3 text-lg font-medium\">Overall Quality Score</p>\r\n                          <p className=\"text-sm text-gray-500\">Based on completeness, accuracy, freshness, and consistency</p>\r\n                        </div>\r\n\r\n                        <div className=\"grid grid-cols-2 gap-4\">\r\n                          <div className=\"p-4 bg-blue-50 rounded-lg\">\r\n                            <p className=\"text-sm text-blue-600\">Total Records</p>\r\n                            <p className=\"text-2xl font-bold text-blue-900\">\r\n                              {qualityMetrics.total_records.toLocaleString()}\r\n                            </p>\r\n                          </div>\r\n                          <div className=\"p-4 bg-green-50 rounded-lg\">\r\n                            <p className=\"text-sm text-green-600\">Enriched Records</p>\r\n                            <p className=\"text-2xl font-bold text-green-900\">\r\n                              {qualityMetrics.enriched_records.toLocaleString()}\r\n                            </p>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                  </CardContent>\r\n                </Card>\r\n\r\n                <Card>\r\n                  <CardHeader>\r\n                    <CardTitle>Quality Dimensions</CardTitle>\r\n                    <CardDescription>Detailed breakdown of data quality metrics</CardDescription>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    {qualityMetrics && (\r\n                      <div className=\"space-y-6\">\r\n                        <div className=\"p-4 border rounded-lg\">\r\n                          <div className=\"flex items-center justify-between mb-2\">\r\n                            <div className=\"flex items-center gap-2\">\r\n                              <CheckCircle2 className=\"h-5 w-5 text-blue-500\" />\r\n                              <span className=\"font-medium\">Completeness</span>\r\n                            </div>\r\n                            <span className={`font-semibold ${getQualityColor(qualityMetrics.completeness)}`}>\r\n                              {qualityMetrics.completeness}%\r\n                            </span>\r\n                          </div>\r\n                          <p className=\"text-sm text-gray-500 mb-2\">How much of the expected data is present</p>\r\n                          <Progress value={qualityMetrics.completeness} />\r\n                        </div>\r\n\r\n                        <div className=\"p-4 border rounded-lg\">\r\n                          <div className=\"flex items-center justify-between mb-2\">\r\n                            <div className=\"flex items-center gap-2\">\r\n                              <Target className=\"h-5 w-5 text-green-500\" />\r\n                              <span className=\"font-medium\">Accuracy</span>\r\n                            </div>\r\n                            <span className={`font-semibold ${getQualityColor(qualityMetrics.accuracy)}`}>\r\n                              {qualityMetrics.accuracy}%\r\n                            </span>\r\n                          </div>\r\n                          <p className=\"text-sm text-gray-500 mb-2\">How correct and reliable the data is</p>\r\n                          <Progress value={qualityMetrics.accuracy} />\r\n                        </div>\r\n\r\n                        <div className=\"p-4 border rounded-lg\">\r\n                          <div className=\"flex items-center justify-between mb-2\">\r\n                            <div className=\"flex items-center gap-2\">\r\n                              <Clock className=\"h-5 w-5 text-yellow-500\" />\r\n                              <span className=\"font-medium\">Freshness</span>\r\n                            </div>\r\n                            <span className={`font-semibold ${getQualityColor(qualityMetrics.freshness)}`}>\r\n                              {qualityMetrics.freshness}%\r\n                            </span>\r\n                          </div>\r\n                          <p className=\"text-sm text-gray-500 mb-2\">How recently the data has been updated</p>\r\n                          <Progress value={qualityMetrics.freshness} />\r\n                        </div>\r\n\r\n                        <div className=\"p-4 border rounded-lg\">\r\n                          <div className=\"flex items-center justify-between mb-2\">\r\n                            <div className=\"flex items-center gap-2\">\r\n                              <TrendingUp className=\"h-5 w-5 text-purple-500\" />\r\n                              <span className=\"font-medium\">Consistency</span>\r\n                            </div>\r\n                            <span className={`font-semibold ${getQualityColor(qualityMetrics.consistency)}`}>\r\n                              {qualityMetrics.consistency}%\r\n                            </span>\r\n                          </div>\r\n                          <p className=\"text-sm text-gray-500 mb-2\">How uniform the data format is across records</p>\r\n                          <Progress value={qualityMetrics.consistency} />\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                  </CardContent>\r\n                </Card>\r\n\r\n                <Card className=\"lg:col-span-2\">\r\n                  <CardHeader>\r\n                    <CardTitle>Data Quality Recommendations</CardTitle>\r\n                    <CardDescription>AI-generated suggestions to improve your data quality</CardDescription>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                      <div className=\"p-4 bg-yellow-50 border border-yellow-200 rounded-lg\">\r\n                        <div className=\"flex items-center gap-2 mb-2\">\r\n                          <AlertTriangle className=\"h-5 w-5 text-yellow-600\" />\r\n                          <span className=\"font-medium text-yellow-900\">Stale Data Alert</span>\r\n                        </div>\r\n                        <p className=\"text-sm text-yellow-800 mb-3\">\r\n                          {qualityMetrics?.records_needing_update.toLocaleString()} records haven't been updated in 90+ days.\r\n                        </p>\r\n                        <Button size=\"sm\" variant=\"outline\" className=\"border-yellow-400 text-yellow-700\">\r\n                          Re-enrich Records\r\n                        </Button>\r\n                      </div>\r\n\r\n                      <div className=\"p-4 bg-blue-50 border border-blue-200 rounded-lg\">\r\n                        <div className=\"flex items-center gap-2 mb-2\">\r\n                          <Mail className=\"h-5 w-5 text-blue-600\" />\r\n                          <span className=\"font-medium text-blue-900\">Missing Emails</span>\r\n                        </div>\r\n                        <p className=\"text-sm text-blue-800 mb-3\">\r\n                          1,250 contacts are missing email addresses. Consider running email finder.\r\n                        </p>\r\n                        <Button size=\"sm\" variant=\"outline\" className=\"border-blue-400 text-blue-700\">\r\n                          Find Emails\r\n                        </Button>\r\n                      </div>\r\n\r\n                      <div className=\"p-4 bg-purple-50 border border-purple-200 rounded-lg\">\r\n                        <div className=\"flex items-center gap-2 mb-2\">\r\n                          <Building2 className=\"h-5 w-5 text-purple-600\" />\r\n                          <span className=\"font-medium text-purple-900\">Incomplete Companies</span>\r\n                        </div>\r\n                        <p className=\"text-sm text-purple-800 mb-3\">\r\n                          320 companies are missing revenue and employee data.\r\n                        </p>\r\n                        <Button size=\"sm\" variant=\"outline\" className=\"border-purple-400 text-purple-700\">\r\n                          Enrich Companies\r\n                        </Button>\r\n                      </div>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n              </div>\r\n            </TabsContent>\r\n          </Tabs>\r\n\r\n          {/* Add Provider Dialog */}\r\n          <Dialog open={isConfigProviderDialogOpen} onOpenChange={setIsConfigProviderDialogOpen}>\r\n            <DialogContent>\r\n              <DialogHeader>\r\n                <DialogTitle>Add Enrichment Provider</DialogTitle>\r\n                <DialogDescription>\r\n                  Connect a new data enrichment provider\r\n                </DialogDescription>\r\n              </DialogHeader>\r\n              <div className=\"space-y-4 py-4\">\r\n                <div>\r\n                  <Label>Provider Name</Label>\r\n                  <Input placeholder=\"e.g., Clearbit, ZoomInfo\" />\r\n                </div>\r\n                <div>\r\n                  <Label>Provider Type</Label>\r\n                  <Select>\r\n                    <SelectTrigger>\r\n                      <SelectValue placeholder=\"Select type\" />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"company\">Company Data</SelectItem>\r\n                      <SelectItem value=\"contact\">Contact Data</SelectItem>\r\n                      <SelectItem value=\"email\">Email Verification</SelectItem>\r\n                      <SelectItem value=\"social\">Social Profiles</SelectItem>\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n                <div>\r\n                  <Label>API Endpoint</Label>\r\n                  <Input placeholder=\"https://api.provider.com/v1\" />\r\n                </div>\r\n                <div>\r\n                  <Label>API Key</Label>\r\n                  <Input type=\"password\" placeholder=\"Enter your API key\" />\r\n                </div>\r\n                <div>\r\n                  <Label>Monthly Request Limit</Label>\r\n                  <Input type=\"number\" placeholder=\"50000\" />\r\n                </div>\r\n                <div>\r\n                  <Label>Priority</Label>\r\n                  <Select>\r\n                    <SelectTrigger>\r\n                      <SelectValue placeholder=\"Select priority\" />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"1\">High (Primary)</SelectItem>\r\n                      <SelectItem value=\"2\">Medium (Secondary)</SelectItem>\r\n                      <SelectItem value=\"3\">Low (Fallback)</SelectItem>\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n                <Button className=\"w-full\">Add Provider</Button>\r\n              </div>\r\n            </DialogContent>\r\n          </Dialog>\r\n        </div>\r\n      </MainLayout>\r\n    </ProtectedRoute>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\data\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\document-esign\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\documents\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\email-sequences\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Switch' is defined but never used.","line":30,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":30,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Send' is defined but never used.","line":33,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":33,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Trash2' is defined but never used.","line":39,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":39,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used.","line":42,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":42,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowRight' is defined but never used.","line":45,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":45,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Settings' is defined but never used.","line":46,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":46,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendingUp' is defined but never used.","line":48,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":48,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SequenceStep' is defined but never used.","line":76,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":76,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useEffect, useState, useCallback } from 'react';\r\nimport MainLayout from '@/components/Layout/MainLayout';\r\nimport ProtectedRoute from '@/components/ProtectedRoute';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Skeleton } from '@/components/ui/skeleton';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogTrigger,\r\n} from '@/components/ui/dialog';\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { Switch } from '@/components/ui/switch';\r\nimport {\r\n  Mail,\r\n  Send,\r\n  Plus,\r\n  Search,\r\n  Play,\r\n  Pause,\r\n  Copy,\r\n  Trash2,\r\n  BarChart3,\r\n  Users,\r\n  Clock,\r\n  Zap,\r\n  Target,\r\n  ArrowRight,\r\n  Settings,\r\n  Sparkles,\r\n  TrendingUp,\r\n  Eye,\r\n  MousePointer,\r\n  Reply,\r\n  RefreshCw,\r\n  MoreVertical,\r\n  Edit,\r\n  CheckCircle2,\r\n  XCircle,\r\n  AlertCircle,\r\n} from 'lucide-react';\r\nimport { toast } from 'sonner';\r\nimport { emailSequenceAPI } from '@/lib/ai-workflow-api';\r\n\r\ninterface EmailSequence {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  status: 'draft' | 'active' | 'paused' | 'archived';\r\n  steps_count: number;\r\n  enrolled_count: number;\r\n  completed_count: number;\r\n  reply_rate: number;\r\n  open_rate: number;\r\n  click_rate: number;\r\n  created_at: string;\r\n}\r\n\r\ninterface SequenceStep {\r\n  id: string;\r\n  order: number;\r\n  step_type: 'email' | 'wait' | 'condition';\r\n  subject: string;\r\n  delay_days: number;\r\n  delay_hours: number;\r\n  email_sent_count: number;\r\n  open_rate: number;\r\n  click_rate: number;\r\n}\r\n\r\ninterface Enrollment {\r\n  id: string;\r\n  contact_name: string;\r\n  contact_email: string;\r\n  sequence_name: string;\r\n  status: 'active' | 'paused' | 'completed' | 'unsubscribed' | 'bounced';\r\n  current_step: number;\r\n  total_steps: number;\r\n  enrolled_at: string;\r\n  last_activity: string;\r\n}\r\n\r\ninterface ABTest {\r\n  id: string;\r\n  name: string;\r\n  step_name: string;\r\n  status: 'running' | 'completed' | 'paused';\r\n  variant_a_opens: number;\r\n  variant_b_opens: number;\r\n  variant_a_clicks: number;\r\n  variant_b_clicks: number;\r\n  sample_size: number;\r\n  winner: string | null;\r\n}\r\n\r\ninterface SequenceMetrics {\r\n  total_sequences: number;\r\n  active_sequences: number;\r\n  total_enrolled: number;\r\n  total_completed: number;\r\n  average_open_rate: number;\r\n  average_reply_rate: number;\r\n  emails_sent_today: number;\r\n  replies_today: number;\r\n}\r\n\r\nexport default function EmailSequencesPage() {\r\n  const [loading, setLoading] = useState(true);\r\n  const [sequences, setSequences] = useState<EmailSequence[]>([]);\r\n  const [enrollments, setEnrollments] = useState<Enrollment[]>([]);\r\n  const [abTests, setABTests] = useState<ABTest[]>([]);\r\n  const [metrics, setMetrics] = useState<SequenceMetrics | null>(null);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [selectedTab, setSelectedTab] = useState('sequences');\r\n  const [createDialogOpen, setCreateDialogOpen] = useState(false);\r\n  const [newSequence, setNewSequence] = useState({\r\n    name: '',\r\n    description: '',\r\n    goal: 'engagement',\r\n  });\r\n\r\n  const fetchData = useCallback(async () => {\r\n    try {\r\n      setLoading(true);\r\n\r\n      const [sequencesRes, enrollmentsRes, abTestsRes] = await Promise.all([\r\n        emailSequenceAPI.getSequences({ limit: 20 }),\r\n        emailSequenceAPI.getEnrollments({ limit: 20 }),\r\n        emailSequenceAPI.getABTests({ limit: 10 }),\r\n      ]);\r\n\r\n      setSequences(sequencesRes.data.results || []);\r\n      setEnrollments(enrollmentsRes.data.results || []);\r\n      setABTests(abTestsRes.data.results || []);\r\n    } catch (error) {\r\n      console.error('Failed to fetch sequence data:', error);\r\n      // Demo data\r\n      setSequences([\r\n        {\r\n          id: '1',\r\n          name: 'New Lead Nurture',\r\n          description: 'Welcome sequence for new leads',\r\n          status: 'active',\r\n          steps_count: 5,\r\n          enrolled_count: 245,\r\n          completed_count: 156,\r\n          reply_rate: 18.5,\r\n          open_rate: 62.3,\r\n          click_rate: 24.1,\r\n          created_at: new Date(Date.now() - 30 * 86400000).toISOString(),\r\n        },\r\n        {\r\n          id: '2',\r\n          name: 'Re-engagement Campaign',\r\n          description: 'Win back inactive contacts',\r\n          status: 'active',\r\n          steps_count: 4,\r\n          enrolled_count: 189,\r\n          completed_count: 89,\r\n          reply_rate: 12.3,\r\n          open_rate: 45.6,\r\n          click_rate: 15.8,\r\n          created_at: new Date(Date.now() - 15 * 86400000).toISOString(),\r\n        },\r\n        {\r\n          id: '3',\r\n          name: 'Post-Demo Follow-up',\r\n          description: 'Follow up after product demo',\r\n          status: 'paused',\r\n          steps_count: 3,\r\n          enrolled_count: 67,\r\n          completed_count: 45,\r\n          reply_rate: 28.4,\r\n          open_rate: 78.2,\r\n          click_rate: 42.5,\r\n          created_at: new Date(Date.now() - 7 * 86400000).toISOString(),\r\n        },\r\n        {\r\n          id: '4',\r\n          name: 'Trial Conversion',\r\n          description: 'Convert trial users to paid',\r\n          status: 'draft',\r\n          steps_count: 6,\r\n          enrolled_count: 0,\r\n          completed_count: 0,\r\n          reply_rate: 0,\r\n          open_rate: 0,\r\n          click_rate: 0,\r\n          created_at: new Date().toISOString(),\r\n        },\r\n      ]);\r\n      setEnrollments([\r\n        {\r\n          id: '1',\r\n          contact_name: 'John Smith',\r\n          contact_email: 'john@acme.com',\r\n          sequence_name: 'New Lead Nurture',\r\n          status: 'active',\r\n          current_step: 3,\r\n          total_steps: 5,\r\n          enrolled_at: new Date(Date.now() - 5 * 86400000).toISOString(),\r\n          last_activity: new Date(Date.now() - 86400000).toISOString(),\r\n        },\r\n        {\r\n          id: '2',\r\n          contact_name: 'Sarah Johnson',\r\n          contact_email: 'sarah@techcorp.io',\r\n          sequence_name: 'New Lead Nurture',\r\n          status: 'completed',\r\n          current_step: 5,\r\n          total_steps: 5,\r\n          enrolled_at: new Date(Date.now() - 14 * 86400000).toISOString(),\r\n          last_activity: new Date(Date.now() - 2 * 86400000).toISOString(),\r\n        },\r\n        {\r\n          id: '3',\r\n          contact_name: 'Mike Wilson',\r\n          contact_email: 'mike@startup.co',\r\n          sequence_name: 'Post-Demo Follow-up',\r\n          status: 'active',\r\n          current_step: 2,\r\n          total_steps: 3,\r\n          enrolled_at: new Date(Date.now() - 3 * 86400000).toISOString(),\r\n          last_activity: new Date().toISOString(),\r\n        },\r\n      ]);\r\n      setABTests([\r\n        {\r\n          id: '1',\r\n          name: 'Subject Line Test',\r\n          step_name: 'Welcome Email',\r\n          status: 'running',\r\n          variant_a_opens: 234,\r\n          variant_b_opens: 256,\r\n          variant_a_clicks: 45,\r\n          variant_b_clicks: 62,\r\n          sample_size: 500,\r\n          winner: null,\r\n        },\r\n        {\r\n          id: '2',\r\n          name: 'CTA Button Test',\r\n          step_name: 'Follow-up #2',\r\n          status: 'completed',\r\n          variant_a_opens: 189,\r\n          variant_b_opens: 178,\r\n          variant_a_clicks: 67,\r\n          variant_b_clicks: 42,\r\n          sample_size: 400,\r\n          winner: 'A',\r\n        },\r\n      ]);\r\n      setMetrics({\r\n        total_sequences: 12,\r\n        active_sequences: 8,\r\n        total_enrolled: 1247,\r\n        total_completed: 834,\r\n        average_open_rate: 58.4,\r\n        average_reply_rate: 15.2,\r\n        emails_sent_today: 342,\r\n        replies_today: 28,\r\n      });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    fetchData();\r\n  }, [fetchData]);\r\n\r\n  const handleCreateSequence = async () => {\r\n    try {\r\n      await emailSequenceAPI.createSequence(newSequence);\r\n      toast.success('Sequence created successfully');\r\n      setCreateDialogOpen(false);\r\n      setNewSequence({ name: '', description: '', goal: 'engagement' });\r\n      fetchData();\r\n    } catch {\r\n      toast.error('Failed to create sequence');\r\n    }\r\n  };\r\n\r\n  const handleToggleSequence = async (id: string, currentStatus: string) => {\r\n    try {\r\n      if (currentStatus === 'active') {\r\n        await emailSequenceAPI.pauseSequence(id);\r\n        toast.success('Sequence paused');\r\n      } else {\r\n        await emailSequenceAPI.activateSequence(id);\r\n        toast.success('Sequence activated');\r\n      }\r\n      fetchData();\r\n    } catch {\r\n      toast.error('Failed to update sequence');\r\n    }\r\n  };\r\n\r\n  const handleCloneSequence = async (id: string) => {\r\n    try {\r\n      await emailSequenceAPI.cloneSequence(id);\r\n      toast.success('Sequence cloned successfully');\r\n      fetchData();\r\n    } catch {\r\n      toast.error('Failed to clone sequence');\r\n    }\r\n  };\r\n\r\n  const getStatusBadge = (status: string) => {\r\n    const variants: Record<string, { variant: 'default' | 'secondary' | 'destructive' | 'outline'; icon: React.ReactNode }> = {\r\n      active: { variant: 'default', icon: <Play className=\"w-3 h-3 mr-1\" /> },\r\n      paused: { variant: 'secondary', icon: <Pause className=\"w-3 h-3 mr-1\" /> },\r\n      draft: { variant: 'outline', icon: <Edit className=\"w-3 h-3 mr-1\" /> },\r\n      archived: { variant: 'destructive', icon: <XCircle className=\"w-3 h-3 mr-1\" /> },\r\n      completed: { variant: 'default', icon: <CheckCircle2 className=\"w-3 h-3 mr-1\" /> },\r\n      unsubscribed: { variant: 'destructive', icon: <XCircle className=\"w-3 h-3 mr-1\" /> },\r\n      bounced: { variant: 'destructive', icon: <AlertCircle className=\"w-3 h-3 mr-1\" /> },\r\n      running: { variant: 'default', icon: <RefreshCw className=\"w-3 h-3 mr-1 animate-spin\" /> },\r\n    };\r\n    const config = variants[status] || { variant: 'outline' as const, icon: null };\r\n    return (\r\n      <Badge variant={config.variant} className=\"capitalize\">\r\n        {config.icon}\r\n        {status}\r\n      </Badge>\r\n    );\r\n  };\r\n\r\n  const filteredSequences = sequences.filter(\r\n    (s) =>\r\n      s.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n      s.description.toLowerCase().includes(searchQuery.toLowerCase())\r\n  );\r\n\r\n  return (\r\n    <ProtectedRoute>\r\n      <MainLayout>\r\n        <div className=\"p-6 space-y-6\">\r\n          {/* Header */}\r\n          <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4\">\r\n            <div>\r\n              <h1 className=\"text-3xl font-bold gradient-text flex items-center gap-2\">\r\n                <Mail className=\"w-8 h-8\" />\r\n                Email Sequences\r\n              </h1>\r\n              <p className=\"text-muted-foreground mt-1\">\r\n                Automate your email outreach with AI-powered sequences\r\n              </p>\r\n            </div>\r\n            <div className=\"flex items-center gap-3\">\r\n              <Button variant=\"outline\" onClick={() => fetchData()}>\r\n                <RefreshCw className=\"w-4 h-4 mr-2\" />\r\n                Refresh\r\n              </Button>\r\n              <Dialog open={createDialogOpen} onOpenChange={setCreateDialogOpen}>\r\n                <DialogTrigger asChild>\r\n                  <Button className=\"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700\">\r\n                    <Plus className=\"w-4 h-4 mr-2\" />\r\n                    New Sequence\r\n                  </Button>\r\n                </DialogTrigger>\r\n                <DialogContent>\r\n                  <DialogHeader>\r\n                    <DialogTitle>Create Email Sequence</DialogTitle>\r\n                    <DialogDescription>\r\n                      Set up a new automated email sequence for your contacts\r\n                    </DialogDescription>\r\n                  </DialogHeader>\r\n                  <div className=\"space-y-4 py-4\">\r\n                    <div className=\"space-y-2\">\r\n                      <Label>Sequence Name</Label>\r\n                      <Input\r\n                        placeholder=\"e.g., Welcome Series\"\r\n                        value={newSequence.name}\r\n                        onChange={(e) => setNewSequence({ ...newSequence, name: e.target.value })}\r\n                      />\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label>Description</Label>\r\n                      <Textarea\r\n                        placeholder=\"Describe the purpose of this sequence...\"\r\n                        value={newSequence.description}\r\n                        onChange={(e) => setNewSequence({ ...newSequence, description: e.target.value })}\r\n                      />\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label>Goal</Label>\r\n                      <Select\r\n                        value={newSequence.goal}\r\n                        onValueChange={(value) => setNewSequence({ ...newSequence, goal: value })}\r\n                      >\r\n                        <SelectTrigger>\r\n                          <SelectValue />\r\n                        </SelectTrigger>\r\n                        <SelectContent>\r\n                          <SelectItem value=\"engagement\">Engagement</SelectItem>\r\n                          <SelectItem value=\"conversion\">Conversion</SelectItem>\r\n                          <SelectItem value=\"nurture\">Lead Nurture</SelectItem>\r\n                          <SelectItem value=\"onboarding\">Onboarding</SelectItem>\r\n                          <SelectItem value=\"re-engagement\">Re-engagement</SelectItem>\r\n                        </SelectContent>\r\n                      </Select>\r\n                    </div>\r\n                    <Button onClick={handleCreateSequence} className=\"w-full\">\r\n                      <Sparkles className=\"w-4 h-4 mr-2\" />\r\n                      Create Sequence\r\n                    </Button>\r\n                  </div>\r\n                </DialogContent>\r\n              </Dialog>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Metrics Cards */}\r\n          {loading ? (\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n              {[1, 2, 3, 4].map((i) => (\r\n                <Skeleton key={i} className=\"h-32\" />\r\n              ))}\r\n            </div>\r\n          ) : (\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n              <Card className=\"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-950/50 dark:to-blue-900/30 border-blue-200 dark:border-blue-800\">\r\n                <CardContent className=\"pt-6\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <p className=\"text-sm text-muted-foreground\">Active Sequences</p>\r\n                      <p className=\"text-3xl font-bold text-blue-600 dark:text-blue-400\">\r\n                        {metrics?.active_sequences || 0}\r\n                      </p>\r\n                      <p className=\"text-xs text-muted-foreground mt-1\">\r\n                        of {metrics?.total_sequences || 0} total\r\n                      </p>\r\n                    </div>\r\n                    <div className=\"w-12 h-12 bg-blue-500/20 rounded-xl flex items-center justify-center\">\r\n                      <Zap className=\"w-6 h-6 text-blue-600 dark:text-blue-400\" />\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n\r\n              <Card className=\"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-950/50 dark:to-green-900/30 border-green-200 dark:border-green-800\">\r\n                <CardContent className=\"pt-6\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <p className=\"text-sm text-muted-foreground\">Total Enrolled</p>\r\n                      <p className=\"text-3xl font-bold text-green-600 dark:text-green-400\">\r\n                        {metrics?.total_enrolled?.toLocaleString() || 0}\r\n                      </p>\r\n                      <p className=\"text-xs text-muted-foreground mt-1\">\r\n                        {metrics?.total_completed || 0} completed\r\n                      </p>\r\n                    </div>\r\n                    <div className=\"w-12 h-12 bg-green-500/20 rounded-xl flex items-center justify-center\">\r\n                      <Users className=\"w-6 h-6 text-green-600 dark:text-green-400\" />\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n\r\n              <Card className=\"bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-950/50 dark:to-purple-900/30 border-purple-200 dark:border-purple-800\">\r\n                <CardContent className=\"pt-6\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <p className=\"text-sm text-muted-foreground\">Avg Open Rate</p>\r\n                      <p className=\"text-3xl font-bold text-purple-600 dark:text-purple-400\">\r\n                        {metrics?.average_open_rate?.toFixed(1) || 0}%\r\n                      </p>\r\n                      <p className=\"text-xs text-muted-foreground mt-1\">\r\n                        {metrics?.emails_sent_today || 0} sent today\r\n                      </p>\r\n                    </div>\r\n                    <div className=\"w-12 h-12 bg-purple-500/20 rounded-xl flex items-center justify-center\">\r\n                      <Eye className=\"w-6 h-6 text-purple-600 dark:text-purple-400\" />\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n\r\n              <Card className=\"bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-950/50 dark:to-orange-900/30 border-orange-200 dark:border-orange-800\">\r\n                <CardContent className=\"pt-6\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <p className=\"text-sm text-muted-foreground\">Avg Reply Rate</p>\r\n                      <p className=\"text-3xl font-bold text-orange-600 dark:text-orange-400\">\r\n                        {metrics?.average_reply_rate?.toFixed(1) || 0}%\r\n                      </p>\r\n                      <p className=\"text-xs text-muted-foreground mt-1\">\r\n                        {metrics?.replies_today || 0} replies today\r\n                      </p>\r\n                    </div>\r\n                    <div className=\"w-12 h-12 bg-orange-500/20 rounded-xl flex items-center justify-center\">\r\n                      <Reply className=\"w-6 h-6 text-orange-600 dark:text-orange-400\" />\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n          )}\r\n\r\n          {/* Tabs */}\r\n          <Tabs value={selectedTab} onValueChange={setSelectedTab}>\r\n            <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4\">\r\n              <TabsList>\r\n                <TabsTrigger value=\"sequences\" className=\"gap-2\">\r\n                  <Mail className=\"w-4 h-4\" />\r\n                  Sequences\r\n                </TabsTrigger>\r\n                <TabsTrigger value=\"enrollments\" className=\"gap-2\">\r\n                  <Users className=\"w-4 h-4\" />\r\n                  Enrollments\r\n                </TabsTrigger>\r\n                <TabsTrigger value=\"ab-tests\" className=\"gap-2\">\r\n                  <Target className=\"w-4 h-4\" />\r\n                  A/B Tests\r\n                </TabsTrigger>\r\n              </TabsList>\r\n              <div className=\"relative w-full md:w-64\">\r\n                <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground\" />\r\n                <Input\r\n                  placeholder=\"Search...\"\r\n                  className=\"pl-10\"\r\n                  value={searchQuery}\r\n                  onChange={(e) => setSearchQuery(e.target.value)}\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <TabsContent value=\"sequences\" className=\"mt-6\">\r\n              {loading ? (\r\n                <div className=\"space-y-4\">\r\n                  {[1, 2, 3].map((i) => (\r\n                    <Skeleton key={i} className=\"h-40\" />\r\n                  ))}\r\n                </div>\r\n              ) : (\r\n                <div className=\"grid gap-4\">\r\n                  {filteredSequences.map((sequence) => (\r\n                    <Card key={sequence.id} className=\"hover:shadow-lg transition-shadow\">\r\n                      <CardContent className=\"p-6\">\r\n                        <div className=\"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4\">\r\n                          <div className=\"flex-1\">\r\n                            <div className=\"flex items-center gap-3 mb-2\">\r\n                              <h3 className=\"text-lg font-semibold\">{sequence.name}</h3>\r\n                              {getStatusBadge(sequence.status)}\r\n                            </div>\r\n                            <p className=\"text-sm text-muted-foreground mb-4\">\r\n                              {sequence.description}\r\n                            </p>\r\n                            <div className=\"flex flex-wrap items-center gap-4 text-sm\">\r\n                              <div className=\"flex items-center gap-1\">\r\n                                <Mail className=\"w-4 h-4 text-muted-foreground\" />\r\n                                <span>{sequence.steps_count} steps</span>\r\n                              </div>\r\n                              <div className=\"flex items-center gap-1\">\r\n                                <Users className=\"w-4 h-4 text-muted-foreground\" />\r\n                                <span>{sequence.enrolled_count} enrolled</span>\r\n                              </div>\r\n                              <div className=\"flex items-center gap-1\">\r\n                                <Eye className=\"w-4 h-4 text-green-500\" />\r\n                                <span>{sequence.open_rate.toFixed(1)}% opens</span>\r\n                              </div>\r\n                              <div className=\"flex items-center gap-1\">\r\n                                <MousePointer className=\"w-4 h-4 text-blue-500\" />\r\n                                <span>{sequence.click_rate.toFixed(1)}% clicks</span>\r\n                              </div>\r\n                              <div className=\"flex items-center gap-1\">\r\n                                <Reply className=\"w-4 h-4 text-purple-500\" />\r\n                                <span>{sequence.reply_rate.toFixed(1)}% replies</span>\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <Button\r\n                              variant=\"outline\"\r\n                              size=\"sm\"\r\n                              onClick={() => handleToggleSequence(sequence.id, sequence.status)}\r\n                              disabled={sequence.status === 'draft'}\r\n                            >\r\n                              {sequence.status === 'active' ? (\r\n                                <>\r\n                                  <Pause className=\"w-4 h-4 mr-1\" />\r\n                                  Pause\r\n                                </>\r\n                              ) : (\r\n                                <>\r\n                                  <Play className=\"w-4 h-4 mr-1\" />\r\n                                  Activate\r\n                                </>\r\n                              )}\r\n                            </Button>\r\n                            <Button variant=\"outline\" size=\"sm\" onClick={() => handleCloneSequence(sequence.id)}>\r\n                              <Copy className=\"w-4 h-4\" />\r\n                            </Button>\r\n                            <Button variant=\"outline\" size=\"sm\">\r\n                              <BarChart3 className=\"w-4 h-4\" />\r\n                            </Button>\r\n                            <Button variant=\"ghost\" size=\"sm\">\r\n                              <MoreVertical className=\"w-4 h-4\" />\r\n                            </Button>\r\n                          </div>\r\n                        </div>\r\n                        {sequence.enrolled_count > 0 && (\r\n                          <div className=\"mt-4 pt-4 border-t\">\r\n                            <div className=\"flex items-center justify-between text-sm mb-2\">\r\n                              <span className=\"text-muted-foreground\">Completion Progress</span>\r\n                              <span className=\"font-medium\">\r\n                                {((sequence.completed_count / sequence.enrolled_count) * 100).toFixed(0)}%\r\n                              </span>\r\n                            </div>\r\n                            <Progress\r\n                              value={(sequence.completed_count / sequence.enrolled_count) * 100}\r\n                              className=\"h-2\"\r\n                            />\r\n                          </div>\r\n                        )}\r\n                      </CardContent>\r\n                    </Card>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </TabsContent>\r\n\r\n            <TabsContent value=\"enrollments\" className=\"mt-6\">\r\n              {loading ? (\r\n                <div className=\"space-y-4\">\r\n                  {[1, 2, 3].map((i) => (\r\n                    <Skeleton key={i} className=\"h-20\" />\r\n                  ))}\r\n                </div>\r\n              ) : (\r\n                <Card>\r\n                  <CardContent className=\"p-0\">\r\n                    <div className=\"overflow-x-auto\">\r\n                      <table className=\"w-full\">\r\n                        <thead className=\"bg-muted/50\">\r\n                          <tr>\r\n                            <th className=\"px-4 py-3 text-left text-sm font-medium\">Contact</th>\r\n                            <th className=\"px-4 py-3 text-left text-sm font-medium\">Sequence</th>\r\n                            <th className=\"px-4 py-3 text-left text-sm font-medium\">Progress</th>\r\n                            <th className=\"px-4 py-3 text-left text-sm font-medium\">Status</th>\r\n                            <th className=\"px-4 py-3 text-left text-sm font-medium\">Last Activity</th>\r\n                            <th className=\"px-4 py-3 text-right text-sm font-medium\">Actions</th>\r\n                          </tr>\r\n                        </thead>\r\n                        <tbody className=\"divide-y\">\r\n                          {enrollments.map((enrollment) => (\r\n                            <tr key={enrollment.id} className=\"hover:bg-muted/30\">\r\n                              <td className=\"px-4 py-3\">\r\n                                <div>\r\n                                  <p className=\"font-medium\">{enrollment.contact_name}</p>\r\n                                  <p className=\"text-sm text-muted-foreground\">{enrollment.contact_email}</p>\r\n                                </div>\r\n                              </td>\r\n                              <td className=\"px-4 py-3 text-sm\">{enrollment.sequence_name}</td>\r\n                              <td className=\"px-4 py-3\">\r\n                                <div className=\"flex items-center gap-2\">\r\n                                  <Progress\r\n                                    value={(enrollment.current_step / enrollment.total_steps) * 100}\r\n                                    className=\"w-20 h-2\"\r\n                                  />\r\n                                  <span className=\"text-sm text-muted-foreground\">\r\n                                    {enrollment.current_step}/{enrollment.total_steps}\r\n                                  </span>\r\n                                </div>\r\n                              </td>\r\n                              <td className=\"px-4 py-3\">{getStatusBadge(enrollment.status)}</td>\r\n                              <td className=\"px-4 py-3 text-sm text-muted-foreground\">\r\n                                {new Date(enrollment.last_activity).toLocaleDateString()}\r\n                              </td>\r\n                              <td className=\"px-4 py-3 text-right\">\r\n                                <Button variant=\"ghost\" size=\"sm\">\r\n                                  <MoreVertical className=\"w-4 h-4\" />\r\n                                </Button>\r\n                              </td>\r\n                            </tr>\r\n                          ))}\r\n                        </tbody>\r\n                      </table>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n              )}\r\n            </TabsContent>\r\n\r\n            <TabsContent value=\"ab-tests\" className=\"mt-6\">\r\n              {loading ? (\r\n                <div className=\"space-y-4\">\r\n                  {[1, 2].map((i) => (\r\n                    <Skeleton key={i} className=\"h-40\" />\r\n                  ))}\r\n                </div>\r\n              ) : (\r\n                <div className=\"grid gap-4\">\r\n                  {abTests.map((test) => (\r\n                    <Card key={test.id}>\r\n                      <CardHeader>\r\n                        <div className=\"flex items-center justify-between\">\r\n                          <div>\r\n                            <CardTitle className=\"text-lg\">{test.name}</CardTitle>\r\n                            <CardDescription>Testing in: {test.step_name}</CardDescription>\r\n                          </div>\r\n                          {getStatusBadge(test.status)}\r\n                        </div>\r\n                      </CardHeader>\r\n                      <CardContent>\r\n                        <div className=\"grid md:grid-cols-2 gap-6\">\r\n                          <div className=\"space-y-3\">\r\n                            <div className=\"flex items-center justify-between\">\r\n                              <span className=\"font-medium\">Variant A</span>\r\n                              {test.winner === 'A' && (\r\n                                <Badge variant=\"default\" className=\"bg-green-500\">Winner</Badge>\r\n                              )}\r\n                            </div>\r\n                            <div className=\"space-y-2\">\r\n                              <div className=\"flex items-center justify-between text-sm\">\r\n                                <span className=\"text-muted-foreground\">Opens</span>\r\n                                <span>{test.variant_a_opens}</span>\r\n                              </div>\r\n                              <div className=\"flex items-center justify-between text-sm\">\r\n                                <span className=\"text-muted-foreground\">Clicks</span>\r\n                                <span>{test.variant_a_clicks}</span>\r\n                              </div>\r\n                              <div className=\"flex items-center justify-between text-sm\">\r\n                                <span className=\"text-muted-foreground\">Click Rate</span>\r\n                                <span>\r\n                                  {test.variant_a_opens > 0\r\n                                    ? ((test.variant_a_clicks / test.variant_a_opens) * 100).toFixed(1)\r\n                                    : 0}%\r\n                                </span>\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"space-y-3\">\r\n                            <div className=\"flex items-center justify-between\">\r\n                              <span className=\"font-medium\">Variant B</span>\r\n                              {test.winner === 'B' && (\r\n                                <Badge variant=\"default\" className=\"bg-green-500\">Winner</Badge>\r\n                              )}\r\n                            </div>\r\n                            <div className=\"space-y-2\">\r\n                              <div className=\"flex items-center justify-between text-sm\">\r\n                                <span className=\"text-muted-foreground\">Opens</span>\r\n                                <span>{test.variant_b_opens}</span>\r\n                              </div>\r\n                              <div className=\"flex items-center justify-between text-sm\">\r\n                                <span className=\"text-muted-foreground\">Clicks</span>\r\n                                <span>{test.variant_b_clicks}</span>\r\n                              </div>\r\n                              <div className=\"flex items-center justify-between text-sm\">\r\n                                <span className=\"text-muted-foreground\">Click Rate</span>\r\n                                <span>\r\n                                  {test.variant_b_opens > 0\r\n                                    ? ((test.variant_b_clicks / test.variant_b_opens) * 100).toFixed(1)\r\n                                    : 0}%\r\n                                </span>\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"mt-4 pt-4 border-t flex items-center justify-between\">\r\n                          <span className=\"text-sm text-muted-foreground\">\r\n                            Sample size: {test.sample_size} contacts\r\n                          </span>\r\n                          {test.status === 'running' && (\r\n                            <Button size=\"sm\" variant=\"outline\">\r\n                              Select Winner\r\n                            </Button>\r\n                          )}\r\n                        </div>\r\n                      </CardContent>\r\n                    </Card>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </TabsContent>\r\n          </Tabs>\r\n        </div>\r\n      </MainLayout>\r\n    </ProtectedRoute>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\email-tracking\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\gamification\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\gdpr-compliance\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\health\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\integration-hub\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\integrations\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\lead-qualification\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\lead-routing\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AlertTriangle' is defined but never used.","line":39,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":39,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckCircle2' is defined but never used.","line":40,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":40,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'XCircle' is defined but never used.","line":41,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":41,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Filter' is defined but never used.","line":49,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":49,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Briefcase' is defined but never used.","line":53,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":53,"endColumn":12},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Star' is defined but never used.","line":56,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":56,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ThumbsUp' is defined but never used.","line":57,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":57,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ThumbsDown' is defined but never used.","line":58,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":58,"endColumn":13}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useEffect, useState, useCallback } from 'react';\r\nimport MainLayout from '@/components/Layout/MainLayout';\r\nimport ProtectedRoute from '@/components/ProtectedRoute';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Skeleton } from '@/components/ui/skeleton';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogTrigger,\r\n} from '@/components/ui/dialog';\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Switch } from '@/components/ui/switch';\r\nimport {\r\n  Route,\r\n  Users,\r\n  UserCheck,\r\n  UserPlus,\r\n  Target,\r\n  TrendingUp,\r\n  Clock,\r\n  AlertTriangle,\r\n  CheckCircle2,\r\n  XCircle,\r\n  RefreshCw,\r\n  Plus,\r\n  Search,\r\n  Settings,\r\n  BarChart3,\r\n  ArrowRight,\r\n  Shuffle,\r\n  Filter,\r\n  MoreVertical,\r\n  Zap,\r\n  Award,\r\n  Briefcase,\r\n  MapPin,\r\n  Building2,\r\n  Star,\r\n  ThumbsUp,\r\n  ThumbsDown,\r\n} from 'lucide-react';\r\nimport { toast } from 'sonner';\r\nimport { leadRoutingAPI } from '@/lib/ai-workflow-api';\r\n\r\ninterface SalesRep {\r\n  id: string;\r\n  user_name: string;\r\n  user_email: string;\r\n  avatar_url?: string;\r\n  is_available: boolean;\r\n  current_load: number;\r\n  max_capacity: number;\r\n  specializations: string[];\r\n  territories: string[];\r\n  conversion_rate: number;\r\n  avg_response_time_hours: number;\r\n  total_assignments: number;\r\n  active_leads: number;\r\n}\r\n\r\ninterface RoutingRule {\r\n  id: string;\r\n  name: string;\r\n  priority: number;\r\n  is_active: boolean;\r\n  routing_type: 'round_robin' | 'weighted' | 'skill_based' | 'territory' | 'ai';\r\n  conditions: Record<string, unknown>;\r\n  assigned_reps_count: number;\r\n  leads_routed: number;\r\n  success_rate: number;\r\n}\r\n\r\ninterface LeadAssignment {\r\n  id: string;\r\n  lead_name: string;\r\n  lead_email: string;\r\n  lead_company: string;\r\n  assigned_to: string;\r\n  assigned_to_avatar?: string;\r\n  status: 'pending' | 'accepted' | 'rejected' | 'escalated' | 'converted';\r\n  assignment_reason: string;\r\n  match_score: number;\r\n  assigned_at: string;\r\n  response_time_hours?: number;\r\n}\r\n\r\ninterface RoutingMetrics {\r\n  total_leads_routed_today: number;\r\n  avg_assignment_time_seconds: number;\r\n  acceptance_rate: number;\r\n  conversion_rate: number;\r\n  avg_response_time_hours: number;\r\n  leads_pending: number;\r\n  leads_escalated: number;\r\n  top_performer_id: string;\r\n  top_performer_name: string;\r\n}\r\n\r\nexport default function LeadRoutingPage() {\r\n  const [loading, setLoading] = useState(true);\r\n  const [reps, setReps] = useState<SalesRep[]>([]);\r\n  const [rules, setRules] = useState<RoutingRule[]>([]);\r\n  const [assignments, setAssignments] = useState<LeadAssignment[]>([]);\r\n  const [metrics, setMetrics] = useState<RoutingMetrics | null>(null);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [selectedTab, setSelectedTab] = useState('dashboard');\r\n  const [createRuleDialogOpen, setCreateRuleDialogOpen] = useState(false);\r\n\r\n  const fetchData = useCallback(async () => {\r\n    try {\r\n      setLoading(true);\r\n\r\n      const [repsRes, rulesRes, assignmentsRes, dashboardRes] = await Promise.all([\r\n        leadRoutingAPI.getRepProfiles({ limit: 20 }),\r\n        leadRoutingAPI.getRoutingRules({ limit: 20 }),\r\n        leadRoutingAPI.getAssignments({ limit: 20 }),\r\n        leadRoutingAPI.getRoutingDashboard(),\r\n      ]);\r\n\r\n      setReps(repsRes.data.results || []);\r\n      setRules(rulesRes.data.results || []);\r\n      setAssignments(assignmentsRes.data.results || []);\r\n      setMetrics(dashboardRes.data || null);\r\n    } catch (error) {\r\n      console.error('Failed to fetch routing data:', error);\r\n      // Demo data\r\n      setReps([\r\n        {\r\n          id: '1',\r\n          user_name: 'Alex Johnson',\r\n          user_email: 'alex@company.com',\r\n          is_available: true,\r\n          current_load: 12,\r\n          max_capacity: 20,\r\n          specializations: ['Enterprise', 'SaaS'],\r\n          territories: ['North America', 'Europe'],\r\n          conversion_rate: 32.5,\r\n          avg_response_time_hours: 1.2,\r\n          total_assignments: 156,\r\n          active_leads: 12,\r\n        },\r\n        {\r\n          id: '2',\r\n          user_name: 'Sarah Miller',\r\n          user_email: 'sarah@company.com',\r\n          is_available: true,\r\n          current_load: 8,\r\n          max_capacity: 15,\r\n          specializations: ['SMB', 'E-commerce'],\r\n          territories: ['North America'],\r\n          conversion_rate: 28.3,\r\n          avg_response_time_hours: 2.1,\r\n          total_assignments: 134,\r\n          active_leads: 8,\r\n        },\r\n        {\r\n          id: '3',\r\n          user_name: 'Mike Chen',\r\n          user_email: 'mike@company.com',\r\n          is_available: false,\r\n          current_load: 15,\r\n          max_capacity: 15,\r\n          specializations: ['Enterprise', 'Healthcare'],\r\n          territories: ['Asia Pacific'],\r\n          conversion_rate: 35.8,\r\n          avg_response_time_hours: 0.8,\r\n          total_assignments: 189,\r\n          active_leads: 15,\r\n        },\r\n        {\r\n          id: '4',\r\n          user_name: 'Emily Davis',\r\n          user_email: 'emily@company.com',\r\n          is_available: true,\r\n          current_load: 5,\r\n          max_capacity: 20,\r\n          specializations: ['Startup', 'Tech'],\r\n          territories: ['Europe', 'Middle East'],\r\n          conversion_rate: 24.1,\r\n          avg_response_time_hours: 3.5,\r\n          total_assignments: 98,\r\n          active_leads: 5,\r\n        },\r\n      ]);\r\n      setRules([\r\n        {\r\n          id: '1',\r\n          name: 'Enterprise Round Robin',\r\n          priority: 1,\r\n          is_active: true,\r\n          routing_type: 'round_robin',\r\n          conditions: { company_size: 'enterprise' },\r\n          assigned_reps_count: 4,\r\n          leads_routed: 234,\r\n          success_rate: 78.5,\r\n        },\r\n        {\r\n          id: '2',\r\n          name: 'Territory-Based Routing',\r\n          priority: 2,\r\n          is_active: true,\r\n          routing_type: 'territory',\r\n          conditions: { by_region: true },\r\n          assigned_reps_count: 6,\r\n          leads_routed: 456,\r\n          success_rate: 82.3,\r\n        },\r\n        {\r\n          id: '3',\r\n          name: 'AI Smart Routing',\r\n          priority: 3,\r\n          is_active: true,\r\n          routing_type: 'ai',\r\n          conditions: { use_ai_matching: true },\r\n          assigned_reps_count: 8,\r\n          leads_routed: 189,\r\n          success_rate: 91.2,\r\n        },\r\n        {\r\n          id: '4',\r\n          name: 'SMB Weighted Distribution',\r\n          priority: 4,\r\n          is_active: false,\r\n          routing_type: 'weighted',\r\n          conditions: { company_size: 'smb' },\r\n          assigned_reps_count: 3,\r\n          leads_routed: 123,\r\n          success_rate: 65.4,\r\n        },\r\n      ]);\r\n      setAssignments([\r\n        {\r\n          id: '1',\r\n          lead_name: 'John Smith',\r\n          lead_email: 'john@acme.com',\r\n          lead_company: 'Acme Corp',\r\n          assigned_to: 'Alex Johnson',\r\n          status: 'accepted',\r\n          assignment_reason: 'Territory match + Enterprise specialization',\r\n          match_score: 92,\r\n          assigned_at: new Date(Date.now() - 3600000).toISOString(),\r\n          response_time_hours: 0.5,\r\n        },\r\n        {\r\n          id: '2',\r\n          lead_name: 'Lisa Wang',\r\n          lead_email: 'lisa@techstartup.io',\r\n          lead_company: 'TechStartup',\r\n          assigned_to: 'Emily Davis',\r\n          status: 'pending',\r\n          assignment_reason: 'AI match: Startup specialization',\r\n          match_score: 87,\r\n          assigned_at: new Date(Date.now() - 1800000).toISOString(),\r\n        },\r\n        {\r\n          id: '3',\r\n          lead_name: 'Robert Brown',\r\n          lead_email: 'robert@healthcare.org',\r\n          lead_company: 'HealthCare Inc',\r\n          assigned_to: 'Mike Chen',\r\n          status: 'converted',\r\n          assignment_reason: 'Healthcare vertical expertise',\r\n          match_score: 95,\r\n          assigned_at: new Date(Date.now() - 86400000 * 3).toISOString(),\r\n          response_time_hours: 0.3,\r\n        },\r\n        {\r\n          id: '4',\r\n          lead_name: 'Amanda Green',\r\n          lead_email: 'amanda@retail.com',\r\n          lead_company: 'Retail Plus',\r\n          assigned_to: 'Sarah Miller',\r\n          status: 'escalated',\r\n          assignment_reason: 'Round robin assignment',\r\n          match_score: 72,\r\n          assigned_at: new Date(Date.now() - 86400000).toISOString(),\r\n          response_time_hours: 8.2,\r\n        },\r\n      ]);\r\n      setMetrics({\r\n        total_leads_routed_today: 47,\r\n        avg_assignment_time_seconds: 2.3,\r\n        acceptance_rate: 89.5,\r\n        conversion_rate: 28.7,\r\n        avg_response_time_hours: 1.8,\r\n        leads_pending: 12,\r\n        leads_escalated: 3,\r\n        top_performer_id: '3',\r\n        top_performer_name: 'Mike Chen',\r\n      });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    fetchData();\r\n  }, [fetchData]);\r\n\r\n  const handleToggleAvailability = async (repId: string, isAvailable: boolean) => {\r\n    try {\r\n      await leadRoutingAPI.updateAvailability(repId, { is_available: !isAvailable });\r\n      toast.success(`Availability ${!isAvailable ? 'enabled' : 'disabled'}`);\r\n      fetchData();\r\n    } catch {\r\n      toast.error('Failed to update availability');\r\n    }\r\n  };\r\n\r\n  const handleToggleRule = async (ruleId: string, isActive: boolean) => {\r\n    try {\r\n      await leadRoutingAPI.updateRoutingRule(ruleId, { is_active: !isActive });\r\n      toast.success(`Rule ${!isActive ? 'activated' : 'deactivated'}`);\r\n      fetchData();\r\n    } catch {\r\n      toast.error('Failed to update rule');\r\n    }\r\n  };\r\n\r\n  const getStatusBadge = (status: string) => {\r\n    const variants: Record<string, { variant: 'default' | 'secondary' | 'destructive' | 'outline'; color: string }> = {\r\n      pending: { variant: 'outline', color: 'text-yellow-600' },\r\n      accepted: { variant: 'default', color: 'text-green-600' },\r\n      rejected: { variant: 'destructive', color: 'text-red-600' },\r\n      escalated: { variant: 'secondary', color: 'text-orange-600' },\r\n      converted: { variant: 'default', color: 'text-blue-600' },\r\n    };\r\n    const config = variants[status] || { variant: 'outline' as const, color: '' };\r\n    return (\r\n      <Badge variant={config.variant} className={`capitalize ${config.color}`}>\r\n        {status}\r\n      </Badge>\r\n    );\r\n  };\r\n\r\n  const getRoutingTypeBadge = (type: string) => {\r\n    const icons: Record<string, React.ReactNode> = {\r\n      round_robin: <Shuffle className=\"w-3 h-3 mr-1\" />,\r\n      weighted: <BarChart3 className=\"w-3 h-3 mr-1\" />,\r\n      skill_based: <Target className=\"w-3 h-3 mr-1\" />,\r\n      territory: <MapPin className=\"w-3 h-3 mr-1\" />,\r\n      ai: <Zap className=\"w-3 h-3 mr-1\" />,\r\n    };\r\n    return (\r\n      <Badge variant=\"outline\" className=\"capitalize\">\r\n        {icons[type]}\r\n        {type.replace('_', ' ')}\r\n      </Badge>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <ProtectedRoute>\r\n      <MainLayout>\r\n        <div className=\"p-6 space-y-6\">\r\n          {/* Header */}\r\n          <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4\">\r\n            <div>\r\n              <h1 className=\"text-3xl font-bold gradient-text flex items-center gap-2\">\r\n                <Route className=\"w-8 h-8\" />\r\n                Lead Routing\r\n              </h1>\r\n              <p className=\"text-muted-foreground mt-1\">\r\n                AI-powered lead assignment and distribution\r\n              </p>\r\n            </div>\r\n            <div className=\"flex items-center gap-3\">\r\n              <Button variant=\"outline\" onClick={() => fetchData()}>\r\n                <RefreshCw className=\"w-4 h-4 mr-2\" />\r\n                Refresh\r\n              </Button>\r\n              <Dialog open={createRuleDialogOpen} onOpenChange={setCreateRuleDialogOpen}>\r\n                <DialogTrigger asChild>\r\n                  <Button className=\"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700\">\r\n                    <Plus className=\"w-4 h-4 mr-2\" />\r\n                    New Rule\r\n                  </Button>\r\n                </DialogTrigger>\r\n                <DialogContent>\r\n                  <DialogHeader>\r\n                    <DialogTitle>Create Routing Rule</DialogTitle>\r\n                    <DialogDescription>\r\n                      Set up a new rule for automatic lead assignment\r\n                    </DialogDescription>\r\n                  </DialogHeader>\r\n                  <div className=\"space-y-4 py-4\">\r\n                    <div className=\"space-y-2\">\r\n                      <Label>Rule Name</Label>\r\n                      <Input placeholder=\"e.g., Enterprise Lead Routing\" />\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label>Routing Type</Label>\r\n                      <Select>\r\n                        <SelectTrigger>\r\n                          <SelectValue placeholder=\"Select type\" />\r\n                        </SelectTrigger>\r\n                        <SelectContent>\r\n                          <SelectItem value=\"round_robin\">Round Robin</SelectItem>\r\n                          <SelectItem value=\"weighted\">Weighted Distribution</SelectItem>\r\n                          <SelectItem value=\"skill_based\">Skill-Based</SelectItem>\r\n                          <SelectItem value=\"territory\">Territory-Based</SelectItem>\r\n                          <SelectItem value=\"ai\">AI Smart Routing</SelectItem>\r\n                        </SelectContent>\r\n                      </Select>\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label>Priority</Label>\r\n                      <Input type=\"number\" placeholder=\"1\" min={1} max={100} />\r\n                    </div>\r\n                    <Button className=\"w-full\">Create Rule</Button>\r\n                  </div>\r\n                </DialogContent>\r\n              </Dialog>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Metrics Cards */}\r\n          {loading ? (\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n              {[1, 2, 3, 4].map((i) => (\r\n                <Skeleton key={i} className=\"h-32\" />\r\n              ))}\r\n            </div>\r\n          ) : (\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n              <Card className=\"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-950/50 dark:to-blue-900/30 border-blue-200 dark:border-blue-800\">\r\n                <CardContent className=\"pt-6\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <p className=\"text-sm text-muted-foreground\">Routed Today</p>\r\n                      <p className=\"text-3xl font-bold text-blue-600 dark:text-blue-400\">\r\n                        {metrics?.total_leads_routed_today || 0}\r\n                      </p>\r\n                      <p className=\"text-xs text-muted-foreground mt-1\">\r\n                        {metrics?.avg_assignment_time_seconds?.toFixed(1)}s avg time\r\n                      </p>\r\n                    </div>\r\n                    <div className=\"w-12 h-12 bg-blue-500/20 rounded-xl flex items-center justify-center\">\r\n                      <UserPlus className=\"w-6 h-6 text-blue-600 dark:text-blue-400\" />\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n\r\n              <Card className=\"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-950/50 dark:to-green-900/30 border-green-200 dark:border-green-800\">\r\n                <CardContent className=\"pt-6\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <p className=\"text-sm text-muted-foreground\">Acceptance Rate</p>\r\n                      <p className=\"text-3xl font-bold text-green-600 dark:text-green-400\">\r\n                        {metrics?.acceptance_rate?.toFixed(1) || 0}%\r\n                      </p>\r\n                      <p className=\"text-xs text-muted-foreground mt-1\">\r\n                        {metrics?.conversion_rate?.toFixed(1)}% conversion\r\n                      </p>\r\n                    </div>\r\n                    <div className=\"w-12 h-12 bg-green-500/20 rounded-xl flex items-center justify-center\">\r\n                      <UserCheck className=\"w-6 h-6 text-green-600 dark:text-green-400\" />\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n\r\n              <Card className=\"bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-950/50 dark:to-purple-900/30 border-purple-200 dark:border-purple-800\">\r\n                <CardContent className=\"pt-6\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <p className=\"text-sm text-muted-foreground\">Avg Response</p>\r\n                      <p className=\"text-3xl font-bold text-purple-600 dark:text-purple-400\">\r\n                        {metrics?.avg_response_time_hours?.toFixed(1) || 0}h\r\n                      </p>\r\n                      <p className=\"text-xs text-muted-foreground mt-1\">\r\n                        {metrics?.leads_pending || 0} pending\r\n                      </p>\r\n                    </div>\r\n                    <div className=\"w-12 h-12 bg-purple-500/20 rounded-xl flex items-center justify-center\">\r\n                      <Clock className=\"w-6 h-6 text-purple-600 dark:text-purple-400\" />\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n\r\n              <Card className=\"bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-950/50 dark:to-orange-900/30 border-orange-200 dark:border-orange-800\">\r\n                <CardContent className=\"pt-6\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <p className=\"text-sm text-muted-foreground\">Top Performer</p>\r\n                      <p className=\"text-lg font-bold text-orange-600 dark:text-orange-400 truncate\">\r\n                        {metrics?.top_performer_name || 'N/A'}\r\n                      </p>\r\n                      <p className=\"text-xs text-muted-foreground mt-1\">\r\n                        {metrics?.leads_escalated || 0} escalated\r\n                      </p>\r\n                    </div>\r\n                    <div className=\"w-12 h-12 bg-orange-500/20 rounded-xl flex items-center justify-center\">\r\n                      <Award className=\"w-6 h-6 text-orange-600 dark:text-orange-400\" />\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n          )}\r\n\r\n          {/* Tabs */}\r\n          <Tabs value={selectedTab} onValueChange={setSelectedTab}>\r\n            <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4\">\r\n              <TabsList>\r\n                <TabsTrigger value=\"dashboard\" className=\"gap-2\">\r\n                  <BarChart3 className=\"w-4 h-4\" />\r\n                  Dashboard\r\n                </TabsTrigger>\r\n                <TabsTrigger value=\"reps\" className=\"gap-2\">\r\n                  <Users className=\"w-4 h-4\" />\r\n                  Sales Reps\r\n                </TabsTrigger>\r\n                <TabsTrigger value=\"rules\" className=\"gap-2\">\r\n                  <Settings className=\"w-4 h-4\" />\r\n                  Rules\r\n                </TabsTrigger>\r\n                <TabsTrigger value=\"assignments\" className=\"gap-2\">\r\n                  <ArrowRight className=\"w-4 h-4\" />\r\n                  Assignments\r\n                </TabsTrigger>\r\n              </TabsList>\r\n              <div className=\"relative w-full md:w-64\">\r\n                <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground\" />\r\n                <Input\r\n                  placeholder=\"Search...\"\r\n                  className=\"pl-10\"\r\n                  value={searchQuery}\r\n                  onChange={(e) => setSearchQuery(e.target.value)}\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <TabsContent value=\"dashboard\" className=\"mt-6\">\r\n              <div className=\"grid lg:grid-cols-2 gap-6\">\r\n                {/* Rep Workload */}\r\n                <Card>\r\n                  <CardHeader>\r\n                    <CardTitle className=\"text-lg\">Team Workload</CardTitle>\r\n                    <CardDescription>Current capacity utilization</CardDescription>\r\n                  </CardHeader>\r\n                  <CardContent className=\"space-y-4\">\r\n                    {reps.slice(0, 4).map((rep) => (\r\n                      <div key={rep.id} className=\"space-y-2\">\r\n                        <div className=\"flex items-center justify-between\">\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <Avatar className=\"h-8 w-8\">\r\n                              <AvatarImage src={rep.avatar_url} />\r\n                              <AvatarFallback>{rep.user_name.split(' ').map(n => n[0]).join('')}</AvatarFallback>\r\n                            </Avatar>\r\n                            <div>\r\n                              <p className=\"text-sm font-medium\">{rep.user_name}</p>\r\n                              <p className=\"text-xs text-muted-foreground\">\r\n                                {rep.current_load}/{rep.max_capacity} leads\r\n                              </p>\r\n                            </div>\r\n                          </div>\r\n                          <Badge variant={rep.is_available ? 'default' : 'secondary'}>\r\n                            {rep.is_available ? 'Available' : 'Busy'}\r\n                          </Badge>\r\n                        </div>\r\n                        <Progress\r\n                          value={(rep.current_load / rep.max_capacity) * 100}\r\n                          className=\"h-2\"\r\n                        />\r\n                      </div>\r\n                    ))}\r\n                  </CardContent>\r\n                </Card>\r\n\r\n                {/* Recent Assignments */}\r\n                <Card>\r\n                  <CardHeader>\r\n                    <CardTitle className=\"text-lg\">Recent Assignments</CardTitle>\r\n                    <CardDescription>Latest lead routing activity</CardDescription>\r\n                  </CardHeader>\r\n                  <CardContent className=\"space-y-4\">\r\n                    {assignments.slice(0, 4).map((assignment) => (\r\n                      <div\r\n                        key={assignment.id}\r\n                        className=\"flex items-center justify-between p-3 rounded-lg bg-muted/50\"\r\n                      >\r\n                        <div className=\"flex-1 min-w-0\">\r\n                          <p className=\"font-medium truncate\">{assignment.lead_name}</p>\r\n                          <p className=\"text-sm text-muted-foreground truncate\">\r\n                            {assignment.lead_company}\r\n                          </p>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-2 ml-4\">\r\n                          <ArrowRight className=\"w-4 h-4 text-muted-foreground\" />\r\n                          <span className=\"text-sm\">{assignment.assigned_to}</span>\r\n                          {getStatusBadge(assignment.status)}\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </CardContent>\r\n                </Card>\r\n              </div>\r\n            </TabsContent>\r\n\r\n            <TabsContent value=\"reps\" className=\"mt-6\">\r\n              {loading ? (\r\n                <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n                  {[1, 2, 3, 4].map((i) => (\r\n                    <Skeleton key={i} className=\"h-64\" />\r\n                  ))}\r\n                </div>\r\n              ) : (\r\n                <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n                  {reps.map((rep) => (\r\n                    <Card key={rep.id} className=\"hover:shadow-lg transition-shadow\">\r\n                      <CardContent className=\"pt-6\">\r\n                        <div className=\"flex items-start justify-between mb-4\">\r\n                          <div className=\"flex items-center gap-3\">\r\n                            <Avatar className=\"h-12 w-12\">\r\n                              <AvatarImage src={rep.avatar_url} />\r\n                              <AvatarFallback className=\"bg-gradient-to-br from-blue-500 to-purple-500 text-white\">\r\n                                {rep.user_name.split(' ').map(n => n[0]).join('')}\r\n                              </AvatarFallback>\r\n                            </Avatar>\r\n                            <div>\r\n                              <p className=\"font-semibold\">{rep.user_name}</p>\r\n                              <p className=\"text-sm text-muted-foreground\">{rep.user_email}</p>\r\n                            </div>\r\n                          </div>\r\n                          <Switch\r\n                            checked={rep.is_available}\r\n                            onCheckedChange={() => handleToggleAvailability(rep.id, rep.is_available)}\r\n                          />\r\n                        </div>\r\n\r\n                        <div className=\"space-y-3\">\r\n                          <div>\r\n                            <div className=\"flex items-center justify-between text-sm mb-1\">\r\n                              <span className=\"text-muted-foreground\">Workload</span>\r\n                              <span>{rep.current_load}/{rep.max_capacity}</span>\r\n                            </div>\r\n                            <Progress value={(rep.current_load / rep.max_capacity) * 100} className=\"h-2\" />\r\n                          </div>\r\n\r\n                          <div className=\"grid grid-cols-2 gap-2 text-sm\">\r\n                            <div className=\"flex items-center gap-1\">\r\n                              <TrendingUp className=\"w-4 h-4 text-green-500\" />\r\n                              <span>{rep.conversion_rate}% conv.</span>\r\n                            </div>\r\n                            <div className=\"flex items-center gap-1\">\r\n                              <Clock className=\"w-4 h-4 text-blue-500\" />\r\n                              <span>{rep.avg_response_time_hours}h resp.</span>\r\n                            </div>\r\n                          </div>\r\n\r\n                          <div className=\"flex flex-wrap gap-1\">\r\n                            {rep.specializations.map((spec) => (\r\n                              <Badge key={spec} variant=\"outline\" className=\"text-xs\">\r\n                                {spec}\r\n                              </Badge>\r\n                            ))}\r\n                          </div>\r\n\r\n                          <div className=\"flex items-center gap-1 text-sm text-muted-foreground\">\r\n                            <MapPin className=\"w-4 h-4\" />\r\n                            {rep.territories.join(', ')}\r\n                          </div>\r\n                        </div>\r\n                      </CardContent>\r\n                    </Card>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </TabsContent>\r\n\r\n            <TabsContent value=\"rules\" className=\"mt-6\">\r\n              {loading ? (\r\n                <div className=\"space-y-4\">\r\n                  {[1, 2, 3].map((i) => (\r\n                    <Skeleton key={i} className=\"h-24\" />\r\n                  ))}\r\n                </div>\r\n              ) : (\r\n                <div className=\"space-y-4\">\r\n                  {rules.map((rule) => (\r\n                    <Card key={rule.id} className=\"hover:shadow-md transition-shadow\">\r\n                      <CardContent className=\"p-4\">\r\n                        <div className=\"flex items-center justify-between\">\r\n                          <div className=\"flex items-center gap-4\">\r\n                            <div className=\"flex items-center justify-center w-10 h-10 rounded-lg bg-primary/10\">\r\n                              <span className=\"font-bold text-primary\">{rule.priority}</span>\r\n                            </div>\r\n                            <div>\r\n                              <div className=\"flex items-center gap-2\">\r\n                                <h3 className=\"font-semibold\">{rule.name}</h3>\r\n                                {getRoutingTypeBadge(rule.routing_type)}\r\n                              </div>\r\n                              <div className=\"flex items-center gap-4 mt-1 text-sm text-muted-foreground\">\r\n                                <span>{rule.assigned_reps_count} reps assigned</span>\r\n                                <span>{rule.leads_routed} leads routed</span>\r\n                                <span>{rule.success_rate}% success</span>\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <Switch\r\n                              checked={rule.is_active}\r\n                              onCheckedChange={() => handleToggleRule(rule.id, rule.is_active)}\r\n                            />\r\n                            <Button variant=\"ghost\" size=\"sm\">\r\n                              <MoreVertical className=\"w-4 h-4\" />\r\n                            </Button>\r\n                          </div>\r\n                        </div>\r\n                      </CardContent>\r\n                    </Card>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </TabsContent>\r\n\r\n            <TabsContent value=\"assignments\" className=\"mt-6\">\r\n              {loading ? (\r\n                <Skeleton className=\"h-96\" />\r\n              ) : (\r\n                <Card>\r\n                  <CardContent className=\"p-0\">\r\n                    <div className=\"overflow-x-auto\">\r\n                      <table className=\"w-full\">\r\n                        <thead className=\"bg-muted/50\">\r\n                          <tr>\r\n                            <th className=\"px-4 py-3 text-left text-sm font-medium\">Lead</th>\r\n                            <th className=\"px-4 py-3 text-left text-sm font-medium\">Company</th>\r\n                            <th className=\"px-4 py-3 text-left text-sm font-medium\">Assigned To</th>\r\n                            <th className=\"px-4 py-3 text-left text-sm font-medium\">Match Score</th>\r\n                            <th className=\"px-4 py-3 text-left text-sm font-medium\">Status</th>\r\n                            <th className=\"px-4 py-3 text-left text-sm font-medium\">Response</th>\r\n                            <th className=\"px-4 py-3 text-right text-sm font-medium\">Actions</th>\r\n                          </tr>\r\n                        </thead>\r\n                        <tbody className=\"divide-y\">\r\n                          {assignments.map((assignment) => (\r\n                            <tr key={assignment.id} className=\"hover:bg-muted/30\">\r\n                              <td className=\"px-4 py-3\">\r\n                                <div>\r\n                                  <p className=\"font-medium\">{assignment.lead_name}</p>\r\n                                  <p className=\"text-sm text-muted-foreground\">{assignment.lead_email}</p>\r\n                                </div>\r\n                              </td>\r\n                              <td className=\"px-4 py-3\">\r\n                                <div className=\"flex items-center gap-2\">\r\n                                  <Building2 className=\"w-4 h-4 text-muted-foreground\" />\r\n                                  {assignment.lead_company}\r\n                                </div>\r\n                              </td>\r\n                              <td className=\"px-4 py-3\">\r\n                                <div className=\"flex items-center gap-2\">\r\n                                  <Avatar className=\"h-6 w-6\">\r\n                                    <AvatarFallback className=\"text-xs\">\r\n                                      {assignment.assigned_to.split(' ').map(n => n[0]).join('')}\r\n                                    </AvatarFallback>\r\n                                  </Avatar>\r\n                                  {assignment.assigned_to}\r\n                                </div>\r\n                              </td>\r\n                              <td className=\"px-4 py-3\">\r\n                                <div className=\"flex items-center gap-2\">\r\n                                  <Progress value={assignment.match_score} className=\"w-16 h-2\" />\r\n                                  <span className=\"text-sm font-medium\">{assignment.match_score}%</span>\r\n                                </div>\r\n                              </td>\r\n                              <td className=\"px-4 py-3\">{getStatusBadge(assignment.status)}</td>\r\n                              <td className=\"px-4 py-3 text-sm text-muted-foreground\">\r\n                                {assignment.response_time_hours\r\n                                  ? `${assignment.response_time_hours}h`\r\n                                  : 'Pending'}\r\n                              </td>\r\n                              <td className=\"px-4 py-3 text-right\">\r\n                                <div className=\"flex items-center justify-end gap-1\">\r\n                                  <Button variant=\"ghost\" size=\"sm\" title=\"Reassign\">\r\n                                    <Shuffle className=\"w-4 h-4\" />\r\n                                  </Button>\r\n                                  <Button variant=\"ghost\" size=\"sm\">\r\n                                    <MoreVertical className=\"w-4 h-4\" />\r\n                                  </Button>\r\n                                </div>\r\n                              </td>\r\n                            </tr>\r\n                          ))}\r\n                        </tbody>\r\n                      </table>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n              )}\r\n            </TabsContent>\r\n          </Tabs>\r\n        </div>\r\n      </MainLayout>\r\n    </ProtectedRoute>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\leads\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\login\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\offline\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\onboarding\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\opportunities\\page.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchOpportunities'. Either include it or remove the dependency array.","line":160,"column":6,"nodeType":"ArrayExpression","endLine":160,"endColumn":34,"suggestions":[{"desc":"Update the dependencies array to be: [fetchOpportunities, searchQuery, selectedStage]","fix":{"range":[4957,4985],"text":"[fetchOpportunities, searchQuery, selectedStage]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\organizations\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\page_new.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\reports\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\revenue-intelligence\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\scheduling\\ai\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Textarea' is defined but never used.","line":13,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Plus' is defined but never used.","line":24,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":24,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendingUp' is defined but never used.","line":26,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":26,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MapPin' is defined but never used.","line":31,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":31,"endColumn":9},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":53,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":53,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1648,1651],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1648,1651],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":73,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":73,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2083,2086],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2083,2086],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":74,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":74,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2113,2116],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2113,2116],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'loading' is assigned a value but never used.","line":104,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":104,"endColumn":17},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`fetchData` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nE:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\scheduling\\ai\\page.tsx:111:5\n  109 |\n  110 |   useEffect(() => {\n> 111 |     fetchData();\n      |     ^^^^^^^^^ `fetchData` accessed before it is declared\n  112 |   }, []);\n  113 |\n  114 |   const fetchData = async () => {\n\nE:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\scheduling\\ai\\page.tsx:114:3\n  112 |   }, []);\n  113 |\n> 114 |   const fetchData = async () => {\n      |   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 115 |     setLoading(true);\n      | ^^^^^^^^^^^^^^^^^^^^^\n> 116 |     try {\n      …\n      | ^^^^^^^^^^^^^^^^^^^^^\n> 135 |     setLoading(false);\n      | ^^^^^^^^^^^^^^^^^^^^^\n> 136 |   };\n      | ^^^^^ `fetchData` is declared here\n  137 |\n  138 |   const loadDemoData = () => {\n  139 |     setPreferences({","line":111,"column":5,"nodeType":null,"endLine":111,"endColumn":14},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchData'. Either include it or remove the dependency array.","line":112,"column":6,"nodeType":"ArrayExpression","endLine":112,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [fetchData]","fix":{"range":[3408,3410],"text":"[fetchData]"}}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":259,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":259,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'generateMeetingPrep' is assigned a value but never used.","line":266,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":266,"endColumn":28},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'response' is assigned a value but never used.","line":268,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":268,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":271,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":271,"endColumn":19},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":528,"column":28,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[22542,22607],"text":"\r\n                      Today&apos;s AI Insights\r\n                    "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[22542,22607],"text":"\r\n                      Today&lsquo;s AI Insights\r\n                    "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[22542,22607],"text":"\r\n                      Today&#39;s AI Insights\r\n                    "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[22542,22607],"text":"\r\n                      Today&rsquo;s AI Insights\r\n                    "},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport MainLayout from '@/components/Layout/MainLayout';\r\nimport ProtectedRoute from '@/components/ProtectedRoute';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from '@/components/ui/dialog';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Switch } from '@/components/ui/switch';\r\nimport { toast } from 'sonner';\r\nimport { \r\n  CalendarDays, \r\n  Clock, \r\n  Brain, \r\n  Target, \r\n  AlertTriangle, \r\n  CheckCircle2, \r\n  Plus, \r\n  Sparkles,\r\n  TrendingUp,\r\n  Calendar,\r\n  Bell,\r\n  FileText,\r\n  User,\r\n  MapPin,\r\n  Video,\r\n  Phone,\r\n  RefreshCw,\r\n  Settings,\r\n  Zap,\r\n  Activity\r\n} from 'lucide-react';\r\nimport { smartSchedulingAIAPI } from '@/lib/ai-workflow-api';\r\n\r\ninterface AIPreference {\r\n  id: number;\r\n  user: number;\r\n  preferred_start_hour: number;\r\n  preferred_end_hour: number;\r\n  max_meetings_per_day: number;\r\n  buffer_minutes: number;\r\n  focus_time_blocks: boolean;\r\n  preferred_meeting_lengths: number[];\r\n  avoid_back_to_back: boolean;\r\n  timezone: string;\r\n  working_days: number[];\r\n  meeting_type_preferences: Record<string, any>;\r\n}\r\n\r\ninterface NoShowPrediction {\r\n  id: number;\r\n  meeting_title: string;\r\n  scheduled_time: string;\r\n  no_show_probability: number;\r\n  risk_factors: string[];\r\n  recommended_actions: string[];\r\n  confidence_score: number;\r\n  attendee_name?: string;\r\n}\r\n\r\ninterface MeetingPrep {\r\n  id: number;\r\n  meeting_title: string;\r\n  meeting_time: string;\r\n  contact_summary: string;\r\n  talking_points: string[];\r\n  recent_interactions: any[];\r\n  open_opportunities: any[];\r\n  suggested_agenda: string[];\r\n  risk_alerts: string[];\r\n  prepared_at: string;\r\n}\r\n\r\ninterface SmartReminder {\r\n  id: number;\r\n  meeting_title: string;\r\n  meeting_time: string;\r\n  reminder_type: string;\r\n  reminder_content: string;\r\n  scheduled_for: string;\r\n  sent: boolean;\r\n}\r\n\r\ninterface OptimalSlot {\r\n  start_time: string;\r\n  end_time: string;\r\n  score: number;\r\n  factors: string[];\r\n}\r\n\r\nexport default function SmartSchedulingAIPage() {\r\n  const [activeTab, setActiveTab] = useState('overview');\r\n  const [preferences, setPreferences] = useState<AIPreference | null>(null);\r\n  const [noShowPredictions, setNoShowPredictions] = useState<NoShowPrediction[]>([]);\r\n  const [meetingPreps, setMeetingPreps] = useState<MeetingPrep[]>([]);\r\n  const [reminders, setReminders] = useState<SmartReminder[]>([]);\r\n  const [optimalSlots, setOptimalSlots] = useState<OptimalSlot[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [isPreferencesDialogOpen, setIsPreferencesDialogOpen] = useState(false);\r\n  const [isFindingSlotsDialogOpen, setIsFindingSlotsDialogOpen] = useState(false);\r\n  const [slotDuration, setSlotDuration] = useState(30);\r\n  const [slotDate, setSlotDate] = useState(new Date().toISOString().split('T')[0]);\r\n\r\n  useEffect(() => {\r\n    fetchData();\r\n  }, []);\r\n\r\n  const fetchData = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const [prefResponse, predictionsResponse, remindersResponse] = await Promise.all([\r\n        smartSchedulingAIAPI.getAIPreferences().catch(() => ({ data: null })),\r\n        smartSchedulingAIAPI.getNoShowPredictions().catch(() => ({ data: { results: [] } })),\r\n        smartSchedulingAIAPI.getSmartReminders().catch(() => ({ data: { results: [] } }))\r\n      ]);\r\n      \r\n      setPreferences(prefResponse.data);\r\n      setNoShowPredictions(predictionsResponse.data.results || []);\r\n      setReminders(remindersResponse.data.results || []);\r\n      \r\n      // Load demo data if API returns empty\r\n      if (!prefResponse.data && predictionsResponse.data.results?.length === 0) {\r\n        loadDemoData();\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to fetch data:', error);\r\n      loadDemoData();\r\n    }\r\n    setLoading(false);\r\n  };\r\n\r\n  const loadDemoData = () => {\r\n    setPreferences({\r\n      id: 1,\r\n      user: 1,\r\n      preferred_start_hour: 9,\r\n      preferred_end_hour: 17,\r\n      max_meetings_per_day: 6,\r\n      buffer_minutes: 15,\r\n      focus_time_blocks: true,\r\n      preferred_meeting_lengths: [30, 60],\r\n      avoid_back_to_back: true,\r\n      timezone: 'America/New_York',\r\n      working_days: [0, 1, 2, 3, 4],\r\n      meeting_type_preferences: {\r\n        'sales_call': { max_per_day: 4, preferred_time: 'morning' },\r\n        'demo': { max_per_day: 2, preferred_time: 'afternoon' },\r\n        'internal': { max_per_day: 3, preferred_time: 'any' }\r\n      }\r\n    });\r\n\r\n    setNoShowPredictions([\r\n      {\r\n        id: 1,\r\n        meeting_title: 'Product Demo - TechCorp',\r\n        scheduled_time: new Date(Date.now() + 86400000).toISOString(),\r\n        no_show_probability: 0.72,\r\n        risk_factors: ['First meeting with contact', 'No email response to confirmation', 'Friday afternoon slot'],\r\n        recommended_actions: ['Send reminder 2 hours before', 'Call to confirm attendance', 'Have backup slot ready'],\r\n        confidence_score: 0.89,\r\n        attendee_name: 'John Smith'\r\n      },\r\n      {\r\n        id: 2,\r\n        meeting_title: 'Sales Call - StartupXYZ',\r\n        scheduled_time: new Date(Date.now() + 172800000).toISOString(),\r\n        no_show_probability: 0.35,\r\n        risk_factors: ['Rescheduled twice before', 'Competitor evaluation in progress'],\r\n        recommended_actions: ['Send value proposition reminder', 'Confirm via LinkedIn'],\r\n        confidence_score: 0.85,\r\n        attendee_name: 'Sarah Johnson'\r\n      },\r\n      {\r\n        id: 3,\r\n        meeting_title: 'Follow-up Call - Enterprise Inc',\r\n        scheduled_time: new Date(Date.now() + 259200000).toISOString(),\r\n        no_show_probability: 0.15,\r\n        risk_factors: ['Busy executive schedule'],\r\n        recommended_actions: ['Standard reminder'],\r\n        confidence_score: 0.92,\r\n        attendee_name: 'Michael Brown'\r\n      }\r\n    ]);\r\n\r\n    setMeetingPreps([\r\n      {\r\n        id: 1,\r\n        meeting_title: 'Quarterly Review - Acme Corp',\r\n        meeting_time: new Date(Date.now() + 7200000).toISOString(),\r\n        contact_summary: 'Long-term customer since 2021. Primary contact: Jennifer Lee (VP Sales). Currently using Professional tier with 50 seats.',\r\n        talking_points: ['Q3 usage growth of 25%', 'Expansion to marketing team', 'New feature requests', 'Contract renewal in 60 days'],\r\n        recent_interactions: [\r\n          { type: 'email', date: '2024-01-08', summary: 'Sent Q3 usage report' },\r\n          { type: 'call', date: '2024-01-05', summary: 'Discussed integration needs' }\r\n        ],\r\n        open_opportunities: [\r\n          { name: 'Seat expansion', value: 25000, stage: 'Negotiation' }\r\n        ],\r\n        suggested_agenda: ['Review Q3 metrics', 'Discuss expansion plans', 'Preview new features', 'Renewal timeline'],\r\n        risk_alerts: ['Competitor meeting scheduled for next week'],\r\n        prepared_at: new Date().toISOString()\r\n      },\r\n      {\r\n        id: 2,\r\n        meeting_title: 'Discovery Call - NewCo',\r\n        meeting_time: new Date(Date.now() + 86400000).toISOString(),\r\n        contact_summary: 'Inbound lead from webinar. Company: 200 employees, Series B funded. Contact: Tom Wilson (Head of Operations).',\r\n        talking_points: ['Current pain points', 'Evaluation criteria', 'Budget and timeline', 'Decision-making process'],\r\n        recent_interactions: [\r\n          { type: 'webinar', date: '2024-01-06', summary: 'Attended AI automation webinar' }\r\n        ],\r\n        open_opportunities: [],\r\n        suggested_agenda: ['Introduction', 'Understand current challenges', 'Solution overview', 'Next steps'],\r\n        risk_alerts: [],\r\n        prepared_at: new Date().toISOString()\r\n      }\r\n    ]);\r\n\r\n    setReminders([\r\n      {\r\n        id: 1,\r\n        meeting_title: 'Product Demo - TechCorp',\r\n        meeting_time: new Date(Date.now() + 86400000).toISOString(),\r\n        reminder_type: 'preparation',\r\n        reminder_content: 'Review TechCorp\\'s recent product usage and prepare custom demo scenarios',\r\n        scheduled_for: new Date(Date.now() + 82800000).toISOString(),\r\n        sent: false\r\n      },\r\n      {\r\n        id: 2,\r\n        meeting_title: 'Quarterly Review - Acme Corp',\r\n        meeting_time: new Date(Date.now() + 7200000).toISOString(),\r\n        reminder_type: 'follow_up',\r\n        reminder_content: 'Prepare renewal proposal and expansion pricing',\r\n        scheduled_for: new Date(Date.now() + 3600000).toISOString(),\r\n        sent: false\r\n      }\r\n    ]);\r\n\r\n    setOptimalSlots([\r\n      { start_time: '09:00', end_time: '09:30', score: 0.95, factors: ['Peak productivity time', 'No conflicts', 'Focus block available'] },\r\n      { start_time: '10:00', end_time: '10:30', score: 0.88, factors: ['Good energy levels', 'Buffer after previous meeting'] },\r\n      { start_time: '14:00', end_time: '14:30', score: 0.82, factors: ['Post-lunch focus time', 'Matches attendee preference'] },\r\n      { start_time: '15:30', end_time: '16:00', score: 0.75, factors: ['End of day wrap-up', 'Quick meeting slot'] }\r\n    ]);\r\n  };\r\n\r\n  const findOptimalSlots = async () => {\r\n    try {\r\n      const response = await smartSchedulingAIAPI.findOptimalSlots(slotDuration, slotDate);\r\n      setOptimalSlots(response.data.slots || []);\r\n      toast.success('Found optimal meeting slots');\r\n    } catch (error) {\r\n      toast.info('Using AI-generated optimal slots');\r\n      // Keep demo data\r\n    }\r\n    setIsFindingSlotsDialogOpen(false);\r\n  };\r\n\r\n  const generateMeetingPrep = async (meetingId: number) => {\r\n    try {\r\n      const response = await smartSchedulingAIAPI.generateMeetingPrep(meetingId);\r\n      toast.success('Meeting prep generated');\r\n      fetchData();\r\n    } catch (error) {\r\n      toast.info('Meeting prep ready (demo)');\r\n    }\r\n  };\r\n\r\n  const getRiskColor = (probability: number) => {\r\n    if (probability >= 0.6) return 'text-red-600 bg-red-100';\r\n    if (probability >= 0.3) return 'text-yellow-600 bg-yellow-100';\r\n    return 'text-green-600 bg-green-100';\r\n  };\r\n\r\n  const getRiskLabel = (probability: number) => {\r\n    if (probability >= 0.6) return 'High Risk';\r\n    if (probability >= 0.3) return 'Medium Risk';\r\n    return 'Low Risk';\r\n  };\r\n\r\n  const formatTime = (isoString: string) => {\r\n    return new Date(isoString).toLocaleString('en-US', {\r\n      weekday: 'short',\r\n      month: 'short',\r\n      day: 'numeric',\r\n      hour: 'numeric',\r\n      minute: '2-digit'\r\n    });\r\n  };\r\n\r\n  const getWorkingDaysLabel = (days: number[]) => {\r\n    const dayNames = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];\r\n    return days.map(d => dayNames[d]).join(', ');\r\n  };\r\n\r\n  return (\r\n    <ProtectedRoute>\r\n      <MainLayout>\r\n        <div className=\"p-6 space-y-6\">\r\n          {/* Header */}\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <h1 className=\"text-3xl font-bold flex items-center gap-2\">\r\n                <Brain className=\"h-8 w-8 text-indigo-600\" />\r\n                Smart Scheduling AI\r\n              </h1>\r\n              <p className=\"text-gray-500 mt-1\">\r\n                AI-powered scheduling optimization, no-show prediction, and meeting preparation\r\n              </p>\r\n            </div>\r\n            <div className=\"flex gap-3\">\r\n              <Dialog open={isFindingSlotsDialogOpen} onOpenChange={setIsFindingSlotsDialogOpen}>\r\n                <DialogTrigger asChild>\r\n                  <Button variant=\"outline\">\r\n                    <Sparkles className=\"h-4 w-4 mr-2\" />\r\n                    Find Optimal Slots\r\n                  </Button>\r\n                </DialogTrigger>\r\n                <DialogContent>\r\n                  <DialogHeader>\r\n                    <DialogTitle>Find Optimal Meeting Slots</DialogTitle>\r\n                    <DialogDescription>\r\n                      AI will analyze your calendar and preferences to find the best times\r\n                    </DialogDescription>\r\n                  </DialogHeader>\r\n                  <div className=\"space-y-4 py-4\">\r\n                    <div>\r\n                      <Label>Meeting Duration (minutes)</Label>\r\n                      <Select value={slotDuration.toString()} onValueChange={(v) => setSlotDuration(parseInt(v))}>\r\n                        <SelectTrigger>\r\n                          <SelectValue />\r\n                        </SelectTrigger>\r\n                        <SelectContent>\r\n                          <SelectItem value=\"15\">15 minutes</SelectItem>\r\n                          <SelectItem value=\"30\">30 minutes</SelectItem>\r\n                          <SelectItem value=\"45\">45 minutes</SelectItem>\r\n                          <SelectItem value=\"60\">1 hour</SelectItem>\r\n                          <SelectItem value=\"90\">1.5 hours</SelectItem>\r\n                        </SelectContent>\r\n                      </Select>\r\n                    </div>\r\n                    <div>\r\n                      <Label>Date</Label>\r\n                      <Input\r\n                        type=\"date\"\r\n                        value={slotDate}\r\n                        onChange={(e) => setSlotDate(e.target.value)}\r\n                      />\r\n                    </div>\r\n                    <Button onClick={findOptimalSlots} className=\"w-full\">\r\n                      <Target className=\"h-4 w-4 mr-2\" />\r\n                      Find Optimal Slots\r\n                    </Button>\r\n                  </div>\r\n                </DialogContent>\r\n              </Dialog>\r\n              <Button onClick={() => setIsPreferencesDialogOpen(true)}>\r\n                <Settings className=\"h-4 w-4 mr-2\" />\r\n                AI Preferences\r\n              </Button>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Stats Cards */}\r\n          <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n            <Card>\r\n              <CardContent className=\"pt-6\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div>\r\n                    <p className=\"text-sm text-gray-500\">No-Show Risk Alerts</p>\r\n                    <p className=\"text-2xl font-bold text-red-600\">\r\n                      {noShowPredictions.filter(p => p.no_show_probability >= 0.6).length}\r\n                    </p>\r\n                  </div>\r\n                  <AlertTriangle className=\"h-8 w-8 text-red-500\" />\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n            <Card>\r\n              <CardContent className=\"pt-6\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div>\r\n                    <p className=\"text-sm text-gray-500\">Meetings Today</p>\r\n                    <p className=\"text-2xl font-bold\">4</p>\r\n                  </div>\r\n                  <Calendar className=\"h-8 w-8 text-blue-500\" />\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n            <Card>\r\n              <CardContent className=\"pt-6\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div>\r\n                    <p className=\"text-sm text-gray-500\">Prep Ready</p>\r\n                    <p className=\"text-2xl font-bold text-green-600\">{meetingPreps.length}</p>\r\n                  </div>\r\n                  <FileText className=\"h-8 w-8 text-green-500\" />\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n            <Card>\r\n              <CardContent className=\"pt-6\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div>\r\n                    <p className=\"text-sm text-gray-500\">Pending Reminders</p>\r\n                    <p className=\"text-2xl font-bold text-indigo-600\">\r\n                      {reminders.filter(r => !r.sent).length}\r\n                    </p>\r\n                  </div>\r\n                  <Bell className=\"h-8 w-8 text-indigo-500\" />\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n\r\n          {/* Main Content Tabs */}\r\n          <Tabs value={activeTab} onValueChange={setActiveTab}>\r\n            <TabsList className=\"grid w-full grid-cols-5\">\r\n              <TabsTrigger value=\"overview\">Overview</TabsTrigger>\r\n              <TabsTrigger value=\"no-show\">No-Show Predictions</TabsTrigger>\r\n              <TabsTrigger value=\"prep\">Meeting Prep</TabsTrigger>\r\n              <TabsTrigger value=\"optimal\">Optimal Slots</TabsTrigger>\r\n              <TabsTrigger value=\"reminders\">Smart Reminders</TabsTrigger>\r\n            </TabsList>\r\n\r\n            {/* Overview Tab */}\r\n            <TabsContent value=\"overview\" className=\"space-y-6\">\r\n              <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n                {/* AI Preferences Summary */}\r\n                <Card>\r\n                  <CardHeader>\r\n                    <CardTitle className=\"flex items-center gap-2\">\r\n                      <Settings className=\"h-5 w-5\" />\r\n                      Your AI Preferences\r\n                    </CardTitle>\r\n                    <CardDescription>How AI optimizes your schedule</CardDescription>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    {preferences ? (\r\n                      <div className=\"space-y-4\">\r\n                        <div className=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\">\r\n                          <span className=\"text-sm text-gray-600\">Working Hours</span>\r\n                          <span className=\"font-medium\">{preferences.preferred_start_hour}:00 - {preferences.preferred_end_hour}:00</span>\r\n                        </div>\r\n                        <div className=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\">\r\n                          <span className=\"text-sm text-gray-600\">Max Meetings/Day</span>\r\n                          <span className=\"font-medium\">{preferences.max_meetings_per_day}</span>\r\n                        </div>\r\n                        <div className=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\">\r\n                          <span className=\"text-sm text-gray-600\">Buffer Time</span>\r\n                          <span className=\"font-medium\">{preferences.buffer_minutes} min</span>\r\n                        </div>\r\n                        <div className=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\">\r\n                          <span className=\"text-sm text-gray-600\">Working Days</span>\r\n                          <span className=\"font-medium\">{getWorkingDaysLabel(preferences.working_days)}</span>\r\n                        </div>\r\n                        <div className=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\">\r\n                          <span className=\"text-sm text-gray-600\">Avoid Back-to-Back</span>\r\n                          <Badge variant={preferences.avoid_back_to_back ? 'default' : 'secondary'}>\r\n                            {preferences.avoid_back_to_back ? 'Yes' : 'No'}\r\n                          </Badge>\r\n                        </div>\r\n                        <div className=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\">\r\n                          <span className=\"text-sm text-gray-600\">Focus Time Blocks</span>\r\n                          <Badge variant={preferences.focus_time_blocks ? 'default' : 'secondary'}>\r\n                            {preferences.focus_time_blocks ? 'Enabled' : 'Disabled'}\r\n                          </Badge>\r\n                        </div>\r\n                      </div>\r\n                    ) : (\r\n                      <p className=\"text-gray-500\">No preferences configured yet</p>\r\n                    )}\r\n                  </CardContent>\r\n                </Card>\r\n\r\n                {/* Upcoming High-Risk Meetings */}\r\n                <Card>\r\n                  <CardHeader>\r\n                    <CardTitle className=\"flex items-center gap-2\">\r\n                      <AlertTriangle className=\"h-5 w-5 text-yellow-500\" />\r\n                      High-Risk Meetings\r\n                    </CardTitle>\r\n                    <CardDescription>Meetings with elevated no-show probability</CardDescription>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    <div className=\"space-y-3\">\r\n                      {noShowPredictions\r\n                        .filter(p => p.no_show_probability >= 0.3)\r\n                        .slice(0, 3)\r\n                        .map(prediction => (\r\n                          <div key={prediction.id} className=\"p-3 border rounded-lg\">\r\n                            <div className=\"flex items-center justify-between mb-2\">\r\n                              <span className=\"font-medium\">{prediction.meeting_title}</span>\r\n                              <Badge className={getRiskColor(prediction.no_show_probability)}>\r\n                                {Math.round(prediction.no_show_probability * 100)}% Risk\r\n                              </Badge>\r\n                            </div>\r\n                            <div className=\"flex items-center gap-2 text-sm text-gray-500\">\r\n                              <Clock className=\"h-3 w-3\" />\r\n                              {formatTime(prediction.scheduled_time)}\r\n                            </div>\r\n                            {prediction.recommended_actions.length > 0 && (\r\n                              <p className=\"text-xs text-blue-600 mt-2\">\r\n                                💡 {prediction.recommended_actions[0]}\r\n                              </p>\r\n                            )}\r\n                          </div>\r\n                        ))}\r\n                      {noShowPredictions.filter(p => p.no_show_probability >= 0.3).length === 0 && (\r\n                        <p className=\"text-gray-500 text-center py-4\">No high-risk meetings detected</p>\r\n                      )}\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n\r\n                {/* Today's Agenda */}\r\n                <Card>\r\n                  <CardHeader>\r\n                    <CardTitle className=\"flex items-center gap-2\">\r\n                      <CalendarDays className=\"h-5 w-5\" />\r\n                      Today's AI Insights\r\n                    </CardTitle>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    <div className=\"space-y-4\">\r\n                      <div className=\"p-4 bg-indigo-50 rounded-lg\">\r\n                        <div className=\"flex items-center gap-2 mb-2\">\r\n                          <Zap className=\"h-5 w-5 text-indigo-600\" />\r\n                          <span className=\"font-medium text-indigo-900\">Peak Productivity</span>\r\n                        </div>\r\n                        <p className=\"text-sm text-indigo-700\">\r\n                          Your most productive hours are 9:00 AM - 11:30 AM. Consider scheduling important meetings during this time.\r\n                        </p>\r\n                      </div>\r\n                      <div className=\"p-4 bg-green-50 rounded-lg\">\r\n                        <div className=\"flex items-center gap-2 mb-2\">\r\n                          <CheckCircle2 className=\"h-5 w-5 text-green-600\" />\r\n                          <span className=\"font-medium text-green-900\">Focus Time Available</span>\r\n                        </div>\r\n                        <p className=\"text-sm text-green-700\">\r\n                          You have a 2-hour focus block available at 2:00 PM. AI has blocked this for deep work.\r\n                        </p>\r\n                      </div>\r\n                      <div className=\"p-4 bg-yellow-50 rounded-lg\">\r\n                        <div className=\"flex items-center gap-2 mb-2\">\r\n                          <Activity className=\"h-5 w-5 text-yellow-600\" />\r\n                          <span className=\"font-medium text-yellow-900\">Meeting Load</span>\r\n                        </div>\r\n                        <p className=\"text-sm text-yellow-700\">\r\n                          You have 4 meetings today (67% of max). Good balance maintained.\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n\r\n                {/* Quick Actions */}\r\n                <Card>\r\n                  <CardHeader>\r\n                    <CardTitle className=\"flex items-center gap-2\">\r\n                      <Sparkles className=\"h-5 w-5\" />\r\n                      Quick Actions\r\n                    </CardTitle>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    <div className=\"grid grid-cols-2 gap-3\">\r\n                      <Button variant=\"outline\" className=\"h-auto py-4 flex flex-col items-center gap-2\">\r\n                        <Target className=\"h-6 w-6\" />\r\n                        <span>Find Slots</span>\r\n                      </Button>\r\n                      <Button variant=\"outline\" className=\"h-auto py-4 flex flex-col items-center gap-2\">\r\n                        <FileText className=\"h-6 w-6\" />\r\n                        <span>Prep Next Meeting</span>\r\n                      </Button>\r\n                      <Button variant=\"outline\" className=\"h-auto py-4 flex flex-col items-center gap-2\">\r\n                        <RefreshCw className=\"h-6 w-6\" />\r\n                        <span>Reschedule Risky</span>\r\n                      </Button>\r\n                      <Button variant=\"outline\" className=\"h-auto py-4 flex flex-col items-center gap-2\">\r\n                        <Bell className=\"h-6 w-6\" />\r\n                        <span>Send Reminders</span>\r\n                      </Button>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n              </div>\r\n            </TabsContent>\r\n\r\n            {/* No-Show Predictions Tab */}\r\n            <TabsContent value=\"no-show\" className=\"space-y-4\">\r\n              <Card>\r\n                <CardHeader>\r\n                  <CardTitle>No-Show Risk Analysis</CardTitle>\r\n                  <CardDescription>AI-powered predictions based on historical data and behavioral patterns</CardDescription>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"space-y-4\">\r\n                    {noShowPredictions.map(prediction => (\r\n                      <div key={prediction.id} className=\"border rounded-lg p-4\">\r\n                        <div className=\"flex items-start justify-between mb-4\">\r\n                          <div>\r\n                            <h3 className=\"font-semibold text-lg\">{prediction.meeting_title}</h3>\r\n                            {prediction.attendee_name && (\r\n                              <div className=\"flex items-center gap-2 text-sm text-gray-500 mt-1\">\r\n                                <User className=\"h-4 w-4\" />\r\n                                {prediction.attendee_name}\r\n                              </div>\r\n                            )}\r\n                            <div className=\"flex items-center gap-2 text-sm text-gray-500 mt-1\">\r\n                              <Clock className=\"h-4 w-4\" />\r\n                              {formatTime(prediction.scheduled_time)}\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"text-right\">\r\n                            <Badge className={`${getRiskColor(prediction.no_show_probability)} text-lg px-3 py-1`}>\r\n                              {Math.round(prediction.no_show_probability * 100)}%\r\n                            </Badge>\r\n                            <p className=\"text-xs text-gray-500 mt-1\">\r\n                              {getRiskLabel(prediction.no_show_probability)}\r\n                            </p>\r\n                          </div>\r\n                        </div>\r\n\r\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                          <div>\r\n                            <h4 className=\"text-sm font-medium text-gray-700 mb-2\">Risk Factors</h4>\r\n                            <ul className=\"space-y-1\">\r\n                              {prediction.risk_factors.map((factor, idx) => (\r\n                                <li key={idx} className=\"flex items-center gap-2 text-sm text-red-600\">\r\n                                  <AlertTriangle className=\"h-3 w-3\" />\r\n                                  {factor}\r\n                                </li>\r\n                              ))}\r\n                            </ul>\r\n                          </div>\r\n                          <div>\r\n                            <h4 className=\"text-sm font-medium text-gray-700 mb-2\">Recommended Actions</h4>\r\n                            <ul className=\"space-y-1\">\r\n                              {prediction.recommended_actions.map((action, idx) => (\r\n                                <li key={idx} className=\"flex items-center gap-2 text-sm text-green-600\">\r\n                                  <CheckCircle2 className=\"h-3 w-3\" />\r\n                                  {action}\r\n                                </li>\r\n                              ))}\r\n                            </ul>\r\n                          </div>\r\n                        </div>\r\n\r\n                        <div className=\"flex items-center justify-between mt-4 pt-4 border-t\">\r\n                          <div className=\"text-xs text-gray-500\">\r\n                            Confidence: {Math.round(prediction.confidence_score * 100)}%\r\n                          </div>\r\n                          <div className=\"flex gap-2\">\r\n                            <Button size=\"sm\" variant=\"outline\">\r\n                              <Bell className=\"h-4 w-4 mr-1\" />\r\n                              Send Reminder\r\n                            </Button>\r\n                            <Button size=\"sm\" variant=\"outline\">\r\n                              <RefreshCw className=\"h-4 w-4 mr-1\" />\r\n                              Reschedule\r\n                            </Button>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            </TabsContent>\r\n\r\n            {/* Meeting Prep Tab */}\r\n            <TabsContent value=\"prep\" className=\"space-y-4\">\r\n              {meetingPreps.map(prep => (\r\n                <Card key={prep.id}>\r\n                  <CardHeader>\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div>\r\n                        <CardTitle>{prep.meeting_title}</CardTitle>\r\n                        <CardDescription className=\"flex items-center gap-2 mt-1\">\r\n                          <Clock className=\"h-4 w-4\" />\r\n                          {formatTime(prep.meeting_time)}\r\n                        </CardDescription>\r\n                      </div>\r\n                      <Badge variant=\"outline\">\r\n                        Prepared {new Date(prep.prepared_at).toLocaleDateString()}\r\n                      </Badge>\r\n                    </div>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n                      {/* Contact Summary */}\r\n                      <div className=\"space-y-4\">\r\n                        <div>\r\n                          <h4 className=\"font-medium mb-2 flex items-center gap-2\">\r\n                            <User className=\"h-4 w-4\" />\r\n                            Contact Summary\r\n                          </h4>\r\n                          <p className=\"text-sm text-gray-600 bg-gray-50 p-3 rounded-lg\">\r\n                            {prep.contact_summary}\r\n                          </p>\r\n                        </div>\r\n\r\n                        <div>\r\n                          <h4 className=\"font-medium mb-2\">Talking Points</h4>\r\n                          <ul className=\"space-y-2\">\r\n                            {prep.talking_points.map((point, idx) => (\r\n                              <li key={idx} className=\"flex items-start gap-2 text-sm\">\r\n                                <Sparkles className=\"h-4 w-4 text-indigo-500 mt-0.5\" />\r\n                                {point}\r\n                              </li>\r\n                            ))}\r\n                          </ul>\r\n                        </div>\r\n\r\n                        {prep.risk_alerts.length > 0 && (\r\n                          <div className=\"p-3 bg-red-50 rounded-lg\">\r\n                            <h4 className=\"font-medium text-red-800 mb-2 flex items-center gap-2\">\r\n                              <AlertTriangle className=\"h-4 w-4\" />\r\n                              Risk Alerts\r\n                            </h4>\r\n                            <ul className=\"space-y-1\">\r\n                              {prep.risk_alerts.map((alert, idx) => (\r\n                                <li key={idx} className=\"text-sm text-red-700\">{alert}</li>\r\n                              ))}\r\n                            </ul>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n\r\n                      {/* Agenda & Opportunities */}\r\n                      <div className=\"space-y-4\">\r\n                        <div>\r\n                          <h4 className=\"font-medium mb-2\">Suggested Agenda</h4>\r\n                          <ol className=\"space-y-2\">\r\n                            {prep.suggested_agenda.map((item, idx) => (\r\n                              <li key={idx} className=\"flex items-start gap-3 text-sm\">\r\n                                <span className=\"flex items-center justify-center w-6 h-6 rounded-full bg-indigo-100 text-indigo-600 text-xs font-medium\">\r\n                                  {idx + 1}\r\n                                </span>\r\n                                {item}\r\n                              </li>\r\n                            ))}\r\n                          </ol>\r\n                        </div>\r\n\r\n                        <div>\r\n                          <h4 className=\"font-medium mb-2\">Recent Interactions</h4>\r\n                          <div className=\"space-y-2\">\r\n                            {prep.recent_interactions.map((interaction, idx) => (\r\n                              <div key={idx} className=\"flex items-center gap-3 text-sm p-2 bg-gray-50 rounded\">\r\n                                <Badge variant=\"outline\">{interaction.type}</Badge>\r\n                                <span className=\"text-gray-500\">{interaction.date}</span>\r\n                                <span className=\"text-gray-700\">{interaction.summary}</span>\r\n                              </div>\r\n                            ))}\r\n                          </div>\r\n                        </div>\r\n\r\n                        {prep.open_opportunities.length > 0 && (\r\n                          <div>\r\n                            <h4 className=\"font-medium mb-2\">Open Opportunities</h4>\r\n                            <div className=\"space-y-2\">\r\n                              {prep.open_opportunities.map((opp, idx) => (\r\n                                <div key={idx} className=\"flex items-center justify-between p-2 bg-green-50 rounded\">\r\n                                  <span className=\"text-sm font-medium text-green-800\">{opp.name}</span>\r\n                                  <div className=\"flex items-center gap-2\">\r\n                                    <span className=\"text-sm text-green-600\">${opp.value.toLocaleString()}</span>\r\n                                    <Badge variant=\"outline\">{opp.stage}</Badge>\r\n                                  </div>\r\n                                </div>\r\n                              ))}\r\n                            </div>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n              ))}\r\n            </TabsContent>\r\n\r\n            {/* Optimal Slots Tab */}\r\n            <TabsContent value=\"optimal\" className=\"space-y-4\">\r\n              <Card>\r\n                <CardHeader>\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <CardTitle>AI-Recommended Time Slots</CardTitle>\r\n                      <CardDescription>Optimal meeting times based on your preferences and patterns</CardDescription>\r\n                    </div>\r\n                    <Button onClick={() => setIsFindingSlotsDialogOpen(true)}>\r\n                      <RefreshCw className=\"h-4 w-4 mr-2\" />\r\n                      Find New Slots\r\n                    </Button>\r\n                  </div>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"space-y-4\">\r\n                    {optimalSlots.map((slot, idx) => (\r\n                      <div key={idx} className=\"border rounded-lg p-4\">\r\n                        <div className=\"flex items-center justify-between mb-3\">\r\n                          <div className=\"flex items-center gap-3\">\r\n                            <div className=\"p-2 bg-indigo-100 rounded-lg\">\r\n                              <Clock className=\"h-5 w-5 text-indigo-600\" />\r\n                            </div>\r\n                            <div>\r\n                              <p className=\"font-semibold text-lg\">{slot.start_time} - {slot.end_time}</p>\r\n                              <p className=\"text-sm text-gray-500\">\r\n                                {slotDate ? new Date(slotDate).toLocaleDateString('en-US', { weekday: 'long', month: 'short', day: 'numeric' }) : 'Today'}\r\n                              </p>\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"text-right\">\r\n                            <div className=\"flex items-center gap-2\">\r\n                              <span className=\"text-2xl font-bold text-indigo-600\">{Math.round(slot.score * 100)}</span>\r\n                              <span className=\"text-sm text-gray-500\">score</span>\r\n                            </div>\r\n                            <div className=\"w-24 h-2 bg-gray-200 rounded-full mt-1\">\r\n                              <div \r\n                                className=\"h-full bg-indigo-600 rounded-full\"\r\n                                style={{ width: `${slot.score * 100}%` }}\r\n                              />\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"flex flex-wrap gap-2\">\r\n                          {slot.factors.map((factor, fidx) => (\r\n                            <Badge key={fidx} variant=\"secondary\" className=\"text-xs\">\r\n                              <CheckCircle2 className=\"h-3 w-3 mr-1\" />\r\n                              {factor}\r\n                            </Badge>\r\n                          ))}\r\n                        </div>\r\n                        <div className=\"mt-3 pt-3 border-t flex gap-2\">\r\n                          <Button size=\"sm\" className=\"flex-1\">\r\n                            <Calendar className=\"h-4 w-4 mr-2\" />\r\n                            Schedule Meeting\r\n                          </Button>\r\n                          <Button size=\"sm\" variant=\"outline\">\r\n                            <Video className=\"h-4 w-4 mr-2\" />\r\n                            Video Call\r\n                          </Button>\r\n                          <Button size=\"sm\" variant=\"outline\">\r\n                            <Phone className=\"h-4 w-4 mr-2\" />\r\n                            Phone Call\r\n                          </Button>\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            </TabsContent>\r\n\r\n            {/* Smart Reminders Tab */}\r\n            <TabsContent value=\"reminders\" className=\"space-y-4\">\r\n              <Card>\r\n                <CardHeader>\r\n                  <CardTitle>Smart Reminders</CardTitle>\r\n                  <CardDescription>AI-generated contextual reminders for your meetings</CardDescription>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"space-y-4\">\r\n                    {reminders.map(reminder => (\r\n                      <div key={reminder.id} className=\"border rounded-lg p-4\">\r\n                        <div className=\"flex items-start justify-between\">\r\n                          <div className=\"flex items-start gap-3\">\r\n                            <div className={`p-2 rounded-lg ${\r\n                              reminder.reminder_type === 'preparation' ? 'bg-indigo-100' :\r\n                              reminder.reminder_type === 'follow_up' ? 'bg-green-100' : 'bg-gray-100'\r\n                            }`}>\r\n                              {reminder.reminder_type === 'preparation' ? (\r\n                                <FileText className={`h-5 w-5 ${\r\n                                  reminder.reminder_type === 'preparation' ? 'text-indigo-600' : 'text-gray-600'\r\n                                }`} />\r\n                              ) : (\r\n                                <Bell className=\"h-5 w-5 text-green-600\" />\r\n                              )}\r\n                            </div>\r\n                            <div>\r\n                              <p className=\"font-medium\">{reminder.meeting_title}</p>\r\n                              <p className=\"text-sm text-gray-500 mt-1\">{reminder.reminder_content}</p>\r\n                              <div className=\"flex items-center gap-4 mt-2 text-xs text-gray-500\">\r\n                                <span className=\"flex items-center gap-1\">\r\n                                  <Clock className=\"h-3 w-3\" />\r\n                                  Meeting: {formatTime(reminder.meeting_time)}\r\n                                </span>\r\n                                <span className=\"flex items-center gap-1\">\r\n                                  <Bell className=\"h-3 w-3\" />\r\n                                  Reminder: {formatTime(reminder.scheduled_for)}\r\n                                </span>\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"flex flex-col items-end gap-2\">\r\n                            <Badge variant={reminder.sent ? 'secondary' : 'default'}>\r\n                              {reminder.sent ? 'Sent' : 'Pending'}\r\n                            </Badge>\r\n                            <Badge variant=\"outline\" className=\"capitalize\">\r\n                              {reminder.reminder_type.replace('_', ' ')}\r\n                            </Badge>\r\n                          </div>\r\n                        </div>\r\n                        {!reminder.sent && (\r\n                          <div className=\"mt-3 pt-3 border-t flex gap-2\">\r\n                            <Button size=\"sm\" variant=\"outline\">\r\n                              Send Now\r\n                            </Button>\r\n                            <Button size=\"sm\" variant=\"outline\">\r\n                              Reschedule\r\n                            </Button>\r\n                            <Button size=\"sm\" variant=\"outline\" className=\"text-red-600\">\r\n                              Cancel\r\n                            </Button>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            </TabsContent>\r\n          </Tabs>\r\n\r\n          {/* AI Preferences Dialog */}\r\n          <Dialog open={isPreferencesDialogOpen} onOpenChange={setIsPreferencesDialogOpen}>\r\n            <DialogContent className=\"max-w-2xl\">\r\n              <DialogHeader>\r\n                <DialogTitle>AI Scheduling Preferences</DialogTitle>\r\n                <DialogDescription>\r\n                  Configure how AI optimizes your schedule and predicts meeting outcomes\r\n                </DialogDescription>\r\n              </DialogHeader>\r\n              <div className=\"space-y-6 py-4 max-h-[60vh] overflow-y-auto\">\r\n                <div className=\"grid grid-cols-2 gap-4\">\r\n                  <div>\r\n                    <Label>Preferred Start Hour</Label>\r\n                    <Select defaultValue={preferences?.preferred_start_hour?.toString() || \"9\"}>\r\n                      <SelectTrigger>\r\n                        <SelectValue />\r\n                      </SelectTrigger>\r\n                      <SelectContent>\r\n                        {Array.from({ length: 12 }, (_, i) => i + 6).map(hour => (\r\n                          <SelectItem key={hour} value={hour.toString()}>\r\n                            {hour}:00 {hour < 12 ? 'AM' : 'PM'}\r\n                          </SelectItem>\r\n                        ))}\r\n                      </SelectContent>\r\n                    </Select>\r\n                  </div>\r\n                  <div>\r\n                    <Label>Preferred End Hour</Label>\r\n                    <Select defaultValue={preferences?.preferred_end_hour?.toString() || \"17\"}>\r\n                      <SelectTrigger>\r\n                        <SelectValue />\r\n                      </SelectTrigger>\r\n                      <SelectContent>\r\n                        {Array.from({ length: 12 }, (_, i) => i + 12).map(hour => (\r\n                          <SelectItem key={hour} value={hour.toString()}>\r\n                            {hour > 12 ? hour - 12 : hour}:00 PM\r\n                          </SelectItem>\r\n                        ))}\r\n                      </SelectContent>\r\n                    </Select>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-2 gap-4\">\r\n                  <div>\r\n                    <Label>Max Meetings Per Day</Label>\r\n                    <Input type=\"number\" defaultValue={preferences?.max_meetings_per_day || 6} min={1} max={12} />\r\n                  </div>\r\n                  <div>\r\n                    <Label>Buffer Between Meetings (min)</Label>\r\n                    <Input type=\"number\" defaultValue={preferences?.buffer_minutes || 15} min={0} max={60} />\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"space-y-4\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <Label>Avoid Back-to-Back Meetings</Label>\r\n                      <p className=\"text-sm text-gray-500\">AI will prevent scheduling consecutive meetings</p>\r\n                    </div>\r\n                    <Switch defaultChecked={preferences?.avoid_back_to_back} />\r\n                  </div>\r\n\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <Label>Enable Focus Time Blocks</Label>\r\n                      <p className=\"text-sm text-gray-500\">AI will protect blocks for deep work</p>\r\n                    </div>\r\n                    <Switch defaultChecked={preferences?.focus_time_blocks} />\r\n                  </div>\r\n                </div>\r\n\r\n                <div>\r\n                  <Label>Preferred Meeting Lengths</Label>\r\n                  <div className=\"flex flex-wrap gap-2 mt-2\">\r\n                    {[15, 30, 45, 60, 90].map(duration => (\r\n                      <Badge \r\n                        key={duration}\r\n                        variant={preferences?.preferred_meeting_lengths?.includes(duration) ? 'default' : 'outline'}\r\n                        className=\"cursor-pointer\"\r\n                      >\r\n                        {duration} min\r\n                      </Badge>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n\r\n                <div>\r\n                  <Label>Timezone</Label>\r\n                  <Select defaultValue={preferences?.timezone || \"America/New_York\"}>\r\n                    <SelectTrigger>\r\n                      <SelectValue />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"America/New_York\">Eastern Time</SelectItem>\r\n                      <SelectItem value=\"America/Chicago\">Central Time</SelectItem>\r\n                      <SelectItem value=\"America/Denver\">Mountain Time</SelectItem>\r\n                      <SelectItem value=\"America/Los_Angeles\">Pacific Time</SelectItem>\r\n                      <SelectItem value=\"Europe/London\">London</SelectItem>\r\n                      <SelectItem value=\"Europe/Paris\">Paris</SelectItem>\r\n                      <SelectItem value=\"Asia/Tokyo\">Tokyo</SelectItem>\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n\r\n                <Button className=\"w-full\">\r\n                  Save Preferences\r\n                </Button>\r\n              </div>\r\n            </DialogContent>\r\n          </Dialog>\r\n        </div>\r\n      </MainLayout>\r\n    </ProtectedRoute>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\scheduling\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\security\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\security\\two-factor\\page.tsx","messages":[],"suppressedMessages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":217,"column":25,"nodeType":"JSXOpeningElement","endLine":217,"endColumn":85,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\settings\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\social-selling\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\sso-settings\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\tasks\\page.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchTasks'. Either include it or remove the dependency array.","line":145,"column":6,"nodeType":"ArrayExpression","endLine":145,"endColumn":33,"suggestions":[{"desc":"Update the dependencies array to be: [searchQuery, filterStatus, fetchTasks]","fix":{"range":[3927,3954],"text":"[searchQuery, filterStatus, fetchTasks]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\ui-showcase\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\viewport.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\voice-intelligence\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Dialog' is defined but never used.","line":10,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DialogContent' is defined but never used.","line":10,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":31},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DialogDescription' is defined but never used.","line":10,"column":33,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":50},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DialogHeader' is defined but never used.","line":10,"column":52,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":64},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DialogTitle' is defined but never used.","line":10,"column":66,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":77},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DialogTrigger' is defined but never used.","line":10,"column":79,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":92},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Label' is defined but never used.","line":12,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Select' is defined but never used.","line":13,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SelectContent' is defined but never used.","line":13,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":31},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SelectItem' is defined but never used.","line":13,"column":33,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":43},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SelectTrigger' is defined but never used.","line":13,"column":45,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":58},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SelectValue' is defined but never used.","line":13,"column":60,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":71},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Textarea' is defined but never used.","line":14,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'toast' is defined but never used.","line":16,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MicOff' is defined but never used.","line":19,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":19,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Building2' is defined but never used.","line":27,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":27,"endColumn":12},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Filter' is defined but never used.","line":43,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":43,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'activeTab' is assigned a value but never used.","line":148,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":148,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setActiveTab' is assigned a value but never used.","line":148,"column":21,"nodeType":null,"messageId":"unusedVar","endLine":148,"endColumn":33},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'loading' is assigned a value but never used.","line":156,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":156,"endColumn":17},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`fetchRecordings` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nE:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\voice-intelligence\\page.tsx:161:5\n  159 |\n  160 |   useEffect(() => {\n> 161 |     fetchRecordings();\n      |     ^^^^^^^^^^^^^^^ `fetchRecordings` accessed before it is declared\n  162 |     loadDemoAnalytics();\n  163 |   }, []);\n  164 |\n\nE:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\voice-intelligence\\page.tsx:165:3\n  163 |   }, []);\n  164 |\n> 165 |   const fetchRecordings = async () => {\n      |   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 166 |     setLoading(true);\n      | ^^^^^^^^^^^^^^^^^^^^^\n> 167 |     try {\n      …\n      | ^^^^^^^^^^^^^^^^^^^^^\n> 177 |     setLoading(false);\n      | ^^^^^^^^^^^^^^^^^^^^^\n> 178 |   };\n      | ^^^^^ `fetchRecordings` is declared here\n  179 |\n  180 |   const loadDemoData = () => {\n  181 |     setRecordings([","line":161,"column":5,"nodeType":null,"endLine":161,"endColumn":20},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`loadDemoAnalytics` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nE:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\voice-intelligence\\page.tsx:162:5\n  160 |   useEffect(() => {\n  161 |     fetchRecordings();\n> 162 |     loadDemoAnalytics();\n      |     ^^^^^^^^^^^^^^^^^ `loadDemoAnalytics` accessed before it is declared\n  163 |   }, []);\n  164 |\n  165 |   const fetchRecordings = async () => {\n\nE:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\voice-intelligence\\page.tsx:233:3\n  231 |   };\n  232 |\n> 233 |   const loadDemoAnalytics = () => {\n      |   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 234 |     setAnalytics({\n      | ^^^^^^^^^^^^^^^^^^\n> 235 |       total_calls: 156,\n      …\n      | ^^^^^^^^^^^^^^^^^^\n> 255 |     });\n      | ^^^^^^^^^^^^^^^^^^\n> 256 |   };\n      | ^^^^^ `loadDemoAnalytics` is declared here\n  257 |\n  258 |   const selectRecording = async (recording: VoiceRecording) => {\n  259 |     setSelectedRecording(recording);","line":162,"column":5,"nodeType":null,"endLine":162,"endColumn":22},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchRecordings'. Either include it or remove the dependency array.","line":163,"column":6,"nodeType":"ArrayExpression","endLine":163,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [fetchRecordings]","fix":{"range":[4730,4732],"text":"[fetchRecordings]"}}]},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Date.now` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nE:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\voice-intelligence\\page.tsx:323:28\n  321 |         description: 'Send product demo recording and follow-up materials',\n  322 |         assigned_to: 'Sarah Johnson',\n> 323 |         due_date: new Date(Date.now() + 86400000).toISOString(),\n      |                            ^^^^^^^^^^ Cannot call impure function\n  324 |         priority: 'high',\n  325 |         status: 'pending',\n  326 |         created_at: new Date().toISOString(),","line":323,"column":28,"nodeType":null,"endLine":323,"endColumn":38},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Date.now` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nE:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\voice-intelligence\\page.tsx:334:28\n  332 |         description: 'Prepare ROI analysis comparing spreadsheet vs CRM costs',\n  333 |         assigned_to: 'Sarah Johnson',\n> 334 |         due_date: new Date(Date.now() + 172800000).toISOString(),\n      |                            ^^^^^^^^^^ Cannot call impure function\n  335 |         priority: 'high',\n  336 |         status: 'pending',\n  337 |         created_at: new Date().toISOString(),","line":334,"column":28,"nodeType":null,"endLine":334,"endColumn":38},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Date.now` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nE:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\voice-intelligence\\page.tsx:345:28\n  343 |         description: 'Find and send case study from 50+ seat deployment',\n  344 |         assigned_to: 'Sarah Johnson',\n> 345 |         due_date: new Date(Date.now() + 86400000).toISOString(),\n      |                            ^^^^^^^^^^ Cannot call impure function\n  346 |         priority: 'medium',\n  347 |         status: 'pending',\n  348 |         created_at: new Date().toISOString(),","line":345,"column":28,"nodeType":null,"endLine":345,"endColumn":38}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":21,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport MainLayout from '@/components/Layout/MainLayout';\r\nimport ProtectedRoute from '@/components/ProtectedRoute';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from '@/components/ui/dialog';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { toast } from 'sonner';\r\nimport { \r\n  Mic, \r\n  MicOff,\r\n  Phone, \r\n  PhoneIncoming,\r\n  PhoneOutgoing,\r\n  Play, \r\n  Pause, \r\n  Clock,\r\n  User,\r\n  Building2,\r\n  FileText,\r\n  CheckCircle2,\r\n  AlertTriangle,\r\n  TrendingUp,\r\n  TrendingDown,\r\n  Sparkles,\r\n  Target,\r\n  BarChart3,\r\n  Activity,\r\n  MessageSquare,\r\n  ThumbsUp,\r\n  ThumbsDown,\r\n  Minus,\r\n  Download,\r\n  Search,\r\n  Filter,\r\n  RefreshCw,\r\n  Volume2,\r\n  Settings,\r\n  Calendar,\r\n  Zap,\r\n  Brain\r\n} from 'lucide-react';\r\nimport { voiceIntelligenceAPI } from '@/lib/ai-workflow-api';\r\n\r\ninterface VoiceRecording {\r\n  id: number;\r\n  call_id: string;\r\n  contact_name?: string;\r\n  company_name?: string;\r\n  direction: 'inbound' | 'outbound';\r\n  duration_seconds: number;\r\n  recording_url: string;\r\n  call_start_time: string;\r\n  call_end_time: string;\r\n  phone_number: string;\r\n  user_name: string;\r\n  status: string;\r\n  transcription_status: string;\r\n  ai_processed: boolean;\r\n}\r\n\r\ninterface Transcription {\r\n  id: number;\r\n  recording_id: number;\r\n  full_transcript: string;\r\n  speaker_segments: SpeakerSegment[];\r\n  key_phrases: string[];\r\n  mentioned_competitors: string[];\r\n  mentioned_products: string[];\r\n  questions_asked: string[];\r\n  objections_raised: string[];\r\n  word_count: number;\r\n  processing_time: number;\r\n}\r\n\r\ninterface SpeakerSegment {\r\n  speaker: string;\r\n  start_time: number;\r\n  end_time: number;\r\n  text: string;\r\n  confidence: number;\r\n}\r\n\r\ninterface AISummary {\r\n  id: number;\r\n  recording_id: number;\r\n  summary: string;\r\n  key_points: string[];\r\n  sentiment_overall: 'positive' | 'neutral' | 'negative';\r\n  sentiment_score: number;\r\n  engagement_score: number;\r\n  talk_ratio: { rep: number; customer: number };\r\n  topics_discussed: string[];\r\n  customer_mood_progression: string[];\r\n  recommendations: string[];\r\n  generated_at: string;\r\n}\r\n\r\ninterface ActionItem {\r\n  id: number;\r\n  recording_id: number;\r\n  description: string;\r\n  assigned_to?: string;\r\n  due_date?: string;\r\n  priority: 'high' | 'medium' | 'low';\r\n  status: 'pending' | 'completed' | 'cancelled';\r\n  created_at: string;\r\n  ai_confidence: number;\r\n}\r\n\r\ninterface CallScore {\r\n  id: number;\r\n  recording_id: number;\r\n  overall_score: number;\r\n  opening_score: number;\r\n  discovery_score: number;\r\n  presentation_score: number;\r\n  objection_handling_score: number;\r\n  closing_score: number;\r\n  criteria_scores: Record<string, number>;\r\n  strengths: string[];\r\n  areas_for_improvement: string[];\r\n  coaching_tips: string[];\r\n}\r\n\r\ninterface CallAnalytics {\r\n  total_calls: number;\r\n  total_duration_minutes: number;\r\n  avg_call_duration: number;\r\n  avg_sentiment_score: number;\r\n  avg_engagement_score: number;\r\n  avg_call_score: number;\r\n  calls_by_direction: { inbound: number; outbound: number };\r\n  calls_by_sentiment: { positive: number; neutral: number; negative: number };\r\n  top_topics: { topic: string; count: number }[];\r\n  top_competitors_mentioned: { name: string; count: number }[];\r\n}\r\n\r\nexport default function VoiceIntelligencePage() {\r\n  const [activeTab, setActiveTab] = useState('recordings');\r\n  const [recordings, setRecordings] = useState<VoiceRecording[]>([]);\r\n  const [selectedRecording, setSelectedRecording] = useState<VoiceRecording | null>(null);\r\n  const [transcription, setTranscription] = useState<Transcription | null>(null);\r\n  const [summary, setSummary] = useState<AISummary | null>(null);\r\n  const [actionItems, setActionItems] = useState<ActionItem[]>([]);\r\n  const [callScore, setCallScore] = useState<CallScore | null>(null);\r\n  const [analytics, setAnalytics] = useState<CallAnalytics | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [isPlayingAudio, setIsPlayingAudio] = useState(false);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n\r\n  useEffect(() => {\r\n    fetchRecordings();\r\n    loadDemoAnalytics();\r\n  }, []);\r\n\r\n  const fetchRecordings = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const response = await voiceIntelligenceAPI.getRecordings();\r\n      setRecordings(response.data.results || []);\r\n      if ((response.data.results || []).length === 0) {\r\n        loadDemoData();\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to fetch recordings:', error);\r\n      loadDemoData();\r\n    }\r\n    setLoading(false);\r\n  };\r\n\r\n  const loadDemoData = () => {\r\n    setRecordings([\r\n      {\r\n        id: 1,\r\n        call_id: 'CALL-001',\r\n        contact_name: 'John Smith',\r\n        company_name: 'TechCorp Inc',\r\n        direction: 'outbound',\r\n        duration_seconds: 1845,\r\n        recording_url: '/recordings/call-001.mp3',\r\n        call_start_time: new Date(Date.now() - 7200000).toISOString(),\r\n        call_end_time: new Date(Date.now() - 5355000).toISOString(),\r\n        phone_number: '+1 (555) 123-4567',\r\n        user_name: 'Sarah Johnson',\r\n        status: 'completed',\r\n        transcription_status: 'completed',\r\n        ai_processed: true\r\n      },\r\n      {\r\n        id: 2,\r\n        call_id: 'CALL-002',\r\n        contact_name: 'Emily Davis',\r\n        company_name: 'StartupXYZ',\r\n        direction: 'inbound',\r\n        duration_seconds: 923,\r\n        recording_url: '/recordings/call-002.mp3',\r\n        call_start_time: new Date(Date.now() - 86400000).toISOString(),\r\n        call_end_time: new Date(Date.now() - 85477000).toISOString(),\r\n        phone_number: '+1 (555) 987-6543',\r\n        user_name: 'Mike Wilson',\r\n        status: 'completed',\r\n        transcription_status: 'completed',\r\n        ai_processed: true\r\n      },\r\n      {\r\n        id: 3,\r\n        call_id: 'CALL-003',\r\n        contact_name: 'Robert Chen',\r\n        company_name: 'Enterprise Solutions',\r\n        direction: 'outbound',\r\n        duration_seconds: 2156,\r\n        recording_url: '/recordings/call-003.mp3',\r\n        call_start_time: new Date(Date.now() - 172800000).toISOString(),\r\n        call_end_time: new Date(Date.now() - 170644000).toISOString(),\r\n        phone_number: '+1 (555) 456-7890',\r\n        user_name: 'Sarah Johnson',\r\n        status: 'completed',\r\n        transcription_status: 'processing',\r\n        ai_processed: false\r\n      }\r\n    ]);\r\n  };\r\n\r\n  const loadDemoAnalytics = () => {\r\n    setAnalytics({\r\n      total_calls: 156,\r\n      total_duration_minutes: 4280,\r\n      avg_call_duration: 27.4,\r\n      avg_sentiment_score: 72,\r\n      avg_engagement_score: 78,\r\n      avg_call_score: 75,\r\n      calls_by_direction: { inbound: 45, outbound: 111 },\r\n      calls_by_sentiment: { positive: 89, neutral: 52, negative: 15 },\r\n      top_topics: [\r\n        { topic: 'Pricing', count: 78 },\r\n        { topic: 'Product Features', count: 65 },\r\n        { topic: 'Integration', count: 54 },\r\n        { topic: 'Support', count: 42 },\r\n        { topic: 'Implementation', count: 38 }\r\n      ],\r\n      top_competitors_mentioned: [\r\n        { name: 'Salesforce', count: 32 },\r\n        { name: 'HubSpot', count: 28 },\r\n        { name: 'Pipedrive', count: 15 }\r\n      ]\r\n    });\r\n  };\r\n\r\n  const selectRecording = async (recording: VoiceRecording) => {\r\n    setSelectedRecording(recording);\r\n    \r\n    // Load demo transcription and summary\r\n    setTranscription({\r\n      id: 1,\r\n      recording_id: recording.id,\r\n      full_transcript: `Sarah: Hi John, thanks for taking my call today. How are you doing?\r\n\r\nJohn: I'm doing well, Sarah. Thanks for reaching out. I've been looking forward to learning more about your CRM solution.\r\n\r\nSarah: Great! I understand you're currently evaluating different options for your sales team. Can you tell me a bit about your current setup and what challenges you're facing?\r\n\r\nJohn: Sure. We're using spreadsheets right now, and it's becoming unmanageable. We have about 50 sales reps and tracking everything manually is a nightmare.\r\n\r\nSarah: I completely understand. That's actually a very common challenge we help solve. Our CRM is specifically designed for teams your size. Would it help if I walked you through how we handle lead tracking and pipeline management?\r\n\r\nJohn: Yes, that would be great. Also, I'm curious about pricing - we're working with a limited budget this quarter.\r\n\r\nSarah: Absolutely, I'll cover pricing as well. Let me share my screen and show you the main features...`,\r\n      speaker_segments: [\r\n        { speaker: 'Sarah', start_time: 0, end_time: 15, text: \"Hi John, thanks for taking my call today. How are you doing?\", confidence: 0.95 },\r\n        { speaker: 'John', start_time: 16, end_time: 35, text: \"I'm doing well, Sarah. Thanks for reaching out. I've been looking forward to learning more about your CRM solution.\", confidence: 0.92 },\r\n      ],\r\n      key_phrases: ['CRM solution', 'sales team', 'lead tracking', 'pipeline management', 'limited budget'],\r\n      mentioned_competitors: [],\r\n      mentioned_products: ['CRM', 'lead tracking', 'pipeline management'],\r\n      questions_asked: ['What challenges are you facing?', 'Would a demo help?'],\r\n      objections_raised: ['Working with limited budget'],\r\n      word_count: 245,\r\n      processing_time: 12.5\r\n    });\r\n\r\n    setSummary({\r\n      id: 1,\r\n      recording_id: recording.id,\r\n      summary: \"Discovery call with John Smith from TechCorp Inc. The prospect is currently using spreadsheets to manage their 50-person sales team and is experiencing significant pain points with manual tracking. They're actively evaluating CRM solutions but have budget constraints this quarter. Sarah successfully identified key pain points and scheduled a demo to show lead tracking and pipeline management features.\",\r\n      key_points: [\r\n        'Prospect has 50 sales reps using spreadsheets',\r\n        'Major pain point: manual tracking is unmanageable',\r\n        'Budget constraints this quarter',\r\n        'Interested in lead tracking and pipeline features',\r\n        'Scheduled product demo'\r\n      ],\r\n      sentiment_overall: 'positive',\r\n      sentiment_score: 78,\r\n      engagement_score: 85,\r\n      talk_ratio: { rep: 45, customer: 55 },\r\n      topics_discussed: ['Current challenges', 'Team size', 'CRM features', 'Pricing concerns', 'Product demo'],\r\n      customer_mood_progression: ['interested', 'engaged', 'curious about pricing', 'optimistic'],\r\n      recommendations: [\r\n        'Prepare ROI analysis for follow-up',\r\n        'Highlight cost-saving features in demo',\r\n        'Send case study from similar-sized company',\r\n        'Address budget concerns with flexible pricing options'\r\n      ],\r\n      generated_at: new Date().toISOString()\r\n    });\r\n\r\n    setActionItems([\r\n      {\r\n        id: 1,\r\n        recording_id: recording.id,\r\n        description: 'Send product demo recording and follow-up materials',\r\n        assigned_to: 'Sarah Johnson',\r\n        due_date: new Date(Date.now() + 86400000).toISOString(),\r\n        priority: 'high',\r\n        status: 'pending',\r\n        created_at: new Date().toISOString(),\r\n        ai_confidence: 0.95\r\n      },\r\n      {\r\n        id: 2,\r\n        recording_id: recording.id,\r\n        description: 'Prepare ROI analysis comparing spreadsheet vs CRM costs',\r\n        assigned_to: 'Sarah Johnson',\r\n        due_date: new Date(Date.now() + 172800000).toISOString(),\r\n        priority: 'high',\r\n        status: 'pending',\r\n        created_at: new Date().toISOString(),\r\n        ai_confidence: 0.88\r\n      },\r\n      {\r\n        id: 3,\r\n        recording_id: recording.id,\r\n        description: 'Find and send case study from 50+ seat deployment',\r\n        assigned_to: 'Sarah Johnson',\r\n        due_date: new Date(Date.now() + 86400000).toISOString(),\r\n        priority: 'medium',\r\n        status: 'pending',\r\n        created_at: new Date().toISOString(),\r\n        ai_confidence: 0.82\r\n      }\r\n    ]);\r\n\r\n    setCallScore({\r\n      id: 1,\r\n      recording_id: recording.id,\r\n      overall_score: 82,\r\n      opening_score: 90,\r\n      discovery_score: 85,\r\n      presentation_score: 78,\r\n      objection_handling_score: 75,\r\n      closing_score: 80,\r\n      criteria_scores: {\r\n        'Active Listening': 88,\r\n        'Question Quality': 82,\r\n        'Value Proposition': 79,\r\n        'Next Steps': 85,\r\n        'Rapport Building': 91\r\n      },\r\n      strengths: [\r\n        'Excellent rapport building and warm opening',\r\n        'Good discovery questions about current pain points',\r\n        'Clear next steps established',\r\n        'Professional and empathetic tone'\r\n      ],\r\n      areas_for_improvement: [\r\n        'Could have probed deeper on budget specifics',\r\n        'Missed opportunity to quantify pain point costs',\r\n        'Presentation could include more customer success stories'\r\n      ],\r\n      coaching_tips: [\r\n        'Try using the \"impact\" question: \"What does this cost your team in hours/dollars?\"',\r\n        'When budget concerns arise, pivot to ROI discussion earlier',\r\n        'Include a brief competitor comparison to address potential objections'\r\n      ]\r\n    });\r\n  };\r\n\r\n  const formatDuration = (seconds: number) => {\r\n    const mins = Math.floor(seconds / 60);\r\n    const secs = seconds % 60;\r\n    return `${mins}:${secs.toString().padStart(2, '0')}`;\r\n  };\r\n\r\n  const getSentimentIcon = (sentiment: string) => {\r\n    switch (sentiment) {\r\n      case 'positive': return <ThumbsUp className=\"h-4 w-4 text-green-500\" />;\r\n      case 'negative': return <ThumbsDown className=\"h-4 w-4 text-red-500\" />;\r\n      default: return <Minus className=\"h-4 w-4 text-gray-500\" />;\r\n    }\r\n  };\r\n\r\n  const getSentimentColor = (sentiment: string) => {\r\n    switch (sentiment) {\r\n      case 'positive': return 'bg-green-100 text-green-700';\r\n      case 'negative': return 'bg-red-100 text-red-700';\r\n      default: return 'bg-gray-100 text-gray-700';\r\n    }\r\n  };\r\n\r\n  const getPriorityColor = (priority: string) => {\r\n    switch (priority) {\r\n      case 'high': return 'bg-red-100 text-red-700';\r\n      case 'medium': return 'bg-yellow-100 text-yellow-700';\r\n      default: return 'bg-green-100 text-green-700';\r\n    }\r\n  };\r\n\r\n  const getScoreColor = (score: number) => {\r\n    if (score >= 80) return 'text-green-600';\r\n    if (score >= 60) return 'text-yellow-600';\r\n    return 'text-red-600';\r\n  };\r\n\r\n  return (\r\n    <ProtectedRoute>\r\n      <MainLayout>\r\n        <div className=\"p-6 space-y-6\">\r\n          {/* Header */}\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <h1 className=\"text-3xl font-bold flex items-center gap-2\">\r\n                <Mic className=\"h-8 w-8 text-violet-600\" />\r\n                Voice Intelligence\r\n              </h1>\r\n              <p className=\"text-gray-500 mt-1\">\r\n                AI-powered call transcription, analysis, and coaching\r\n              </p>\r\n            </div>\r\n            <div className=\"flex gap-3\">\r\n              <Button variant=\"outline\" onClick={fetchRecordings}>\r\n                <RefreshCw className=\"h-4 w-4 mr-2\" />\r\n                Refresh\r\n              </Button>\r\n              <Button>\r\n                <Settings className=\"h-4 w-4 mr-2\" />\r\n                Settings\r\n              </Button>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Stats Cards */}\r\n          {analytics && (\r\n            <div className=\"grid grid-cols-1 md:grid-cols-5 gap-4\">\r\n              <Card>\r\n                <CardContent className=\"pt-6\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <p className=\"text-sm text-gray-500\">Total Calls</p>\r\n                      <p className=\"text-2xl font-bold\">{analytics.total_calls}</p>\r\n                    </div>\r\n                    <Phone className=\"h-8 w-8 text-blue-500\" />\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n              <Card>\r\n                <CardContent className=\"pt-6\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <p className=\"text-sm text-gray-500\">Avg Duration</p>\r\n                      <p className=\"text-2xl font-bold\">{analytics.avg_call_duration.toFixed(1)}m</p>\r\n                    </div>\r\n                    <Clock className=\"h-8 w-8 text-indigo-500\" />\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n              <Card>\r\n                <CardContent className=\"pt-6\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <p className=\"text-sm text-gray-500\">Avg Sentiment</p>\r\n                      <p className={`text-2xl font-bold ${getScoreColor(analytics.avg_sentiment_score)}`}>\r\n                        {analytics.avg_sentiment_score}%\r\n                      </p>\r\n                    </div>\r\n                    <Activity className=\"h-8 w-8 text-green-500\" />\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n              <Card>\r\n                <CardContent className=\"pt-6\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <p className=\"text-sm text-gray-500\">Avg Call Score</p>\r\n                      <p className={`text-2xl font-bold ${getScoreColor(analytics.avg_call_score)}`}>\r\n                        {analytics.avg_call_score}\r\n                      </p>\r\n                    </div>\r\n                    <Target className=\"h-8 w-8 text-violet-500\" />\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n              <Card>\r\n                <CardContent className=\"pt-6\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <p className=\"text-sm text-gray-500\">Engagement</p>\r\n                      <p className={`text-2xl font-bold ${getScoreColor(analytics.avg_engagement_score)}`}>\r\n                        {analytics.avg_engagement_score}%\r\n                      </p>\r\n                    </div>\r\n                    <Zap className=\"h-8 w-8 text-yellow-500\" />\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n          )}\r\n\r\n          {/* Main Content */}\r\n          <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n            {/* Recordings List */}\r\n            <Card className=\"lg:col-span-1\">\r\n              <CardHeader>\r\n                <CardTitle className=\"flex items-center gap-2\">\r\n                  <Volume2 className=\"h-5 w-5\" />\r\n                  Call Recordings\r\n                </CardTitle>\r\n                <div className=\"relative mt-2\">\r\n                  <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400\" />\r\n                  <Input \r\n                    placeholder=\"Search calls...\" \r\n                    className=\"pl-9\"\r\n                    value={searchQuery}\r\n                    onChange={(e) => setSearchQuery(e.target.value)}\r\n                  />\r\n                </div>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"space-y-3 max-h-[600px] overflow-y-auto\">\r\n                  {recordings.map(recording => (\r\n                    <div \r\n                      key={recording.id}\r\n                      className={`p-3 border rounded-lg cursor-pointer transition-colors ${\r\n                        selectedRecording?.id === recording.id ? 'border-violet-500 bg-violet-50' : 'hover:bg-gray-50'\r\n                      }`}\r\n                      onClick={() => selectRecording(recording)}\r\n                    >\r\n                      <div className=\"flex items-start justify-between mb-2\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                          {recording.direction === 'inbound' ? (\r\n                            <PhoneIncoming className=\"h-4 w-4 text-green-500\" />\r\n                          ) : (\r\n                            <PhoneOutgoing className=\"h-4 w-4 text-blue-500\" />\r\n                          )}\r\n                          <span className=\"font-medium text-sm\">{recording.contact_name}</span>\r\n                        </div>\r\n                        {recording.ai_processed && (\r\n                          <Badge variant=\"secondary\" className=\"text-xs\">\r\n                            <Brain className=\"h-3 w-3 mr-1\" />\r\n                            AI\r\n                          </Badge>\r\n                        )}\r\n                      </div>\r\n                      <p className=\"text-xs text-gray-500 mb-1\">{recording.company_name}</p>\r\n                      <div className=\"flex items-center justify-between text-xs text-gray-500\">\r\n                        <span className=\"flex items-center gap-1\">\r\n                          <Clock className=\"h-3 w-3\" />\r\n                          {formatDuration(recording.duration_seconds)}\r\n                        </span>\r\n                        <span>{new Date(recording.call_start_time).toLocaleDateString()}</span>\r\n                      </div>\r\n                      <div className=\"mt-2 flex items-center gap-2\">\r\n                        <Badge variant=\"outline\" className=\"text-xs capitalize\">{recording.direction}</Badge>\r\n                        <Badge \r\n                          variant=\"outline\" \r\n                          className={`text-xs ${\r\n                            recording.transcription_status === 'completed' ? 'text-green-600' : 'text-yellow-600'\r\n                          }`}\r\n                        >\r\n                          {recording.transcription_status}\r\n                        </Badge>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Recording Details */}\r\n            <Card className=\"lg:col-span-2\">\r\n              {selectedRecording ? (\r\n                <>\r\n                  <CardHeader>\r\n                    <div className=\"flex items-start justify-between\">\r\n                      <div>\r\n                        <CardTitle className=\"flex items-center gap-2\">\r\n                          {selectedRecording.contact_name}\r\n                          {summary && (\r\n                            <Badge className={getSentimentColor(summary.sentiment_overall)}>\r\n                              {getSentimentIcon(summary.sentiment_overall)}\r\n                              <span className=\"ml-1 capitalize\">{summary.sentiment_overall}</span>\r\n                            </Badge>\r\n                          )}\r\n                        </CardTitle>\r\n                        <CardDescription className=\"mt-1\">\r\n                          {selectedRecording.company_name} • {selectedRecording.phone_number}\r\n                        </CardDescription>\r\n                      </div>\r\n                      <div className=\"flex gap-2\">\r\n                        <Button size=\"sm\" variant=\"outline\">\r\n                          <Download className=\"h-4 w-4 mr-1\" />\r\n                          Export\r\n                        </Button>\r\n                        <Button size=\"sm\" variant=\"outline\" onClick={() => setIsPlayingAudio(!isPlayingAudio)}>\r\n                          {isPlayingAudio ? <Pause className=\"h-4 w-4\" /> : <Play className=\"h-4 w-4\" />}\r\n                        </Button>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-4 mt-3 text-sm text-gray-500\">\r\n                      <span className=\"flex items-center gap-1\">\r\n                        <User className=\"h-4 w-4\" />\r\n                        {selectedRecording.user_name}\r\n                      </span>\r\n                      <span className=\"flex items-center gap-1\">\r\n                        <Calendar className=\"h-4 w-4\" />\r\n                        {new Date(selectedRecording.call_start_time).toLocaleString()}\r\n                      </span>\r\n                      <span className=\"flex items-center gap-1\">\r\n                        <Clock className=\"h-4 w-4\" />\r\n                        {formatDuration(selectedRecording.duration_seconds)}\r\n                      </span>\r\n                    </div>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    <Tabs defaultValue=\"summary\">\r\n                      <TabsList className=\"grid w-full grid-cols-5\">\r\n                        <TabsTrigger value=\"summary\">Summary</TabsTrigger>\r\n                        <TabsTrigger value=\"transcript\">Transcript</TabsTrigger>\r\n                        <TabsTrigger value=\"actions\">Actions</TabsTrigger>\r\n                        <TabsTrigger value=\"score\">Call Score</TabsTrigger>\r\n                        <TabsTrigger value=\"coaching\">Coaching</TabsTrigger>\r\n                      </TabsList>\r\n\r\n                      {/* Summary Tab */}\r\n                      <TabsContent value=\"summary\" className=\"space-y-4\">\r\n                        {summary && (\r\n                          <>\r\n                            <div className=\"p-4 bg-gray-50 rounded-lg\">\r\n                              <h4 className=\"font-medium mb-2 flex items-center gap-2\">\r\n                                <Sparkles className=\"h-4 w-4 text-violet-500\" />\r\n                                AI Summary\r\n                              </h4>\r\n                              <p className=\"text-sm text-gray-700\">{summary.summary}</p>\r\n                            </div>\r\n\r\n                            <div className=\"grid grid-cols-2 gap-4\">\r\n                              <div className=\"p-4 border rounded-lg\">\r\n                                <h4 className=\"font-medium mb-2\">Key Points</h4>\r\n                                <ul className=\"space-y-2\">\r\n                                  {summary.key_points.map((point, idx) => (\r\n                                    <li key={idx} className=\"flex items-start gap-2 text-sm\">\r\n                                      <CheckCircle2 className=\"h-4 w-4 text-green-500 mt-0.5\" />\r\n                                      {point}\r\n                                    </li>\r\n                                  ))}\r\n                                </ul>\r\n                              </div>\r\n\r\n                              <div className=\"space-y-4\">\r\n                                <div className=\"p-4 border rounded-lg\">\r\n                                  <h4 className=\"font-medium mb-2\">Talk Ratio</h4>\r\n                                  <div className=\"flex items-center gap-2\">\r\n                                    <div className=\"flex-1\">\r\n                                      <div className=\"flex justify-between text-xs mb-1\">\r\n                                        <span>Rep: {summary.talk_ratio.rep}%</span>\r\n                                        <span>Customer: {summary.talk_ratio.customer}%</span>\r\n                                      </div>\r\n                                      <div className=\"w-full h-3 bg-gray-200 rounded-full flex overflow-hidden\">\r\n                                        <div \r\n                                          className=\"bg-violet-500 h-full\"\r\n                                          style={{ width: `${summary.talk_ratio.rep}%` }}\r\n                                        />\r\n                                        <div \r\n                                          className=\"bg-blue-500 h-full\"\r\n                                          style={{ width: `${summary.talk_ratio.customer}%` }}\r\n                                        />\r\n                                      </div>\r\n                                    </div>\r\n                                  </div>\r\n                                </div>\r\n\r\n                                <div className=\"p-4 border rounded-lg\">\r\n                                  <h4 className=\"font-medium mb-2\">Scores</h4>\r\n                                  <div className=\"grid grid-cols-2 gap-2\">\r\n                                    <div>\r\n                                      <p className=\"text-xs text-gray-500\">Sentiment</p>\r\n                                      <p className={`text-lg font-semibold ${getScoreColor(summary.sentiment_score)}`}>\r\n                                        {summary.sentiment_score}%\r\n                                      </p>\r\n                                    </div>\r\n                                    <div>\r\n                                      <p className=\"text-xs text-gray-500\">Engagement</p>\r\n                                      <p className={`text-lg font-semibold ${getScoreColor(summary.engagement_score)}`}>\r\n                                        {summary.engagement_score}%\r\n                                      </p>\r\n                                    </div>\r\n                                  </div>\r\n                                </div>\r\n                              </div>\r\n                            </div>\r\n\r\n                            <div className=\"p-4 border rounded-lg\">\r\n                              <h4 className=\"font-medium mb-2\">Topics Discussed</h4>\r\n                              <div className=\"flex flex-wrap gap-2\">\r\n                                {summary.topics_discussed.map((topic, idx) => (\r\n                                  <Badge key={idx} variant=\"secondary\">{topic}</Badge>\r\n                                ))}\r\n                              </div>\r\n                            </div>\r\n\r\n                            <div className=\"p-4 bg-violet-50 rounded-lg\">\r\n                              <h4 className=\"font-medium mb-2 flex items-center gap-2\">\r\n                                <Target className=\"h-4 w-4 text-violet-600\" />\r\n                                Recommendations\r\n                              </h4>\r\n                              <ul className=\"space-y-2\">\r\n                                {summary.recommendations.map((rec, idx) => (\r\n                                  <li key={idx} className=\"flex items-start gap-2 text-sm text-violet-800\">\r\n                                    <Sparkles className=\"h-4 w-4 text-violet-500 mt-0.5\" />\r\n                                    {rec}\r\n                                  </li>\r\n                                ))}\r\n                              </ul>\r\n                            </div>\r\n                          </>\r\n                        )}\r\n                      </TabsContent>\r\n\r\n                      {/* Transcript Tab */}\r\n                      <TabsContent value=\"transcript\" className=\"space-y-4\">\r\n                        {transcription && (\r\n                          <>\r\n                            <div className=\"flex items-center justify-between\">\r\n                              <div className=\"flex items-center gap-4 text-sm text-gray-500\">\r\n                                <span>{transcription.word_count} words</span>\r\n                                <span>Processed in {transcription.processing_time}s</span>\r\n                              </div>\r\n                              <Button size=\"sm\" variant=\"outline\">\r\n                                <Download className=\"h-4 w-4 mr-1\" />\r\n                                Download\r\n                              </Button>\r\n                            </div>\r\n\r\n                            <div className=\"p-4 border rounded-lg max-h-[400px] overflow-y-auto\">\r\n                              <pre className=\"whitespace-pre-wrap text-sm font-sans\">\r\n                                {transcription.full_transcript}\r\n                              </pre>\r\n                            </div>\r\n\r\n                            <div className=\"grid grid-cols-2 gap-4\">\r\n                              <div className=\"p-4 border rounded-lg\">\r\n                                <h4 className=\"font-medium mb-2\">Key Phrases</h4>\r\n                                <div className=\"flex flex-wrap gap-1\">\r\n                                  {transcription.key_phrases.map((phrase, idx) => (\r\n                                    <Badge key={idx} variant=\"outline\" className=\"text-xs\">{phrase}</Badge>\r\n                                  ))}\r\n                                </div>\r\n                              </div>\r\n\r\n                              <div className=\"p-4 border rounded-lg\">\r\n                                <h4 className=\"font-medium mb-2\">Objections Raised</h4>\r\n                                <ul className=\"space-y-1\">\r\n                                  {transcription.objections_raised.map((obj, idx) => (\r\n                                    <li key={idx} className=\"flex items-center gap-2 text-sm text-yellow-700\">\r\n                                      <AlertTriangle className=\"h-3 w-3\" />\r\n                                      {obj}\r\n                                    </li>\r\n                                  ))}\r\n                                </ul>\r\n                              </div>\r\n                            </div>\r\n                          </>\r\n                        )}\r\n                      </TabsContent>\r\n\r\n                      {/* Actions Tab */}\r\n                      <TabsContent value=\"actions\" className=\"space-y-4\">\r\n                        <div className=\"flex items-center justify-between\">\r\n                          <h4 className=\"font-medium\">AI-Generated Action Items</h4>\r\n                          <Button size=\"sm\">\r\n                            <CheckCircle2 className=\"h-4 w-4 mr-1\" />\r\n                            Add Action\r\n                          </Button>\r\n                        </div>\r\n                        {actionItems.map(action => (\r\n                          <div key={action.id} className=\"border rounded-lg p-4\">\r\n                            <div className=\"flex items-start justify-between mb-2\">\r\n                              <div className=\"flex items-start gap-3\">\r\n                                <input \r\n                                  type=\"checkbox\" \r\n                                  checked={action.status === 'completed'}\r\n                                  className=\"mt-1 h-4 w-4 rounded border-gray-300\"\r\n                                  onChange={() => {}}\r\n                                />\r\n                                <div>\r\n                                  <p className={`font-medium ${action.status === 'completed' ? 'line-through text-gray-400' : ''}`}>\r\n                                    {action.description}\r\n                                  </p>\r\n                                  <div className=\"flex items-center gap-3 mt-1 text-xs text-gray-500\">\r\n                                    {action.assigned_to && (\r\n                                      <span className=\"flex items-center gap-1\">\r\n                                        <User className=\"h-3 w-3\" />\r\n                                        {action.assigned_to}\r\n                                      </span>\r\n                                    )}\r\n                                    {action.due_date && (\r\n                                      <span className=\"flex items-center gap-1\">\r\n                                        <Calendar className=\"h-3 w-3\" />\r\n                                        Due: {new Date(action.due_date).toLocaleDateString()}\r\n                                      </span>\r\n                                    )}\r\n                                  </div>\r\n                                </div>\r\n                              </div>\r\n                              <div className=\"flex items-center gap-2\">\r\n                                <Badge className={getPriorityColor(action.priority)}>\r\n                                  {action.priority}\r\n                                </Badge>\r\n                                <span className=\"text-xs text-gray-400\">\r\n                                  AI: {Math.round(action.ai_confidence * 100)}%\r\n                                </span>\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                        ))}\r\n                      </TabsContent>\r\n\r\n                      {/* Call Score Tab */}\r\n                      <TabsContent value=\"score\" className=\"space-y-4\">\r\n                        {callScore && (\r\n                          <>\r\n                            <div className=\"text-center py-6\">\r\n                              <div className={`inline-flex items-center justify-center w-24 h-24 rounded-full ${\r\n                                callScore.overall_score >= 80 ? 'bg-green-100' :\r\n                                callScore.overall_score >= 60 ? 'bg-yellow-100' : 'bg-red-100'\r\n                              }`}>\r\n                                <span className={`text-3xl font-bold ${getScoreColor(callScore.overall_score)}`}>\r\n                                  {callScore.overall_score}\r\n                                </span>\r\n                              </div>\r\n                              <p className=\"mt-2 font-medium\">Overall Call Score</p>\r\n                            </div>\r\n\r\n                            <div className=\"grid grid-cols-5 gap-4\">\r\n                              {[\r\n                                { label: 'Opening', score: callScore.opening_score },\r\n                                { label: 'Discovery', score: callScore.discovery_score },\r\n                                { label: 'Presentation', score: callScore.presentation_score },\r\n                                { label: 'Objections', score: callScore.objection_handling_score },\r\n                                { label: 'Closing', score: callScore.closing_score }\r\n                              ].map((item, idx) => (\r\n                                <div key={idx} className=\"text-center p-3 border rounded-lg\">\r\n                                  <p className={`text-2xl font-semibold ${getScoreColor(item.score)}`}>\r\n                                    {item.score}\r\n                                  </p>\r\n                                  <p className=\"text-xs text-gray-500\">{item.label}</p>\r\n                                </div>\r\n                              ))}\r\n                            </div>\r\n\r\n                            <div className=\"grid grid-cols-2 gap-4\">\r\n                              <div className=\"p-4 border rounded-lg\">\r\n                                <h4 className=\"font-medium mb-2 flex items-center gap-2\">\r\n                                  <TrendingUp className=\"h-4 w-4 text-green-500\" />\r\n                                  Strengths\r\n                                </h4>\r\n                                <ul className=\"space-y-2\">\r\n                                  {callScore.strengths.map((strength, idx) => (\r\n                                    <li key={idx} className=\"flex items-start gap-2 text-sm text-green-700\">\r\n                                      <CheckCircle2 className=\"h-4 w-4 mt-0.5\" />\r\n                                      {strength}\r\n                                    </li>\r\n                                  ))}\r\n                                </ul>\r\n                              </div>\r\n\r\n                              <div className=\"p-4 border rounded-lg\">\r\n                                <h4 className=\"font-medium mb-2 flex items-center gap-2\">\r\n                                  <TrendingDown className=\"h-4 w-4 text-yellow-500\" />\r\n                                  Areas for Improvement\r\n                                </h4>\r\n                                <ul className=\"space-y-2\">\r\n                                  {callScore.areas_for_improvement.map((area, idx) => (\r\n                                    <li key={idx} className=\"flex items-start gap-2 text-sm text-yellow-700\">\r\n                                      <AlertTriangle className=\"h-4 w-4 mt-0.5\" />\r\n                                      {area}\r\n                                    </li>\r\n                                  ))}\r\n                                </ul>\r\n                              </div>\r\n                            </div>\r\n                          </>\r\n                        )}\r\n                      </TabsContent>\r\n\r\n                      {/* Coaching Tab */}\r\n                      <TabsContent value=\"coaching\" className=\"space-y-4\">\r\n                        {callScore && (\r\n                          <>\r\n                            <div className=\"p-4 bg-violet-50 rounded-lg\">\r\n                              <h4 className=\"font-medium mb-3 flex items-center gap-2\">\r\n                                <Brain className=\"h-5 w-5 text-violet-600\" />\r\n                                AI Coaching Tips\r\n                              </h4>\r\n                              <ul className=\"space-y-3\">\r\n                                {callScore.coaching_tips.map((tip, idx) => (\r\n                                  <li key={idx} className=\"flex items-start gap-3 p-3 bg-white rounded-lg\">\r\n                                    <div className=\"flex items-center justify-center w-6 h-6 rounded-full bg-violet-100 text-violet-600 text-sm font-medium\">\r\n                                      {idx + 1}\r\n                                    </div>\r\n                                    <span className=\"text-sm text-gray-700\">{tip}</span>\r\n                                  </li>\r\n                                ))}\r\n                              </ul>\r\n                            </div>\r\n\r\n                            <div className=\"p-4 border rounded-lg\">\r\n                              <h4 className=\"font-medium mb-3\">Skill Breakdown</h4>\r\n                              <div className=\"space-y-3\">\r\n                                {Object.entries(callScore.criteria_scores).map(([skill, score]) => (\r\n                                  <div key={skill}>\r\n                                    <div className=\"flex justify-between mb-1\">\r\n                                      <span className=\"text-sm\">{skill}</span>\r\n                                      <span className={`text-sm font-medium ${getScoreColor(score)}`}>\r\n                                        {score}%\r\n                                      </span>\r\n                                    </div>\r\n                                    <Progress value={score} />\r\n                                  </div>\r\n                                ))}\r\n                              </div>\r\n                            </div>\r\n\r\n                            <div className=\"flex gap-4\">\r\n                              <Button className=\"flex-1\">\r\n                                <MessageSquare className=\"h-4 w-4 mr-2\" />\r\n                                Request 1:1 Coaching\r\n                              </Button>\r\n                              <Button variant=\"outline\" className=\"flex-1\">\r\n                                <FileText className=\"h-4 w-4 mr-2\" />\r\n                                View Training Resources\r\n                              </Button>\r\n                            </div>\r\n                          </>\r\n                        )}\r\n                      </TabsContent>\r\n                    </Tabs>\r\n                  </CardContent>\r\n                </>\r\n              ) : (\r\n                <CardContent className=\"flex flex-col items-center justify-center h-[600px] text-gray-500\">\r\n                  <Mic className=\"h-16 w-16 mb-4 text-gray-300\" />\r\n                  <p className=\"text-lg font-medium\">Select a recording to view details</p>\r\n                  <p className=\"text-sm\">Click on a call recording from the list to see AI analysis</p>\r\n                </CardContent>\r\n              )}\r\n            </Card>\r\n          </div>\r\n\r\n          {/* Analytics Section */}\r\n          {analytics && (\r\n            <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n              <Card>\r\n                <CardHeader>\r\n                  <CardTitle className=\"flex items-center gap-2\">\r\n                    <BarChart3 className=\"h-5 w-5\" />\r\n                    Calls by Direction\r\n                  </CardTitle>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"space-y-4\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <PhoneOutgoing className=\"h-4 w-4 text-blue-500\" />\r\n                        <span>Outbound</span>\r\n                      </div>\r\n                      <span className=\"font-semibold\">{analytics.calls_by_direction.outbound}</span>\r\n                    </div>\r\n                    <Progress \r\n                      value={(analytics.calls_by_direction.outbound / analytics.total_calls) * 100} \r\n                      className=\"h-2\"\r\n                    />\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <PhoneIncoming className=\"h-4 w-4 text-green-500\" />\r\n                        <span>Inbound</span>\r\n                      </div>\r\n                      <span className=\"font-semibold\">{analytics.calls_by_direction.inbound}</span>\r\n                    </div>\r\n                    <Progress \r\n                      value={(analytics.calls_by_direction.inbound / analytics.total_calls) * 100} \r\n                      className=\"h-2\"\r\n                    />\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n\r\n              <Card>\r\n                <CardHeader>\r\n                  <CardTitle className=\"flex items-center gap-2\">\r\n                    <Activity className=\"h-5 w-5\" />\r\n                    Top Topics\r\n                  </CardTitle>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"space-y-3\">\r\n                    {analytics.top_topics.slice(0, 5).map((topic, idx) => (\r\n                      <div key={idx} className=\"flex items-center justify-between\">\r\n                        <span className=\"text-sm\">{topic.topic}</span>\r\n                        <Badge variant=\"secondary\">{topic.count}</Badge>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n\r\n              <Card>\r\n                <CardHeader>\r\n                  <CardTitle className=\"flex items-center gap-2\">\r\n                    <Target className=\"h-5 w-5\" />\r\n                    Sentiment Distribution\r\n                  </CardTitle>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"space-y-3\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <ThumbsUp className=\"h-4 w-4 text-green-500\" />\r\n                        <span>Positive</span>\r\n                      </div>\r\n                      <span className=\"font-semibold text-green-600\">{analytics.calls_by_sentiment.positive}</span>\r\n                    </div>\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <Minus className=\"h-4 w-4 text-gray-500\" />\r\n                        <span>Neutral</span>\r\n                      </div>\r\n                      <span className=\"font-semibold text-gray-600\">{analytics.calls_by_sentiment.neutral}</span>\r\n                    </div>\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <ThumbsDown className=\"h-4 w-4 text-red-500\" />\r\n                        <span>Negative</span>\r\n                      </div>\r\n                      <span className=\"font-semibold text-red-600\">{analytics.calls_by_sentiment.negative}</span>\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </MainLayout>\r\n    </ProtectedRoute>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\white-label\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\app\\workflows\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ActivityFeed.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\InstallPrompt.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\Layout\\MainLayout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\NotificationsDropdown.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ProtectedRoute.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\QueryProvider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ThemeProvider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ThemeToggle.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\enterprise\\AIAnalyticsDashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\enterprise\\AIAssistantChat.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardContent' is defined but never used.","line":12,"column":16,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AvatarImage' is defined but never used.","line":15,"column":34,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":45},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MessageSquare' is defined but never used.","line":29,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":29,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'PenLine' is defined but never used.","line":31,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":31,"endColumn":10}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * AI Assistant Chat Component\r\n * ============================\r\n * \r\n * Real-time AI-powered chat assistant for CRM tasks\r\n */\r\n\r\n'use client';\r\n\r\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Input } from '@/components/ui/input';\r\nimport { ScrollArea } from '@/components/ui/scroll-area';\r\nimport { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuTrigger,\r\n} from '@/components/ui/dropdown-menu';\r\nimport {\r\n  Bot,\r\n  Copy,\r\n  Lightbulb,\r\n  Loader2,\r\n  Mail,\r\n  MessageSquare,\r\n  MoreVertical,\r\n  PenLine,\r\n  RefreshCw,\r\n  Send,\r\n  Sparkles,\r\n  ThumbsDown,\r\n  ThumbsUp,\r\n  User,\r\n  FileText,\r\n  Calendar,\r\n  TrendingUp,\r\n} from 'lucide-react';\r\nimport { cn } from '@/lib/utils';\r\n\r\n// =============================================================================\r\n// Types\r\n// =============================================================================\r\n\r\ninterface Message {\r\n  id: string;\r\n  role: 'user' | 'assistant';\r\n  content: string;\r\n  timestamp: Date;\r\n  metadata?: {\r\n    type?: 'text' | 'email' | 'summary' | 'insights' | 'meeting_prep';\r\n    context?: Record<string, unknown>;\r\n    suggestions?: string[];\r\n    actions?: AIAction[];\r\n  };\r\n  feedback?: 'positive' | 'negative';\r\n}\r\n\r\ninterface AIAction {\r\n  id: string;\r\n  label: string;\r\n  icon: string;\r\n  action: string;\r\n  params?: Record<string, unknown>;\r\n}\r\n\r\ninterface ConversationContext {\r\n  leadId?: string;\r\n  contactId?: string;\r\n  opportunityId?: string;\r\n  dealValue?: number;\r\n  companyName?: string;\r\n  contactName?: string;\r\n}\r\n\r\n// =============================================================================\r\n// AI Assistant Component\r\n// =============================================================================\r\n\r\nexport function AIAssistantChat({\r\n  context,\r\n  onAction,\r\n  className,\r\n}: {\r\n  context?: ConversationContext;\r\n  onAction?: (action: AIAction) => void;\r\n  className?: string;\r\n}) {\r\n  const [messages, setMessages] = useState<Message[]>([]);\r\n  const [input, setInput] = useState('');\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [suggestions, setSuggestions] = useState<string[]>([]);\r\n  const scrollRef = useRef<HTMLDivElement>(null);\r\n  const inputRef = useRef<HTMLInputElement>(null);\r\n\r\n  // Initialize with welcome message\r\n  useEffect(() => {\r\n    const welcomeMessage: Message = {\r\n      id: 'welcome',\r\n      role: 'assistant',\r\n      content: context?.contactName\r\n        ? `Hi! I'm your AI assistant. I see you're working with ${context.contactName}${\r\n            context.companyName ? ` from ${context.companyName}` : ''\r\n          }. How can I help you today?`\r\n        : \"Hi! I'm your AI assistant. I can help you draft emails, prepare for meetings, analyze deals, and provide insights. What would you like to do?\",\r\n      timestamp: new Date(),\r\n      metadata: {\r\n        suggestions: [\r\n          'Draft a follow-up email',\r\n          'Prepare for my next meeting',\r\n          'Analyze this deal',\r\n          'Show AI insights',\r\n        ],\r\n      },\r\n    };\r\n    setMessages([welcomeMessage]);\r\n    setSuggestions(welcomeMessage.metadata?.suggestions || []);\r\n  }, [context]);\r\n\r\n  // Auto-scroll to bottom\r\n  useEffect(() => {\r\n    if (scrollRef.current) {\r\n      scrollRef.current.scrollTop = scrollRef.current.scrollHeight;\r\n    }\r\n  }, [messages]);\r\n\r\n  const handleSend = useCallback(async () => {\r\n    if (!input.trim() || isLoading) return;\r\n\r\n    const userMessage: Message = {\r\n      id: `user-${Date.now()}`,\r\n      role: 'user',\r\n      content: input.trim(),\r\n      timestamp: new Date(),\r\n    };\r\n\r\n    setMessages((prev) => [...prev, userMessage]);\r\n    setInput('');\r\n    setSuggestions([]);\r\n    setIsLoading(true);\r\n\r\n    try {\r\n      const response = await fetch('/api/ai/chat', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          message: userMessage.content,\r\n          context,\r\n          history: messages.slice(-10).map((m) => ({\r\n            role: m.role,\r\n            content: m.content,\r\n          })),\r\n        }),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Failed to get AI response');\r\n      }\r\n\r\n      const data = await response.json();\r\n\r\n      const assistantMessage: Message = {\r\n        id: `assistant-${Date.now()}`,\r\n        role: 'assistant',\r\n        content: data.response,\r\n        timestamp: new Date(),\r\n        metadata: {\r\n          type: data.type,\r\n          suggestions: data.suggestions,\r\n          actions: data.actions,\r\n        },\r\n      };\r\n\r\n      setMessages((prev) => [...prev, assistantMessage]);\r\n      setSuggestions(data.suggestions || []);\r\n    } catch (error) {\r\n      console.error('AI chat error:', error);\r\n      \r\n      const errorMessage: Message = {\r\n        id: `error-${Date.now()}`,\r\n        role: 'assistant',\r\n        content: \"I'm sorry, I encountered an error. Please try again.\",\r\n        timestamp: new Date(),\r\n      };\r\n      \r\n      setMessages((prev) => [...prev, errorMessage]);\r\n    } finally {\r\n      setIsLoading(false);\r\n      inputRef.current?.focus();\r\n    }\r\n  }, [input, isLoading, context, messages]);\r\n\r\n  const handleSuggestionClick = (suggestion: string) => {\r\n    setInput(suggestion);\r\n    inputRef.current?.focus();\r\n  };\r\n\r\n  const handleFeedback = (messageId: string, feedback: 'positive' | 'negative') => {\r\n    setMessages((prev) =>\r\n      prev.map((m) => (m.id === messageId ? { ...m, feedback } : m))\r\n    );\r\n    \r\n    // Send feedback to API\r\n    fetch('/api/ai/feedback', {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify({ messageId, feedback }),\r\n    }).catch(console.error);\r\n  };\r\n\r\n  const handleCopy = (content: string) => {\r\n    navigator.clipboard.writeText(content);\r\n  };\r\n\r\n  const handleActionClick = (action: AIAction) => {\r\n    onAction?.(action);\r\n  };\r\n\r\n  const handleKeyDown = (e: React.KeyboardEvent) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      e.preventDefault();\r\n      handleSend();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Card className={cn('flex flex-col h-[600px]', className)}>\r\n      <CardHeader className=\"pb-3 border-b\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <div className=\"p-2 rounded-full bg-gradient-to-r from-purple-500 to-blue-500\">\r\n              <Sparkles className=\"h-4 w-4 text-white\" />\r\n            </div>\r\n            <div>\r\n              <CardTitle className=\"text-base\">AI Assistant</CardTitle>\r\n              <p className=\"text-xs text-muted-foreground\">\r\n                Powered by GPT-4\r\n              </p>\r\n            </div>\r\n          </div>\r\n          <Badge variant=\"outline\" className=\"text-xs\">\r\n            <span className=\"w-2 h-2 rounded-full bg-green-500 mr-1.5\" />\r\n            Online\r\n          </Badge>\r\n        </div>\r\n      </CardHeader>\r\n\r\n      <ScrollArea ref={scrollRef} className=\"flex-1 p-4\">\r\n        <div className=\"space-y-4\">\r\n          {messages.map((message) => (\r\n            <MessageBubble\r\n              key={message.id}\r\n              message={message}\r\n              onFeedback={handleFeedback}\r\n              onCopy={handleCopy}\r\n              onAction={handleActionClick}\r\n            />\r\n          ))}\r\n          \r\n          {isLoading && (\r\n            <div className=\"flex items-center gap-2 text-muted-foreground\">\r\n              <Bot className=\"h-4 w-4\" />\r\n              <div className=\"flex items-center gap-1\">\r\n                <span className=\"animate-bounce\">●</span>\r\n                <span className=\"animate-bounce\" style={{ animationDelay: '0.1s' }}>●</span>\r\n                <span className=\"animate-bounce\" style={{ animationDelay: '0.2s' }}>●</span>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </ScrollArea>\r\n\r\n      {/* Suggestions */}\r\n      {suggestions.length > 0 && !isLoading && (\r\n        <div className=\"px-4 py-2 border-t\">\r\n          <div className=\"flex flex-wrap gap-2\">\r\n            {suggestions.map((suggestion, index) => (\r\n              <Button\r\n                key={index}\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                className=\"text-xs\"\r\n                onClick={() => handleSuggestionClick(suggestion)}\r\n              >\r\n                <Lightbulb className=\"h-3 w-3 mr-1\" />\r\n                {suggestion}\r\n              </Button>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Quick Actions */}\r\n      <div className=\"px-4 py-2 border-t\">\r\n        <div className=\"flex gap-1\">\r\n          <QuickActionButton\r\n            icon={<Mail className=\"h-4 w-4\" />}\r\n            label=\"Email\"\r\n            onClick={() => handleSuggestionClick('Draft a professional follow-up email')}\r\n          />\r\n          <QuickActionButton\r\n            icon={<Calendar className=\"h-4 w-4\" />}\r\n            label=\"Meeting\"\r\n            onClick={() => handleSuggestionClick('Help me prepare for my next meeting')}\r\n          />\r\n          <QuickActionButton\r\n            icon={<TrendingUp className=\"h-4 w-4\" />}\r\n            label=\"Insights\"\r\n            onClick={() => handleSuggestionClick('Show me AI insights for this lead')}\r\n          />\r\n          <QuickActionButton\r\n            icon={<FileText className=\"h-4 w-4\" />}\r\n            label=\"Summary\"\r\n            onClick={() => handleSuggestionClick('Generate a deal summary')}\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Input */}\r\n      <div className=\"p-4 border-t\">\r\n        <div className=\"flex gap-2\">\r\n          <Input\r\n            ref={inputRef}\r\n            value={input}\r\n            onChange={(e) => setInput(e.target.value)}\r\n            onKeyDown={handleKeyDown}\r\n            placeholder=\"Ask me anything...\"\r\n            disabled={isLoading}\r\n            className=\"flex-1\"\r\n          />\r\n          <Button onClick={handleSend} disabled={!input.trim() || isLoading}>\r\n            {isLoading ? (\r\n              <Loader2 className=\"h-4 w-4 animate-spin\" />\r\n            ) : (\r\n              <Send className=\"h-4 w-4\" />\r\n            )}\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    </Card>\r\n  );\r\n}\r\n\r\n// =============================================================================\r\n// Message Bubble Component\r\n// =============================================================================\r\n\r\nfunction MessageBubble({\r\n  message,\r\n  onFeedback,\r\n  onCopy,\r\n  onAction,\r\n}: {\r\n  message: Message;\r\n  onFeedback: (id: string, feedback: 'positive' | 'negative') => void;\r\n  onCopy: (content: string) => void;\r\n  onAction: (action: AIAction) => void;\r\n}) {\r\n  const isUser = message.role === 'user';\r\n\r\n  return (\r\n    <div className={cn('flex gap-3', isUser && 'flex-row-reverse')}>\r\n      <Avatar className=\"h-8 w-8 shrink-0\">\r\n        {isUser ? (\r\n          <>\r\n            <AvatarFallback>\r\n              <User className=\"h-4 w-4\" />\r\n            </AvatarFallback>\r\n          </>\r\n        ) : (\r\n          <>\r\n            <AvatarFallback className=\"bg-gradient-to-r from-purple-500 to-blue-500\">\r\n              <Bot className=\"h-4 w-4 text-white\" />\r\n            </AvatarFallback>\r\n          </>\r\n        )}\r\n      </Avatar>\r\n\r\n      <div className={cn('flex flex-col gap-1 max-w-[80%]', isUser && 'items-end')}>\r\n        <div\r\n          className={cn(\r\n            'rounded-lg px-4 py-2',\r\n            isUser\r\n              ? 'bg-primary text-primary-foreground'\r\n              : 'bg-muted'\r\n          )}\r\n        >\r\n          <p className=\"text-sm whitespace-pre-wrap\">{message.content}</p>\r\n        </div>\r\n\r\n        {/* Actions */}\r\n        {message.metadata?.actions && message.metadata.actions.length > 0 && (\r\n          <div className=\"flex flex-wrap gap-2 mt-2\">\r\n            {message.metadata.actions.map((action) => (\r\n              <Button\r\n                key={action.id}\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                onClick={() => onAction(action)}\r\n              >\r\n                {action.label}\r\n              </Button>\r\n            ))}\r\n          </div>\r\n        )}\r\n\r\n        {/* Message actions */}\r\n        {!isUser && (\r\n          <div className=\"flex items-center gap-1 mt-1\">\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"icon\"\r\n              className=\"h-6 w-6\"\r\n              onClick={() => onCopy(message.content)}\r\n            >\r\n              <Copy className=\"h-3 w-3\" />\r\n            </Button>\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"icon\"\r\n              className={cn(\r\n                'h-6 w-6',\r\n                message.feedback === 'positive' && 'text-green-500'\r\n              )}\r\n              onClick={() => onFeedback(message.id, 'positive')}\r\n            >\r\n              <ThumbsUp className=\"h-3 w-3\" />\r\n            </Button>\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"icon\"\r\n              className={cn(\r\n                'h-6 w-6',\r\n                message.feedback === 'negative' && 'text-red-500'\r\n              )}\r\n              onClick={() => onFeedback(message.id, 'negative')}\r\n            >\r\n              <ThumbsDown className=\"h-3 w-3\" />\r\n            </Button>\r\n            <DropdownMenu>\r\n              <DropdownMenuTrigger asChild>\r\n                <Button variant=\"ghost\" size=\"icon\" className=\"h-6 w-6\">\r\n                  <MoreVertical className=\"h-3 w-3\" />\r\n                </Button>\r\n              </DropdownMenuTrigger>\r\n              <DropdownMenuContent align=\"end\">\r\n                <DropdownMenuItem onClick={() => onCopy(message.content)}>\r\n                  <Copy className=\"h-4 w-4 mr-2\" />\r\n                  Copy\r\n                </DropdownMenuItem>\r\n                <DropdownMenuItem>\r\n                  <RefreshCw className=\"h-4 w-4 mr-2\" />\r\n                  Regenerate\r\n                </DropdownMenuItem>\r\n              </DropdownMenuContent>\r\n            </DropdownMenu>\r\n          </div>\r\n        )}\r\n\r\n        <span className=\"text-xs text-muted-foreground\">\r\n          {message.timestamp.toLocaleTimeString([], {\r\n            hour: '2-digit',\r\n            minute: '2-digit',\r\n          })}\r\n        </span>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// =============================================================================\r\n// Quick Action Button\r\n// =============================================================================\r\n\r\nfunction QuickActionButton({\r\n  icon,\r\n  label,\r\n  onClick,\r\n}: {\r\n  icon: React.ReactNode;\r\n  label: string;\r\n  onClick: () => void;\r\n}) {\r\n  return (\r\n    <Button\r\n      variant=\"ghost\"\r\n      size=\"sm\"\r\n      className=\"flex-col h-auto py-2 px-3 gap-1\"\r\n      onClick={onClick}\r\n    >\r\n      {icon}\r\n      <span className=\"text-xs\">{label}</span>\r\n    </Button>\r\n  );\r\n}\r\n\r\nexport default AIAssistantChat;\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\enterprise\\AdvancedSearch.tsx","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":20,"column":10,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":20,"endColumn":13,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[882,885],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[882,885],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":27,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":27,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[999,1002],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[999,1002],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":35,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":35,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1314,1317],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1314,1317],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":60,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":60,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2305,2308],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2305,2308],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":97,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":97,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3389,3392],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3389,3392],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":105,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":105,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3641,3644],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3641,3644],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\enterprise\\AnalyticsDashboard.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Calendar' is defined but never used.","line":29,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":29,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Filter' is defined but never used.","line":32,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":32,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Loader2' is defined but never used.","line":33,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":33,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'PieChart' is defined but never used.","line":34,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":34,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Users' is defined but never used.","line":39,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":39,"endColumn":8},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":384,"column":37,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[11381,11415],"text":"Your team&apos;s activities this period"},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[11381,11415],"text":"Your team&lsquo;s activities this period"},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[11381,11415],"text":"Your team&#39;s activities this period"},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[11381,11415],"text":"Your team&rsquo;s activities this period"},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Analytics Dashboard Component\r\n * ===============================\r\n * \r\n * Real-time analytics and sales intelligence dashboard\r\n */\r\n\r\n'use client';\r\n\r\nimport React, { useMemo, useState } from 'react';\r\nimport { useQuery } from '@tanstack/react-query';\r\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select';\r\nimport {\r\n  ArrowDown,\r\n  ArrowRight,\r\n  ArrowUp,\r\n  BarChart3,\r\n  Calendar,\r\n  DollarSign,\r\n  Download,\r\n  Filter,\r\n  Loader2,\r\n  PieChart,\r\n  RefreshCw,\r\n  Target,\r\n  TrendingDown,\r\n  TrendingUp,\r\n  Users,\r\n  Zap,\r\n} from 'lucide-react';\r\nimport { cn } from '@/lib/utils';\r\n\r\n// =============================================================================\r\n// Types\r\n// =============================================================================\r\n\r\ninterface SalesMetrics {\r\n  revenue: {\r\n    current: number;\r\n    previous: number;\r\n    target: number;\r\n    trend: number;\r\n  };\r\n  deals: {\r\n    won: number;\r\n    lost: number;\r\n    in_progress: number;\r\n    avg_deal_size: number;\r\n    win_rate: number;\r\n  };\r\n  pipeline: {\r\n    value: number;\r\n    weighted_value: number;\r\n    stages: PipelineStage[];\r\n  };\r\n  activities: {\r\n    calls: number;\r\n    emails: number;\r\n    meetings: number;\r\n    tasks_completed: number;\r\n  };\r\n}\r\n\r\ninterface PipelineStage {\r\n  name: string;\r\n  value: number;\r\n  count: number;\r\n  conversion_rate: number;\r\n}\r\n\r\ninterface SalesForecast {\r\n  period: string;\r\n  predicted: number;\r\n  lower_bound: number;\r\n  upper_bound: number;\r\n  confidence: number;\r\n}\r\n\r\ninterface TeamPerformance {\r\n  user_id: string;\r\n  name: string;\r\n  avatar?: string;\r\n  revenue: number;\r\n  deals_won: number;\r\n  deals_lost: number;\r\n  win_rate: number;\r\n  quota_attainment: number;\r\n  activities: number;\r\n  rank: number;\r\n}\r\n\r\ninterface ConversionFunnel {\r\n  stage: string;\r\n  count: number;\r\n  conversion_rate: number;\r\n  avg_time_in_stage: number;\r\n}\r\n\r\ninterface AIInsight {\r\n  id: string;\r\n  type: 'opportunity' | 'risk' | 'trend' | 'recommendation';\r\n  title: string;\r\n  description: string;\r\n  impact: 'high' | 'medium' | 'low';\r\n  action?: string;\r\n  related_entity?: {\r\n    type: string;\r\n    id: string;\r\n    name: string;\r\n  };\r\n}\r\n\r\n// =============================================================================\r\n// API Hooks\r\n// =============================================================================\r\n\r\nfunction useSalesMetrics(period: string) {\r\n  return useQuery<SalesMetrics>({\r\n    queryKey: ['analytics', 'sales-metrics', period],\r\n    queryFn: async () => {\r\n      const res = await fetch(`/api/analytics/sales-metrics?period=${period}`);\r\n      if (!res.ok) throw new Error('Failed to fetch sales metrics');\r\n      return res.json();\r\n    },\r\n    refetchInterval: 30000,\r\n  });\r\n}\r\n\r\nfunction useSalesForecast() {\r\n  return useQuery<SalesForecast[]>({\r\n    queryKey: ['analytics', 'forecast'],\r\n    queryFn: async () => {\r\n      const res = await fetch('/api/analytics/forecast');\r\n      if (!res.ok) throw new Error('Failed to fetch forecast');\r\n      return res.json();\r\n    },\r\n  });\r\n}\r\n\r\nfunction useTeamPerformance(period: string) {\r\n  return useQuery<TeamPerformance[]>({\r\n    queryKey: ['analytics', 'team-performance', period],\r\n    queryFn: async () => {\r\n      const res = await fetch(`/api/analytics/team-performance?period=${period}`);\r\n      if (!res.ok) throw new Error('Failed to fetch team performance');\r\n      return res.json();\r\n    },\r\n  });\r\n}\r\n\r\nfunction useConversionFunnel() {\r\n  return useQuery<ConversionFunnel[]>({\r\n    queryKey: ['analytics', 'conversion-funnel'],\r\n    queryFn: async () => {\r\n      const res = await fetch('/api/analytics/conversion-funnel');\r\n      if (!res.ok) throw new Error('Failed to fetch conversion funnel');\r\n      return res.json();\r\n    },\r\n  });\r\n}\r\n\r\nfunction useAIInsights() {\r\n  return useQuery<AIInsight[]>({\r\n    queryKey: ['analytics', 'ai-insights'],\r\n    queryFn: async () => {\r\n      const res = await fetch('/api/analytics/ai-insights');\r\n      if (!res.ok) throw new Error('Failed to fetch AI insights');\r\n      return res.json();\r\n    },\r\n    refetchInterval: 60000,\r\n  });\r\n}\r\n\r\n// =============================================================================\r\n// Main Component\r\n// =============================================================================\r\n\r\nexport function AnalyticsDashboard({ className }: { className?: string }) {\r\n  const [period, setPeriod] = useState('month');\r\n  const { data: metrics, isLoading, refetch } = useSalesMetrics(period);\r\n\r\n  if (isLoading || !metrics) {\r\n    return (\r\n      <div className={cn('space-y-6', className)}>\r\n        <div className=\"animate-pulse space-y-4\">\r\n          <div className=\"h-10 w-48 bg-muted rounded\" />\r\n          <div className=\"grid grid-cols-4 gap-4\">\r\n            {[...Array(4)].map((_, i) => (\r\n              <div key={i} className=\"h-32 bg-muted rounded-lg\" />\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className={cn('space-y-6', className)}>\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h2 className=\"text-2xl font-bold tracking-tight\">Analytics Dashboard</h2>\r\n          <p className=\"text-muted-foreground\">\r\n            Real-time sales intelligence and performance metrics\r\n          </p>\r\n        </div>\r\n        <div className=\"flex items-center gap-2\">\r\n          <Select value={period} onValueChange={setPeriod}>\r\n            <SelectTrigger className=\"w-[150px]\">\r\n              <SelectValue />\r\n            </SelectTrigger>\r\n            <SelectContent>\r\n              <SelectItem value=\"week\">This Week</SelectItem>\r\n              <SelectItem value=\"month\">This Month</SelectItem>\r\n              <SelectItem value=\"quarter\">This Quarter</SelectItem>\r\n              <SelectItem value=\"year\">This Year</SelectItem>\r\n            </SelectContent>\r\n          </Select>\r\n          <Button variant=\"outline\" onClick={() => refetch()}>\r\n            <RefreshCw className=\"h-4 w-4 mr-2\" />\r\n            Refresh\r\n          </Button>\r\n          <Button>\r\n            <Download className=\"h-4 w-4 mr-2\" />\r\n            Export\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* KPI Cards */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n        <KPICard\r\n          title=\"Revenue\"\r\n          value={formatCurrency(metrics.revenue.current)}\r\n          previousValue={formatCurrency(metrics.revenue.previous)}\r\n          trend={metrics.revenue.trend}\r\n          target={metrics.revenue.target}\r\n          icon={<DollarSign className=\"h-4 w-4\" />}\r\n        />\r\n        <KPICard\r\n          title=\"Deals Won\"\r\n          value={metrics.deals.won.toString()}\r\n          subtext={`Win Rate: ${metrics.deals.win_rate.toFixed(1)}%`}\r\n          trend={5}\r\n          icon={<Target className=\"h-4 w-4\" />}\r\n        />\r\n        <KPICard\r\n          title=\"Pipeline Value\"\r\n          value={formatCurrency(metrics.pipeline.value)}\r\n          subtext={`Weighted: ${formatCurrency(metrics.pipeline.weighted_value)}`}\r\n          icon={<BarChart3 className=\"h-4 w-4\" />}\r\n        />\r\n        <KPICard\r\n          title=\"Avg Deal Size\"\r\n          value={formatCurrency(metrics.deals.avg_deal_size)}\r\n          trend={8}\r\n          icon={<TrendingUp className=\"h-4 w-4\" />}\r\n        />\r\n      </div>\r\n\r\n      {/* Tabs */}\r\n      <Tabs defaultValue=\"overview\">\r\n        <TabsList>\r\n          <TabsTrigger value=\"overview\">Overview</TabsTrigger>\r\n          <TabsTrigger value=\"pipeline\">Pipeline</TabsTrigger>\r\n          <TabsTrigger value=\"team\">Team Performance</TabsTrigger>\r\n          <TabsTrigger value=\"forecast\">Forecast</TabsTrigger>\r\n          <TabsTrigger value=\"insights\">AI Insights</TabsTrigger>\r\n        </TabsList>\r\n\r\n        <TabsContent value=\"overview\" className=\"mt-6\">\r\n          <OverviewTab metrics={metrics} />\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"pipeline\" className=\"mt-6\">\r\n          <PipelineTab stages={metrics.pipeline.stages} />\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"team\" className=\"mt-6\">\r\n          <TeamPerformanceTab period={period} />\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"forecast\" className=\"mt-6\">\r\n          <ForecastTab />\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"insights\" className=\"mt-6\">\r\n          <AIInsightsTab />\r\n        </TabsContent>\r\n      </Tabs>\r\n    </div>\r\n  );\r\n}\r\n\r\n// =============================================================================\r\n// KPI Card\r\n// =============================================================================\r\n\r\nfunction KPICard({\r\n  title,\r\n  value,\r\n  previousValue,\r\n  subtext,\r\n  trend,\r\n  target,\r\n  icon,\r\n}: {\r\n  title: string;\r\n  value: string;\r\n  previousValue?: string;\r\n  subtext?: string;\r\n  trend?: number;\r\n  target?: number;\r\n  icon: React.ReactNode;\r\n}) {\r\n  const progress = target ? (parseFloat(value.replace(/[^0-9.]/g, '')) / target) * 100 : null;\r\n\r\n  return (\r\n    <Card>\r\n      <CardContent className=\"pt-6\">\r\n        <div className=\"flex items-center justify-between mb-2\">\r\n          <div className=\"p-2 rounded-lg bg-primary/10\">\r\n            {icon}\r\n          </div>\r\n          {trend !== undefined && (\r\n            <Badge\r\n              variant={trend >= 0 ? 'default' : 'destructive'}\r\n              className={cn(\r\n                'text-xs',\r\n                trend >= 0 ? 'bg-green-500' : 'bg-red-500'\r\n              )}\r\n            >\r\n              {trend >= 0 ? <ArrowUp className=\"h-3 w-3 mr-1\" /> : <ArrowDown className=\"h-3 w-3 mr-1\" />}\r\n              {Math.abs(trend)}%\r\n            </Badge>\r\n          )}\r\n        </div>\r\n        <p className=\"text-sm text-muted-foreground\">{title}</p>\r\n        <p className=\"text-2xl font-bold mt-1\">{value}</p>\r\n        {subtext && (\r\n          <p className=\"text-xs text-muted-foreground mt-1\">{subtext}</p>\r\n        )}\r\n        {previousValue && (\r\n          <p className=\"text-xs text-muted-foreground mt-1\">\r\n            vs {previousValue} last period\r\n          </p>\r\n        )}\r\n        {progress !== null && (\r\n          <div className=\"mt-4\">\r\n            <div className=\"flex items-center justify-between text-xs text-muted-foreground mb-1\">\r\n              <span>Target</span>\r\n              <span>{progress.toFixed(0)}%</span>\r\n            </div>\r\n            <Progress value={Math.min(progress, 100)} className=\"h-1.5\" />\r\n          </div>\r\n        )}\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n}\r\n\r\n// =============================================================================\r\n// Overview Tab\r\n// =============================================================================\r\n\r\nfunction OverviewTab({ metrics }: { metrics: SalesMetrics }) {\r\n  return (\r\n    <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n      {/* Activity Summary */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"text-base\">Activity Summary</CardTitle>\r\n          <CardDescription>Your team's activities this period</CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-4\">\r\n            <ActivityBar\r\n              label=\"Calls\"\r\n              value={metrics.activities.calls}\r\n              max={200}\r\n              color=\"bg-blue-500\"\r\n            />\r\n            <ActivityBar\r\n              label=\"Emails\"\r\n              value={metrics.activities.emails}\r\n              max={500}\r\n              color=\"bg-green-500\"\r\n            />\r\n            <ActivityBar\r\n              label=\"Meetings\"\r\n              value={metrics.activities.meetings}\r\n              max={100}\r\n              color=\"bg-purple-500\"\r\n            />\r\n            <ActivityBar\r\n              label=\"Tasks Completed\"\r\n              value={metrics.activities.tasks_completed}\r\n              max={300}\r\n              color=\"bg-orange-500\"\r\n            />\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Deal Status */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"text-base\">Deal Status</CardTitle>\r\n          <CardDescription>Win/Loss breakdown</CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"flex items-center justify-center gap-8\">\r\n            <div className=\"text-center\">\r\n              <div className=\"w-20 h-20 rounded-full bg-green-500/20 flex items-center justify-center mb-2\">\r\n                <span className=\"text-2xl font-bold text-green-500\">\r\n                  {metrics.deals.won}\r\n                </span>\r\n              </div>\r\n              <p className=\"text-sm text-muted-foreground\">Won</p>\r\n            </div>\r\n            <div className=\"text-center\">\r\n              <div className=\"w-20 h-20 rounded-full bg-blue-500/20 flex items-center justify-center mb-2\">\r\n                <span className=\"text-2xl font-bold text-blue-500\">\r\n                  {metrics.deals.in_progress}\r\n                </span>\r\n              </div>\r\n              <p className=\"text-sm text-muted-foreground\">In Progress</p>\r\n            </div>\r\n            <div className=\"text-center\">\r\n              <div className=\"w-20 h-20 rounded-full bg-red-500/20 flex items-center justify-center mb-2\">\r\n                <span className=\"text-2xl font-bold text-red-500\">\r\n                  {metrics.deals.lost}\r\n                </span>\r\n              </div>\r\n              <p className=\"text-sm text-muted-foreground\">Lost</p>\r\n            </div>\r\n          </div>\r\n          <div className=\"mt-6 pt-4 border-t\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <span className=\"text-sm text-muted-foreground\">Win Rate</span>\r\n              <span className=\"text-lg font-semibold\">\r\n                {metrics.deals.win_rate.toFixed(1)}%\r\n              </span>\r\n            </div>\r\n            <Progress value={metrics.deals.win_rate} className=\"h-2 mt-2\" />\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Conversion Funnel */}\r\n      <Card className=\"lg:col-span-2\">\r\n        <CardHeader>\r\n          <CardTitle className=\"text-base\">Sales Funnel</CardTitle>\r\n          <CardDescription>Lead to customer conversion</CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <ConversionFunnelChart />\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n\r\n// =============================================================================\r\n// Pipeline Tab\r\n// =============================================================================\r\n\r\nfunction PipelineTab({ stages }: { stages: PipelineStage[] }) {\r\n  const totalValue = useMemo(\r\n    () => stages.reduce((acc, stage) => acc + stage.value, 0),\r\n    [stages]\r\n  );\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Pipeline Stages */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n        {stages.map((stage, index) => (\r\n          <Card key={stage.name}>\r\n            <CardContent className=\"pt-6\">\r\n              <div className=\"flex items-center justify-between mb-4\">\r\n                <Badge variant=\"outline\">{stage.name}</Badge>\r\n                <span className=\"text-xs text-muted-foreground\">\r\n                  {stage.count} deals\r\n                </span>\r\n              </div>\r\n              <p className=\"text-2xl font-bold\">{formatCurrency(stage.value)}</p>\r\n              <p className=\"text-xs text-muted-foreground mt-1\">\r\n                {((stage.value / totalValue) * 100).toFixed(1)}% of pipeline\r\n              </p>\r\n              <div className=\"mt-4\">\r\n                <div className=\"flex items-center justify-between text-xs text-muted-foreground mb-1\">\r\n                  <span>Conversion Rate</span>\r\n                  <span>{stage.conversion_rate.toFixed(1)}%</span>\r\n                </div>\r\n                <Progress value={stage.conversion_rate} className=\"h-1.5\" />\r\n              </div>\r\n              {index < stages.length - 1 && (\r\n                <div className=\"absolute right-0 top-1/2 transform translate-x-1/2 -translate-y-1/2 hidden lg:block\">\r\n                  <ArrowRight className=\"h-4 w-4 text-muted-foreground\" />\r\n                </div>\r\n              )}\r\n            </CardContent>\r\n          </Card>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Pipeline Details Table */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"text-base\">Pipeline Details</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-4\">\r\n            {stages.map((stage) => (\r\n              <div key={stage.name} className=\"space-y-2\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <span className=\"font-medium\">{stage.name}</span>\r\n                  <div className=\"flex items-center gap-4\">\r\n                    <span className=\"text-sm text-muted-foreground\">\r\n                      {stage.count} deals\r\n                    </span>\r\n                    <span className=\"font-semibold\">\r\n                      {formatCurrency(stage.value)}\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n                <div className=\"relative\">\r\n                  <Progress\r\n                    value={(stage.value / totalValue) * 100}\r\n                    className=\"h-3\"\r\n                  />\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n\r\n// =============================================================================\r\n// Team Performance Tab\r\n// =============================================================================\r\n\r\nfunction TeamPerformanceTab({ period }: { period: string }) {\r\n  const { data: team = [], isLoading } = useTeamPerformance(period);\r\n\r\n  if (isLoading) {\r\n    return <div className=\"animate-pulse h-64 bg-muted rounded-lg\" />;\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Leaderboard */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"text-base\">Sales Leaderboard</CardTitle>\r\n          <CardDescription>Top performers this period</CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-4\">\r\n            {team.slice(0, 10).map((member, index) => (\r\n              <div\r\n                key={member.user_id}\r\n                className={cn(\r\n                  'flex items-center gap-4 p-3 rounded-lg',\r\n                  index < 3 && 'bg-muted'\r\n                )}\r\n              >\r\n                <div\r\n                  className={cn(\r\n                    'w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm',\r\n                    index === 0 && 'bg-yellow-500 text-white',\r\n                    index === 1 && 'bg-gray-400 text-white',\r\n                    index === 2 && 'bg-amber-600 text-white',\r\n                    index > 2 && 'bg-muted-foreground/20'\r\n                  )}\r\n                >\r\n                  {index + 1}\r\n                </div>\r\n                <div className=\"flex-1\">\r\n                  <p className=\"font-medium\">{member.name}</p>\r\n                  <p className=\"text-sm text-muted-foreground\">\r\n                    {member.deals_won} deals · {member.win_rate.toFixed(0)}% win rate\r\n                  </p>\r\n                </div>\r\n                <div className=\"text-right\">\r\n                  <p className=\"font-bold\">{formatCurrency(member.revenue)}</p>\r\n                  <div className=\"flex items-center gap-1 text-sm\">\r\n                    <span className=\"text-muted-foreground\">Quota:</span>\r\n                    <Badge\r\n                      variant={member.quota_attainment >= 100 ? 'default' : 'secondary'}\r\n                      className={cn(\r\n                        member.quota_attainment >= 100 && 'bg-green-500'\r\n                      )}\r\n                    >\r\n                      {member.quota_attainment.toFixed(0)}%\r\n                    </Badge>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n\r\n// =============================================================================\r\n// Forecast Tab\r\n// =============================================================================\r\n\r\nfunction ForecastTab() {\r\n  const { data: forecast = [], isLoading } = useSalesForecast();\r\n\r\n  if (isLoading) {\r\n    return <div className=\"animate-pulse h-64 bg-muted rounded-lg\" />;\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <Card>\r\n        <CardHeader>\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <CardTitle className=\"text-base\">Revenue Forecast</CardTitle>\r\n              <CardDescription>AI-powered revenue predictions</CardDescription>\r\n            </div>\r\n            <Badge variant=\"outline\" className=\"gap-1\">\r\n              <Zap className=\"h-3 w-3\" />\r\n              AI Powered\r\n            </Badge>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-6\">\r\n            {forecast.map((item) => (\r\n              <div key={item.period} className=\"space-y-2\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <span className=\"font-medium\">{item.period}</span>\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <span className=\"text-lg font-bold\">\r\n                      {formatCurrency(item.predicted)}\r\n                    </span>\r\n                    <Badge variant=\"outline\">\r\n                      {item.confidence.toFixed(0)}% confidence\r\n                    </Badge>\r\n                  </div>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <span className=\"text-xs text-muted-foreground\">\r\n                    {formatCurrency(item.lower_bound)}\r\n                  </span>\r\n                  <div className=\"flex-1 relative h-2\">\r\n                    <div className=\"absolute inset-0 bg-muted rounded-full\" />\r\n                    <div\r\n                      className=\"absolute inset-y-0 bg-primary/30 rounded-full\"\r\n                      style={{\r\n                        left: `${((item.lower_bound - item.lower_bound) / (item.upper_bound - item.lower_bound)) * 100}%`,\r\n                        right: `${100 - ((item.upper_bound - item.lower_bound) / (item.upper_bound - item.lower_bound)) * 100}%`,\r\n                      }}\r\n                    />\r\n                    <div\r\n                      className=\"absolute top-1/2 w-3 h-3 bg-primary rounded-full -translate-y-1/2\"\r\n                      style={{\r\n                        left: `${((item.predicted - item.lower_bound) / (item.upper_bound - item.lower_bound)) * 100}%`,\r\n                      }}\r\n                    />\r\n                  </div>\r\n                  <span className=\"text-xs text-muted-foreground\">\r\n                    {formatCurrency(item.upper_bound)}\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n\r\n// =============================================================================\r\n// AI Insights Tab\r\n// =============================================================================\r\n\r\nfunction AIInsightsTab() {\r\n  const { data: insights = [], isLoading } = useAIInsights();\r\n\r\n  if (isLoading) {\r\n    return <div className=\"animate-pulse h-64 bg-muted rounded-lg\" />;\r\n  }\r\n\r\n  const insightIcons: Record<string, React.ReactNode> = {\r\n    opportunity: <TrendingUp className=\"h-4 w-4 text-green-500\" />,\r\n    risk: <TrendingDown className=\"h-4 w-4 text-red-500\" />,\r\n    trend: <BarChart3 className=\"h-4 w-4 text-blue-500\" />,\r\n    recommendation: <Zap className=\"h-4 w-4 text-purple-500\" />,\r\n  };\r\n\r\n  const impactColors: Record<string, string> = {\r\n    high: 'bg-red-500',\r\n    medium: 'bg-yellow-500',\r\n    low: 'bg-blue-500',\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      {insights.map((insight) => (\r\n        <Card key={insight.id}>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"flex items-start gap-4\">\r\n              <div className=\"p-2 rounded-lg bg-muted\">\r\n                {insightIcons[insight.type]}\r\n              </div>\r\n              <div className=\"flex-1\">\r\n                <div className=\"flex items-center gap-2 mb-1\">\r\n                  <h4 className=\"font-semibold\">{insight.title}</h4>\r\n                  <Badge className={cn('text-white', impactColors[insight.impact])}>\r\n                    {insight.impact} impact\r\n                  </Badge>\r\n                </div>\r\n                <p className=\"text-sm text-muted-foreground mb-3\">\r\n                  {insight.description}\r\n                </p>\r\n                {insight.action && (\r\n                  <Button size=\"sm\" variant=\"outline\">\r\n                    {insight.action}\r\n                    <ArrowRight className=\"h-3 w-3 ml-2\" />\r\n                  </Button>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      ))}\r\n      {insights.length === 0 && (\r\n        <Card>\r\n          <CardContent className=\"py-8 text-center\">\r\n            <Zap className=\"h-8 w-8 mx-auto text-muted-foreground mb-2\" />\r\n            <p className=\"text-muted-foreground\">No insights available yet</p>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n// =============================================================================\r\n// Helper Components\r\n// =============================================================================\r\n\r\nfunction ActivityBar({\r\n  label,\r\n  value,\r\n  max,\r\n  color,\r\n}: {\r\n  label: string;\r\n  value: number;\r\n  max: number;\r\n  color: string;\r\n}) {\r\n  const percentage = Math.min((value / max) * 100, 100);\r\n\r\n  return (\r\n    <div className=\"space-y-1\">\r\n      <div className=\"flex items-center justify-between text-sm\">\r\n        <span>{label}</span>\r\n        <span className=\"font-medium\">{value}</span>\r\n      </div>\r\n      <div className=\"h-2 bg-muted rounded-full overflow-hidden\">\r\n        <div\r\n          className={cn('h-full rounded-full transition-all', color)}\r\n          style={{ width: `${percentage}%` }}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction ConversionFunnelChart() {\r\n  const { data: funnel = [], isLoading } = useConversionFunnel();\r\n\r\n  if (isLoading) {\r\n    return <div className=\"animate-pulse h-32 bg-muted rounded-lg\" />;\r\n  }\r\n\r\n  const maxCount = Math.max(...funnel.map((f) => f.count));\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      {funnel.map((stage, index) => (\r\n        <div key={stage.stage} className=\"flex items-center gap-4\">\r\n          <div className=\"w-24 text-sm font-medium\">{stage.stage}</div>\r\n          <div className=\"flex-1 relative\">\r\n            <div\r\n              className=\"h-8 rounded bg-primary/20 flex items-center justify-end pr-3\"\r\n              style={{ width: `${(stage.count / maxCount) * 100}%` }}\r\n            >\r\n              <span className=\"text-sm font-medium\">{stage.count}</span>\r\n            </div>\r\n          </div>\r\n          <div className=\"w-24 text-right\">\r\n            {index > 0 && (\r\n              <span className=\"text-sm text-muted-foreground\">\r\n                {stage.conversion_rate.toFixed(1)}%\r\n              </span>\r\n            )}\r\n          </div>\r\n        </div>\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n\r\n// =============================================================================\r\n// Utilities\r\n// =============================================================================\r\n\r\nfunction formatCurrency(value: number): string {\r\n  return new Intl.NumberFormat('en-US', {\r\n    style: 'currency',\r\n    currency: 'USD',\r\n    notation: value >= 1000000 ? 'compact' : 'standard',\r\n    maximumFractionDigits: value >= 1000000 ? 1 : 0,\r\n  }).format(value);\r\n}\r\n\r\nexport default AnalyticsDashboard;\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\enterprise\\AuditLogViewer.tsx","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":27,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":27,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[969,972],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[969,972],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":32,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1127,1130],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1127,1130],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\enterprise\\ComplianceDashboard.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Dialog' is defined but never used.","line":28,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":28,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DialogContent' is defined but never used.","line":29,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":29,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DialogDescription' is defined but never used.","line":30,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":30,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DialogFooter' is defined but never used.","line":31,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":31,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DialogHeader' is defined but never used.","line":32,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":32,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DialogTitle' is defined but never used.","line":33,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":33,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DialogTrigger' is defined but never used.","line":34,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":34,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Compliance Dashboard Component\r\n * ================================\r\n * \r\n * Comprehensive GDPR, SOC2, and regulatory compliance monitoring\r\n */\r\n\r\n'use client';\r\n\r\nimport React, { useState } from 'react';\r\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { ScrollArea } from '@/components/ui/scroll-area';\r\nimport { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from '@/components/ui/table';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogTrigger,\r\n} from '@/components/ui/dialog';\r\nimport {\r\n  AlertTriangle,\r\n  CheckCircle2,\r\n  Clock,\r\n  Download,\r\n  Eye,\r\n  FileCheck,\r\n  FileText,\r\n  History,\r\n  Lock,\r\n  PenLine,\r\n  RefreshCw,\r\n  Shield,\r\n  ShieldAlert,\r\n  ShieldCheck,\r\n  Trash2,\r\n  UserX,\r\n  XCircle,\r\n} from 'lucide-react';\r\nimport { cn } from '@/lib/utils';\r\n\r\n// =============================================================================\r\n// Types\r\n// =============================================================================\r\n\r\ninterface ComplianceStatus {\r\n  gdpr: ComplianceFramework;\r\n  soc2: ComplianceFramework;\r\n  hipaa: ComplianceFramework;\r\n  ccpa: ComplianceFramework;\r\n  overall_score: number;\r\n  last_audit: string;\r\n  next_audit: string;\r\n}\r\n\r\ninterface ComplianceFramework {\r\n  name: string;\r\n  score: number;\r\n  status: 'compliant' | 'partial' | 'non_compliant';\r\n  controls_passed: number;\r\n  controls_total: number;\r\n  findings: ComplianceFinding[];\r\n}\r\n\r\ninterface ComplianceFinding {\r\n  id: string;\r\n  severity: 'critical' | 'high' | 'medium' | 'low';\r\n  title: string;\r\n  description: string;\r\n  remediation: string;\r\n  status: 'open' | 'in_progress' | 'resolved';\r\n  due_date: string;\r\n  assigned_to?: string;\r\n}\r\n\r\ninterface DataSubjectRequest {\r\n  id: string;\r\n  type: 'access' | 'rectification' | 'erasure' | 'portability' | 'restriction';\r\n  subject_email: string;\r\n  subject_name: string;\r\n  status: 'pending' | 'in_progress' | 'completed' | 'rejected';\r\n  submitted_at: string;\r\n  due_date: string;\r\n  completed_at?: string;\r\n}\r\n\r\ninterface AuditLogEntry {\r\n  id: string;\r\n  timestamp: string;\r\n  user: string;\r\n  action: string;\r\n  resource: string;\r\n  details: string;\r\n  ip_address: string;\r\n  risk_level: 'low' | 'medium' | 'high';\r\n}\r\n\r\ninterface ConsentRecord {\r\n  id: string;\r\n  contact_email: string;\r\n  contact_name: string;\r\n  consent_type: string;\r\n  status: 'active' | 'withdrawn' | 'expired';\r\n  given_at: string;\r\n  expires_at?: string;\r\n  source: string;\r\n}\r\n\r\n// =============================================================================\r\n// API Hooks\r\n// =============================================================================\r\n\r\nfunction useComplianceStatus() {\r\n  return useQuery<ComplianceStatus>({\r\n    queryKey: ['compliance', 'status'],\r\n    queryFn: async () => {\r\n      const res = await fetch('/api/compliance/status');\r\n      if (!res.ok) throw new Error('Failed to fetch compliance status');\r\n      return res.json();\r\n    },\r\n    refetchInterval: 60000, // 1 minute\r\n  });\r\n}\r\n\r\nfunction useDataSubjectRequests() {\r\n  return useQuery<DataSubjectRequest[]>({\r\n    queryKey: ['compliance', 'dsr'],\r\n    queryFn: async () => {\r\n      const res = await fetch('/api/compliance/dsr');\r\n      if (!res.ok) throw new Error('Failed to fetch DSR');\r\n      return res.json();\r\n    },\r\n  });\r\n}\r\n\r\nfunction useAuditLogs() {\r\n  return useQuery<AuditLogEntry[]>({\r\n    queryKey: ['compliance', 'audit-logs'],\r\n    queryFn: async () => {\r\n      const res = await fetch('/api/compliance/audit-logs?limit=100');\r\n      if (!res.ok) throw new Error('Failed to fetch audit logs');\r\n      return res.json();\r\n    },\r\n  });\r\n}\r\n\r\nfunction useConsentRecords() {\r\n  return useQuery<ConsentRecord[]>({\r\n    queryKey: ['compliance', 'consents'],\r\n    queryFn: async () => {\r\n      const res = await fetch('/api/compliance/consents');\r\n      if (!res.ok) throw new Error('Failed to fetch consent records');\r\n      return res.json();\r\n    },\r\n  });\r\n}\r\n\r\nfunction useProcessDSR() {\r\n  const queryClient = useQueryClient();\r\n  return useMutation({\r\n    mutationFn: async ({ id, action }: { id: string; action: 'approve' | 'reject' | 'complete' }) => {\r\n      const res = await fetch(`/api/compliance/dsr/${id}/${action}`, {\r\n        method: 'POST',\r\n      });\r\n      if (!res.ok) throw new Error('Failed to process DSR');\r\n      return res.json();\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['compliance', 'dsr'] });\r\n    },\r\n  });\r\n}\r\n\r\n// =============================================================================\r\n// Main Component\r\n// =============================================================================\r\n\r\nexport function ComplianceDashboard({ className }: { className?: string }) {\r\n  const { data: status, isLoading, refetch } = useComplianceStatus();\r\n  const [activeTab, setActiveTab] = useState('overview');\r\n\r\n  if (isLoading || !status) {\r\n    return (\r\n      <div className={cn('space-y-6', className)}>\r\n        <div className=\"animate-pulse space-y-4\">\r\n          <div className=\"h-32 bg-muted rounded-lg\" />\r\n          <div className=\"grid grid-cols-4 gap-4\">\r\n            {[...Array(4)].map((_, i) => (\r\n              <div key={i} className=\"h-24 bg-muted rounded-lg\" />\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className={cn('space-y-6', className)}>\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h2 className=\"text-2xl font-bold tracking-tight\">Compliance Dashboard</h2>\r\n          <p className=\"text-muted-foreground\">\r\n            Monitor regulatory compliance and data protection\r\n          </p>\r\n        </div>\r\n        <div className=\"flex items-center gap-2\">\r\n          <Button variant=\"outline\" onClick={() => refetch()}>\r\n            <RefreshCw className=\"h-4 w-4 mr-2\" />\r\n            Refresh\r\n          </Button>\r\n          <Button>\r\n            <Download className=\"h-4 w-4 mr-2\" />\r\n            Export Report\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Overall Score */}\r\n      <Card>\r\n        <CardContent className=\"pt-6\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center gap-4\">\r\n              <div className=\"p-4 rounded-full bg-gradient-to-r from-green-500/20 to-emerald-500/20\">\r\n                <ShieldCheck className=\"h-8 w-8 text-green-500\" />\r\n              </div>\r\n              <div>\r\n                <p className=\"text-sm text-muted-foreground\">Overall Compliance Score</p>\r\n                <p className=\"text-4xl font-bold\">{status.overall_score}%</p>\r\n              </div>\r\n            </div>\r\n            <div className=\"text-right\">\r\n              <p className=\"text-sm text-muted-foreground\">Last Audit</p>\r\n              <p className=\"font-medium\">{new Date(status.last_audit).toLocaleDateString()}</p>\r\n              <p className=\"text-sm text-muted-foreground mt-2\">Next Audit</p>\r\n              <p className=\"font-medium\">{new Date(status.next_audit).toLocaleDateString()}</p>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Framework Cards */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n        <FrameworkCard framework={status.gdpr} icon={Shield} />\r\n        <FrameworkCard framework={status.soc2} icon={FileCheck} />\r\n        <FrameworkCard framework={status.hipaa} icon={Lock} />\r\n        <FrameworkCard framework={status.ccpa} icon={UserX} />\r\n      </div>\r\n\r\n      {/* Tabs */}\r\n      <Tabs value={activeTab} onValueChange={setActiveTab}>\r\n        <TabsList>\r\n          <TabsTrigger value=\"overview\">Overview</TabsTrigger>\r\n          <TabsTrigger value=\"dsr\">Data Subject Requests</TabsTrigger>\r\n          <TabsTrigger value=\"audit\">Audit Logs</TabsTrigger>\r\n          <TabsTrigger value=\"consents\">Consent Management</TabsTrigger>\r\n        </TabsList>\r\n\r\n        <TabsContent value=\"overview\" className=\"mt-6\">\r\n          <OverviewTab status={status} />\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"dsr\" className=\"mt-6\">\r\n          <DSRTab />\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"audit\" className=\"mt-6\">\r\n          <AuditLogsTab />\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"consents\" className=\"mt-6\">\r\n          <ConsentsTab />\r\n        </TabsContent>\r\n      </Tabs>\r\n    </div>\r\n  );\r\n}\r\n\r\n// =============================================================================\r\n// Framework Card\r\n// =============================================================================\r\n\r\nfunction FrameworkCard({\r\n  framework,\r\n  icon: Icon,\r\n}: {\r\n  framework: ComplianceFramework;\r\n  icon: React.ComponentType<{ className?: string }>;\r\n}) {\r\n  const statusColors = {\r\n    compliant: 'text-green-500',\r\n    partial: 'text-yellow-500',\r\n    non_compliant: 'text-red-500',\r\n  };\r\n\r\n  const statusLabels = {\r\n    compliant: 'Compliant',\r\n    partial: 'Partial',\r\n    non_compliant: 'Non-Compliant',\r\n  };\r\n\r\n  return (\r\n    <Card>\r\n      <CardContent className=\"pt-6\">\r\n        <div className=\"flex items-center justify-between mb-4\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <Icon className={cn('h-5 w-5', statusColors[framework.status])} />\r\n            <span className=\"font-semibold\">{framework.name}</span>\r\n          </div>\r\n          <Badge\r\n            variant={framework.status === 'compliant' ? 'default' : 'secondary'}\r\n            className={cn(\r\n              framework.status === 'compliant' && 'bg-green-500',\r\n              framework.status === 'partial' && 'bg-yellow-500',\r\n              framework.status === 'non_compliant' && 'bg-red-500'\r\n            )}\r\n          >\r\n            {statusLabels[framework.status]}\r\n          </Badge>\r\n        </div>\r\n        <div className=\"space-y-2\">\r\n          <div className=\"flex items-center justify-between text-sm\">\r\n            <span className=\"text-muted-foreground\">Score</span>\r\n            <span className=\"font-medium\">{framework.score}%</span>\r\n          </div>\r\n          <Progress value={framework.score} className=\"h-2\" />\r\n          <div className=\"flex items-center justify-between text-sm\">\r\n            <span className=\"text-muted-foreground\">Controls</span>\r\n            <span className=\"font-medium\">\r\n              {framework.controls_passed}/{framework.controls_total} passed\r\n            </span>\r\n          </div>\r\n        </div>\r\n        {framework.findings.length > 0 && (\r\n          <div className=\"mt-4 pt-4 border-t\">\r\n            <p className=\"text-sm text-muted-foreground\">\r\n              {framework.findings.filter((f) => f.status === 'open').length} open findings\r\n            </p>\r\n          </div>\r\n        )}\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n}\r\n\r\n// =============================================================================\r\n// Overview Tab\r\n// =============================================================================\r\n\r\nfunction OverviewTab({ status }: { status: ComplianceStatus }) {\r\n  const allFindings = [\r\n    ...status.gdpr.findings,\r\n    ...status.soc2.findings,\r\n    ...status.hipaa.findings,\r\n    ...status.ccpa.findings,\r\n  ].filter((f) => f.status === 'open');\r\n\r\n  const criticalFindings = allFindings.filter((f) => f.severity === 'critical');\r\n  const highFindings = allFindings.filter((f) => f.severity === 'high');\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Alerts */}\r\n      {criticalFindings.length > 0 && (\r\n        <Alert variant=\"destructive\">\r\n          <AlertTriangle className=\"h-4 w-4\" />\r\n          <AlertTitle>Critical Findings</AlertTitle>\r\n          <AlertDescription>\r\n            There are {criticalFindings.length} critical compliance findings that require\r\n            immediate attention.\r\n          </AlertDescription>\r\n        </Alert>\r\n      )}\r\n\r\n      {highFindings.length > 0 && (\r\n        <Alert>\r\n          <ShieldAlert className=\"h-4 w-4\" />\r\n          <AlertTitle>High Priority Findings</AlertTitle>\r\n          <AlertDescription>\r\n            {highFindings.length} high priority findings need to be addressed soon.\r\n          </AlertDescription>\r\n        </Alert>\r\n      )}\r\n\r\n      {/* Findings Table */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Open Findings</CardTitle>\r\n          <CardDescription>\r\n            Compliance issues that need to be addressed\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <Table>\r\n            <TableHeader>\r\n              <TableRow>\r\n                <TableHead>Severity</TableHead>\r\n                <TableHead>Title</TableHead>\r\n                <TableHead>Framework</TableHead>\r\n                <TableHead>Due Date</TableHead>\r\n                <TableHead>Status</TableHead>\r\n                <TableHead>Actions</TableHead>\r\n              </TableRow>\r\n            </TableHeader>\r\n            <TableBody>\r\n              {allFindings.slice(0, 10).map((finding) => (\r\n                <TableRow key={finding.id}>\r\n                  <TableCell>\r\n                    <SeverityBadge severity={finding.severity} />\r\n                  </TableCell>\r\n                  <TableCell className=\"font-medium\">{finding.title}</TableCell>\r\n                  <TableCell>GDPR</TableCell>\r\n                  <TableCell>{new Date(finding.due_date).toLocaleDateString()}</TableCell>\r\n                  <TableCell>\r\n                    <StatusBadge status={finding.status} />\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    <Button variant=\"ghost\" size=\"sm\">\r\n                      <Eye className=\"h-4 w-4\" />\r\n                    </Button>\r\n                  </TableCell>\r\n                </TableRow>\r\n              ))}\r\n              {allFindings.length === 0 && (\r\n                <TableRow>\r\n                  <TableCell colSpan={6} className=\"text-center py-8\">\r\n                    <CheckCircle2 className=\"h-8 w-8 mx-auto text-green-500 mb-2\" />\r\n                    <p className=\"text-muted-foreground\">No open findings</p>\r\n                  </TableCell>\r\n                </TableRow>\r\n              )}\r\n            </TableBody>\r\n          </Table>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n\r\n// =============================================================================\r\n// DSR Tab\r\n// =============================================================================\r\n\r\nfunction DSRTab() {\r\n  const { data: requests = [], isLoading } = useDataSubjectRequests();\r\n  const processDSR = useProcessDSR();\r\n\r\n  const pendingRequests = requests.filter((r) => r.status === 'pending');\r\n  const overdueRequests = requests.filter(\r\n    (r) => r.status === 'pending' && new Date(r.due_date) < new Date()\r\n  );\r\n\r\n  if (isLoading) {\r\n    return <div className=\"animate-pulse h-64 bg-muted rounded-lg\" />;\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Stats */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n        <Card>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"flex items-center gap-4\">\r\n              <div className=\"p-2 rounded-lg bg-blue-500/20\">\r\n                <Clock className=\"h-5 w-5 text-blue-500\" />\r\n              </div>\r\n              <div>\r\n                <p className=\"text-2xl font-bold\">{pendingRequests.length}</p>\r\n                <p className=\"text-sm text-muted-foreground\">Pending</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n        <Card>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"flex items-center gap-4\">\r\n              <div className=\"p-2 rounded-lg bg-red-500/20\">\r\n                <AlertTriangle className=\"h-5 w-5 text-red-500\" />\r\n              </div>\r\n              <div>\r\n                <p className=\"text-2xl font-bold\">{overdueRequests.length}</p>\r\n                <p className=\"text-sm text-muted-foreground\">Overdue</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n        <Card>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"flex items-center gap-4\">\r\n              <div className=\"p-2 rounded-lg bg-green-500/20\">\r\n                <CheckCircle2 className=\"h-5 w-5 text-green-500\" />\r\n              </div>\r\n              <div>\r\n                <p className=\"text-2xl font-bold\">\r\n                  {requests.filter((r) => r.status === 'completed').length}\r\n                </p>\r\n                <p className=\"text-sm text-muted-foreground\">Completed</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n        <Card>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"flex items-center gap-4\">\r\n              <div className=\"p-2 rounded-lg bg-gray-500/20\">\r\n                <FileText className=\"h-5 w-5 text-gray-500\" />\r\n              </div>\r\n              <div>\r\n                <p className=\"text-2xl font-bold\">{requests.length}</p>\r\n                <p className=\"text-sm text-muted-foreground\">Total</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Requests Table */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Data Subject Requests</CardTitle>\r\n          <CardDescription>\r\n            GDPR Article 15-22 requests from data subjects\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <Table>\r\n            <TableHeader>\r\n              <TableRow>\r\n                <TableHead>Type</TableHead>\r\n                <TableHead>Subject</TableHead>\r\n                <TableHead>Submitted</TableHead>\r\n                <TableHead>Due Date</TableHead>\r\n                <TableHead>Status</TableHead>\r\n                <TableHead>Actions</TableHead>\r\n              </TableRow>\r\n            </TableHeader>\r\n            <TableBody>\r\n              {requests.map((request) => (\r\n                <TableRow key={request.id}>\r\n                  <TableCell>\r\n                    <DSRTypeBadge type={request.type} />\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    <div>\r\n                      <p className=\"font-medium\">{request.subject_name}</p>\r\n                      <p className=\"text-sm text-muted-foreground\">\r\n                        {request.subject_email}\r\n                      </p>\r\n                    </div>\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    {new Date(request.submitted_at).toLocaleDateString()}\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    <span\r\n                      className={cn(\r\n                        new Date(request.due_date) < new Date() &&\r\n                          request.status === 'pending' &&\r\n                          'text-red-500 font-medium'\r\n                      )}\r\n                    >\r\n                      {new Date(request.due_date).toLocaleDateString()}\r\n                    </span>\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    <DSRStatusBadge status={request.status} />\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    <div className=\"flex items-center gap-2\">\r\n                      {request.status === 'pending' && (\r\n                        <>\r\n                          <Button\r\n                            size=\"sm\"\r\n                            variant=\"outline\"\r\n                            onClick={() =>\r\n                              processDSR.mutate({ id: request.id, action: 'approve' })\r\n                            }\r\n                            disabled={processDSR.isPending}\r\n                          >\r\n                            Process\r\n                          </Button>\r\n                        </>\r\n                      )}\r\n                      <Button variant=\"ghost\" size=\"icon\">\r\n                        <Eye className=\"h-4 w-4\" />\r\n                      </Button>\r\n                    </div>\r\n                  </TableCell>\r\n                </TableRow>\r\n              ))}\r\n              {requests.length === 0 && (\r\n                <TableRow>\r\n                  <TableCell colSpan={6} className=\"text-center py-8\">\r\n                    <FileText className=\"h-8 w-8 mx-auto text-muted-foreground mb-2\" />\r\n                    <p className=\"text-muted-foreground\">No data subject requests</p>\r\n                  </TableCell>\r\n                </TableRow>\r\n              )}\r\n            </TableBody>\r\n          </Table>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n\r\n// =============================================================================\r\n// Audit Logs Tab\r\n// =============================================================================\r\n\r\nfunction AuditLogsTab() {\r\n  const { data: logs = [], isLoading } = useAuditLogs();\r\n\r\n  if (isLoading) {\r\n    return <div className=\"animate-pulse h-64 bg-muted rounded-lg\" />;\r\n  }\r\n\r\n  return (\r\n    <Card>\r\n      <CardHeader>\r\n        <div className=\"flex items-center justify-between\">\r\n          <div>\r\n            <CardTitle>Audit Logs</CardTitle>\r\n            <CardDescription>\r\n              Complete audit trail of system activities\r\n            </CardDescription>\r\n          </div>\r\n          <Button variant=\"outline\">\r\n            <Download className=\"h-4 w-4 mr-2\" />\r\n            Export\r\n          </Button>\r\n        </div>\r\n      </CardHeader>\r\n      <CardContent>\r\n        <ScrollArea className=\"h-[500px]\">\r\n          <Table>\r\n            <TableHeader>\r\n              <TableRow>\r\n                <TableHead>Timestamp</TableHead>\r\n                <TableHead>User</TableHead>\r\n                <TableHead>Action</TableHead>\r\n                <TableHead>Resource</TableHead>\r\n                <TableHead>IP Address</TableHead>\r\n                <TableHead>Risk</TableHead>\r\n              </TableRow>\r\n            </TableHeader>\r\n            <TableBody>\r\n              {logs.map((log) => (\r\n                <TableRow key={log.id}>\r\n                  <TableCell className=\"font-mono text-sm\">\r\n                    {new Date(log.timestamp).toLocaleString()}\r\n                  </TableCell>\r\n                  <TableCell>{log.user}</TableCell>\r\n                  <TableCell>\r\n                    <Badge variant=\"outline\">{log.action}</Badge>\r\n                  </TableCell>\r\n                  <TableCell className=\"max-w-[200px] truncate\">\r\n                    {log.resource}\r\n                  </TableCell>\r\n                  <TableCell className=\"font-mono text-sm\">{log.ip_address}</TableCell>\r\n                  <TableCell>\r\n                    <RiskBadge level={log.risk_level} />\r\n                  </TableCell>\r\n                </TableRow>\r\n              ))}\r\n              {logs.length === 0 && (\r\n                <TableRow>\r\n                  <TableCell colSpan={6} className=\"text-center py-8\">\r\n                    <History className=\"h-8 w-8 mx-auto text-muted-foreground mb-2\" />\r\n                    <p className=\"text-muted-foreground\">No audit logs</p>\r\n                  </TableCell>\r\n                </TableRow>\r\n              )}\r\n            </TableBody>\r\n          </Table>\r\n        </ScrollArea>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n}\r\n\r\n// =============================================================================\r\n// Consents Tab\r\n// =============================================================================\r\n\r\nfunction ConsentsTab() {\r\n  const { data: consents = [], isLoading } = useConsentRecords();\r\n\r\n  if (isLoading) {\r\n    return <div className=\"animate-pulse h-64 bg-muted rounded-lg\" />;\r\n  }\r\n\r\n  const activeConsents = consents.filter((c) => c.status === 'active');\r\n  const withdrawnConsents = consents.filter((c) => c.status === 'withdrawn');\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Stats */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n        <Card>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"flex items-center gap-4\">\r\n              <div className=\"p-2 rounded-lg bg-green-500/20\">\r\n                <CheckCircle2 className=\"h-5 w-5 text-green-500\" />\r\n              </div>\r\n              <div>\r\n                <p className=\"text-2xl font-bold\">{activeConsents.length}</p>\r\n                <p className=\"text-sm text-muted-foreground\">Active Consents</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n        <Card>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"flex items-center gap-4\">\r\n              <div className=\"p-2 rounded-lg bg-red-500/20\">\r\n                <XCircle className=\"h-5 w-5 text-red-500\" />\r\n              </div>\r\n              <div>\r\n                <p className=\"text-2xl font-bold\">{withdrawnConsents.length}</p>\r\n                <p className=\"text-sm text-muted-foreground\">Withdrawn</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n        <Card>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"flex items-center gap-4\">\r\n              <div className=\"p-2 rounded-lg bg-blue-500/20\">\r\n                <FileText className=\"h-5 w-5 text-blue-500\" />\r\n              </div>\r\n              <div>\r\n                <p className=\"text-2xl font-bold\">{consents.length}</p>\r\n                <p className=\"text-sm text-muted-foreground\">Total Records</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Consents Table */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Consent Records</CardTitle>\r\n          <CardDescription>\r\n            Track and manage user consent for data processing\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <Table>\r\n            <TableHeader>\r\n              <TableRow>\r\n                <TableHead>Contact</TableHead>\r\n                <TableHead>Consent Type</TableHead>\r\n                <TableHead>Given At</TableHead>\r\n                <TableHead>Expires</TableHead>\r\n                <TableHead>Source</TableHead>\r\n                <TableHead>Status</TableHead>\r\n              </TableRow>\r\n            </TableHeader>\r\n            <TableBody>\r\n              {consents.map((consent) => (\r\n                <TableRow key={consent.id}>\r\n                  <TableCell>\r\n                    <div>\r\n                      <p className=\"font-medium\">{consent.contact_name}</p>\r\n                      <p className=\"text-sm text-muted-foreground\">\r\n                        {consent.contact_email}\r\n                      </p>\r\n                    </div>\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    <Badge variant=\"outline\">{consent.consent_type}</Badge>\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    {new Date(consent.given_at).toLocaleDateString()}\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    {consent.expires_at\r\n                      ? new Date(consent.expires_at).toLocaleDateString()\r\n                      : 'Never'}\r\n                  </TableCell>\r\n                  <TableCell>{consent.source}</TableCell>\r\n                  <TableCell>\r\n                    <ConsentStatusBadge status={consent.status} />\r\n                  </TableCell>\r\n                </TableRow>\r\n              ))}\r\n              {consents.length === 0 && (\r\n                <TableRow>\r\n                  <TableCell colSpan={6} className=\"text-center py-8\">\r\n                    <FileText className=\"h-8 w-8 mx-auto text-muted-foreground mb-2\" />\r\n                    <p className=\"text-muted-foreground\">No consent records</p>\r\n                  </TableCell>\r\n                </TableRow>\r\n              )}\r\n            </TableBody>\r\n          </Table>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n\r\n// =============================================================================\r\n// Badge Components\r\n// =============================================================================\r\n\r\nfunction SeverityBadge({ severity }: { severity: string }) {\r\n  const variants: Record<string, string> = {\r\n    critical: 'bg-red-500 text-white',\r\n    high: 'bg-orange-500 text-white',\r\n    medium: 'bg-yellow-500 text-black',\r\n    low: 'bg-blue-500 text-white',\r\n  };\r\n\r\n  return (\r\n    <Badge className={variants[severity] || variants.low}>\r\n      {severity.charAt(0).toUpperCase() + severity.slice(1)}\r\n    </Badge>\r\n  );\r\n}\r\n\r\nfunction StatusBadge({ status }: { status: string }) {\r\n  const variants: Record<string, { variant: 'default' | 'secondary' | 'outline'; icon: React.ReactNode }> = {\r\n    open: { variant: 'secondary', icon: <Clock className=\"h-3 w-3 mr-1\" /> },\r\n    in_progress: { variant: 'default', icon: <RefreshCw className=\"h-3 w-3 mr-1\" /> },\r\n    resolved: { variant: 'outline', icon: <CheckCircle2 className=\"h-3 w-3 mr-1\" /> },\r\n  };\r\n\r\n  const config = variants[status] || variants.open;\r\n\r\n  return (\r\n    <Badge variant={config.variant} className=\"flex items-center w-fit\">\r\n      {config.icon}\r\n      {status.replace('_', ' ')}\r\n    </Badge>\r\n  );\r\n}\r\n\r\nfunction DSRTypeBadge({ type }: { type: string }) {\r\n  const icons: Record<string, React.ReactNode> = {\r\n    access: <Eye className=\"h-3 w-3 mr-1\" />,\r\n    rectification: <PenLine className=\"h-3 w-3 mr-1\" />,\r\n    erasure: <Trash2 className=\"h-3 w-3 mr-1\" />,\r\n    portability: <Download className=\"h-3 w-3 mr-1\" />,\r\n    restriction: <Lock className=\"h-3 w-3 mr-1\" />,\r\n  };\r\n\r\n  return (\r\n    <Badge variant=\"outline\" className=\"flex items-center w-fit\">\r\n      {icons[type]}\r\n      {type.charAt(0).toUpperCase() + type.slice(1)}\r\n    </Badge>\r\n  );\r\n}\r\n\r\nfunction DSRStatusBadge({ status }: { status: string }) {\r\n  const variants: Record<string, string> = {\r\n    pending: 'bg-yellow-500',\r\n    in_progress: 'bg-blue-500',\r\n    completed: 'bg-green-500',\r\n    rejected: 'bg-red-500',\r\n  };\r\n\r\n  return (\r\n    <Badge className={cn('text-white', variants[status] || variants.pending)}>\r\n      {status.replace('_', ' ')}\r\n    </Badge>\r\n  );\r\n}\r\n\r\nfunction RiskBadge({ level }: { level: string }) {\r\n  const variants: Record<string, string> = {\r\n    high: 'bg-red-500 text-white',\r\n    medium: 'bg-yellow-500 text-black',\r\n    low: 'bg-green-500 text-white',\r\n  };\r\n\r\n  return (\r\n    <Badge className={variants[level] || variants.low}>\r\n      {level.charAt(0).toUpperCase() + level.slice(1)}\r\n    </Badge>\r\n  );\r\n}\r\n\r\nfunction ConsentStatusBadge({ status }: { status: string }) {\r\n  const variants: Record<string, { class: string; icon: React.ReactNode }> = {\r\n    active: { class: 'bg-green-500 text-white', icon: <CheckCircle2 className=\"h-3 w-3 mr-1\" /> },\r\n    withdrawn: { class: 'bg-red-500 text-white', icon: <XCircle className=\"h-3 w-3 mr-1\" /> },\r\n    expired: { class: 'bg-gray-500 text-white', icon: <Clock className=\"h-3 w-3 mr-1\" /> },\r\n  };\r\n\r\n  const config = variants[status] || variants.active;\r\n\r\n  return (\r\n    <Badge className={cn('flex items-center w-fit', config.class)}>\r\n      {config.icon}\r\n      {status.charAt(0).toUpperCase() + status.slice(1)}\r\n    </Badge>\r\n  );\r\n}\r\n\r\nexport default ComplianceDashboard;\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\enterprise\\DashboardAndReports.tsx","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":22,"column":11,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":22,"endColumn":14,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1058,1061],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1058,1061],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":30,"column":11,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":30,"endColumn":14,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1203,1206],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1203,1206],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":38,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1322,1325],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1322,1325],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":219,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":219,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7760,7763],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7760,7763],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook React.useEffect has a missing dependency: 'loadReports'. Either include it or remove the dependency array.","line":349,"column":6,"nodeType":"ArrayExpression","endLine":349,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [loadReports]","fix":{"range":[11703,11705],"text":"[loadReports]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\enterprise\\DataImportExport.tsx","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":32,"column":11,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":14,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1131,1134],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1131,1134],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":94,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":94,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3219,3222],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3219,3222],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":178,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":178,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6335,6338],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6335,6338],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":407,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":407,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15249,15252],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15249,15252],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":490,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":490,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17617,17620],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17617,17620],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":595,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":595,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[20962,20965],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[20962,20965],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\enterprise\\EmailCampaignManager.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\enterprise\\HealthDashboard.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getComponentIcon' is assigned a value but never used.","line":121,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":121,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Enterprise Health Dashboard Component\r\n * ======================================\r\n * \r\n * Real-time system health monitoring dashboard\r\n */\r\n\r\n'use client';\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport {\r\n  Activity,\r\n  AlertTriangle,\r\n  CheckCircle2,\r\n  Clock,\r\n  Database,\r\n  HardDrive,\r\n  MemoryStick,\r\n  RefreshCw,\r\n  Server,\r\n  Wifi,\r\n  XCircle,\r\n} from 'lucide-react';\r\n\r\n// =============================================================================\r\n// Types\r\n// =============================================================================\r\n\r\ninterface HealthCheck {\r\n  name: string;\r\n  status: 'healthy' | 'degraded' | 'unhealthy';\r\n  latencyMs: number;\r\n  message?: string;\r\n  details?: Record<string, unknown>;\r\n  timestamp: string;\r\n}\r\n\r\ninterface AggregatedHealth {\r\n  status: 'healthy' | 'degraded' | 'unhealthy';\r\n  totalLatencyMs: number;\r\n  checks: HealthCheck[];\r\n  timestamp: string;\r\n  hostname?: string;\r\n}\r\n\r\n// =============================================================================\r\n// Health Dashboard Component\r\n// =============================================================================\r\n\r\nexport function HealthDashboard() {\r\n  const [health, setHealth] = useState<AggregatedHealth | null>(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [autoRefresh, setAutoRefresh] = useState(true);\r\n\r\n  const fetchHealth = async (fresh = false) => {\r\n    try {\r\n      setIsLoading(true);\r\n      setError(null);\r\n      \r\n      const url = fresh \r\n        ? '/api/health?fresh=true'\r\n        : '/api/health';\r\n      \r\n      const response = await fetch(url);\r\n      \r\n      if (!response.ok) {\r\n        throw new Error(`Health check failed: ${response.status}`);\r\n      }\r\n      \r\n      const data = await response.json();\r\n      setHealth(data);\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Failed to fetch health status');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchHealth();\r\n    \r\n    if (autoRefresh) {\r\n      const interval = setInterval(() => fetchHealth(), 30000);\r\n      return () => clearInterval(interval);\r\n    }\r\n  }, [autoRefresh]);\r\n\r\n  const getStatusIcon = (status: string) => {\r\n    switch (status) {\r\n      case 'healthy':\r\n        return <CheckCircle2 className=\"h-5 w-5 text-green-500\" />;\r\n      case 'degraded':\r\n        return <AlertTriangle className=\"h-5 w-5 text-yellow-500\" />;\r\n      case 'unhealthy':\r\n        return <XCircle className=\"h-5 w-5 text-red-500\" />;\r\n      default:\r\n        return <Activity className=\"h-5 w-5 text-gray-500\" />;\r\n    }\r\n  };\r\n\r\n  const getStatusBadge = (status: string) => {\r\n    const variants: Record<string, 'default' | 'secondary' | 'destructive' | 'outline'> = {\r\n      healthy: 'default',\r\n      degraded: 'secondary',\r\n      unhealthy: 'destructive',\r\n    };\r\n    \r\n    return (\r\n      <Badge variant={variants[status] || 'outline'} className=\"capitalize\">\r\n        {status}\r\n      </Badge>\r\n    );\r\n  };\r\n\r\n  const getComponentIcon = (name: string) => {\r\n    if (name.includes('database') || name.includes('postgres')) {\r\n      return <Database className=\"h-4 w-4\" />;\r\n    }\r\n    if (name.includes('redis') || name.includes('cache')) {\r\n      return <Server className=\"h-4 w-4\" />;\r\n    }\r\n    if (name.includes('celery') || name.includes('worker')) {\r\n      return <Activity className=\"h-4 w-4\" />;\r\n    }\r\n    if (name.includes('disk') || name.includes('storage')) {\r\n      return <HardDrive className=\"h-4 w-4\" />;\r\n    }\r\n    if (name.includes('memory') || name.includes('ram')) {\r\n      return <MemoryStick className=\"h-4 w-4\" />;\r\n    }\r\n    if (name.includes('network') || name.includes('api')) {\r\n      return <Wifi className=\"h-4 w-4\" />;\r\n    }\r\n    return <Server className=\"h-4 w-4\" />;\r\n  };\r\n\r\n  if (error) {\r\n    return (\r\n      <Card className=\"border-red-200 bg-red-50 dark:border-red-900 dark:bg-red-950\">\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2 text-red-700 dark:text-red-400\">\r\n            <XCircle className=\"h-5 w-5\" />\r\n            Health Check Failed\r\n          </CardTitle>\r\n          <CardDescription className=\"text-red-600 dark:text-red-400\">\r\n            {error}\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <Button onClick={() => fetchHealth(true)} variant=\"outline\">\r\n            <RefreshCw className=\"mr-2 h-4 w-4\" />\r\n            Retry\r\n          </Button>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h2 className=\"text-2xl font-bold tracking-tight\">System Health</h2>\r\n          <p className=\"text-muted-foreground\">\r\n            Real-time monitoring of system components\r\n          </p>\r\n        </div>\r\n        <div className=\"flex items-center gap-4\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <input\r\n              type=\"checkbox\"\r\n              id=\"auto-refresh\"\r\n              checked={autoRefresh}\r\n              onChange={(e) => setAutoRefresh(e.target.checked)}\r\n              className=\"rounded border-gray-300\"\r\n            />\r\n            <label htmlFor=\"auto-refresh\" className=\"text-sm text-muted-foreground\">\r\n              Auto-refresh (30s)\r\n            </label>\r\n          </div>\r\n          <Button\r\n            onClick={() => fetchHealth(true)}\r\n            disabled={isLoading}\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n          >\r\n            <RefreshCw className={`mr-2 h-4 w-4 ${isLoading ? 'animate-spin' : ''}`} />\r\n            Refresh\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Overall Status */}\r\n      {health && (\r\n        <Card>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div className=\"flex items-center gap-4\">\r\n                {getStatusIcon(health.status)}\r\n                <div>\r\n                  <h3 className=\"font-semibold\">Overall System Status</h3>\r\n                  <p className=\"text-sm text-muted-foreground\">\r\n                    {health.hostname && `Host: ${health.hostname} · `}\r\n                    Last checked: {new Date(health.timestamp).toLocaleTimeString()}\r\n                  </p>\r\n                </div>\r\n              </div>\r\n              <div className=\"flex items-center gap-4\">\r\n                {getStatusBadge(health.status)}\r\n                <div className=\"text-right\">\r\n                  <p className=\"text-sm font-medium\">\r\n                    {health.totalLatencyMs.toFixed(0)}ms\r\n                  </p>\r\n                  <p className=\"text-xs text-muted-foreground\">Total Latency</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      {/* Component Health */}\r\n      <Tabs defaultValue=\"all\" className=\"space-y-4\">\r\n        <TabsList>\r\n          <TabsTrigger value=\"all\">All Components</TabsTrigger>\r\n          <TabsTrigger value=\"critical\">Critical</TabsTrigger>\r\n          <TabsTrigger value=\"issues\">Issues</TabsTrigger>\r\n        </TabsList>\r\n\r\n        <TabsContent value=\"all\" className=\"space-y-4\">\r\n          <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\r\n            {health?.checks.map((check) => (\r\n              <HealthCheckCard key={check.name} check={check} />\r\n            ))}\r\n          </div>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"critical\" className=\"space-y-4\">\r\n          <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\r\n            {health?.checks\r\n              .filter((c) => c.name.includes('database') || c.name.includes('redis'))\r\n              .map((check) => (\r\n                <HealthCheckCard key={check.name} check={check} />\r\n              ))}\r\n          </div>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"issues\" className=\"space-y-4\">\r\n          <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\r\n            {health?.checks\r\n              .filter((c) => c.status !== 'healthy')\r\n              .map((check) => (\r\n                <HealthCheckCard key={check.name} check={check} />\r\n              ))}\r\n            {health?.checks.every((c) => c.status === 'healthy') && (\r\n              <Card className=\"col-span-full\">\r\n                <CardContent className=\"pt-6 text-center\">\r\n                  <CheckCircle2 className=\"mx-auto h-12 w-12 text-green-500\" />\r\n                  <h3 className=\"mt-4 font-semibold\">All Systems Operational</h3>\r\n                  <p className=\"text-sm text-muted-foreground\">\r\n                    No issues detected\r\n                  </p>\r\n                </CardContent>\r\n              </Card>\r\n            )}\r\n          </div>\r\n        </TabsContent>\r\n      </Tabs>\r\n\r\n      {/* System Metrics */}\r\n      <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\r\n        <MetricCard\r\n          title=\"Response Time\"\r\n          value={`${health?.totalLatencyMs.toFixed(0) || '—'}ms`}\r\n          description=\"Average health check latency\"\r\n          icon={<Clock className=\"h-4 w-4\" />}\r\n        />\r\n        <MetricCard\r\n          title=\"Components\"\r\n          value={`${health?.checks.length || 0}`}\r\n          description=\"Total monitored components\"\r\n          icon={<Server className=\"h-4 w-4\" />}\r\n        />\r\n        <MetricCard\r\n          title=\"Healthy\"\r\n          value={`${health?.checks.filter((c) => c.status === 'healthy').length || 0}`}\r\n          description=\"Components operating normally\"\r\n          icon={<CheckCircle2 className=\"h-4 w-4 text-green-500\" />}\r\n        />\r\n        <MetricCard\r\n          title=\"Issues\"\r\n          value={`${health?.checks.filter((c) => c.status !== 'healthy').length || 0}`}\r\n          description=\"Components with issues\"\r\n          icon={<AlertTriangle className=\"h-4 w-4 text-yellow-500\" />}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// =============================================================================\r\n// Health Check Card\r\n// =============================================================================\r\n\r\nfunction HealthCheckCard({ check }: { check: HealthCheck }) {\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'healthy':\r\n        return 'border-green-200 bg-green-50 dark:border-green-900 dark:bg-green-950';\r\n      case 'degraded':\r\n        return 'border-yellow-200 bg-yellow-50 dark:border-yellow-900 dark:bg-yellow-950';\r\n      case 'unhealthy':\r\n        return 'border-red-200 bg-red-50 dark:border-red-900 dark:bg-red-950';\r\n      default:\r\n        return '';\r\n    }\r\n  };\r\n\r\n  const getComponentIcon = (name: string) => {\r\n    if (name.includes('database') || name.includes('postgres')) {\r\n      return <Database className=\"h-5 w-5\" />;\r\n    }\r\n    if (name.includes('redis') || name.includes('cache')) {\r\n      return <Server className=\"h-5 w-5\" />;\r\n    }\r\n    if (name.includes('celery') || name.includes('worker')) {\r\n      return <Activity className=\"h-5 w-5\" />;\r\n    }\r\n    if (name.includes('disk') || name.includes('storage')) {\r\n      return <HardDrive className=\"h-5 w-5\" />;\r\n    }\r\n    if (name.includes('memory') || name.includes('ram')) {\r\n      return <MemoryStick className=\"h-5 w-5\" />;\r\n    }\r\n    return <Server className=\"h-5 w-5\" />;\r\n  };\r\n\r\n  return (\r\n    <Card className={getStatusColor(check.status)}>\r\n      <CardHeader className=\"pb-2\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <div className=\"flex items-center gap-2\">\r\n            {getComponentIcon(check.name)}\r\n            <CardTitle className=\"text-base capitalize\">\r\n              {check.name.replace(/_/g, ' ')}\r\n            </CardTitle>\r\n          </div>\r\n          <Badge\r\n            variant={\r\n              check.status === 'healthy'\r\n                ? 'default'\r\n                : check.status === 'degraded'\r\n                ? 'secondary'\r\n                : 'destructive'\r\n            }\r\n            className=\"capitalize\"\r\n          >\r\n            {check.status}\r\n          </Badge>\r\n        </div>\r\n      </CardHeader>\r\n      <CardContent>\r\n        <p className=\"text-sm text-muted-foreground mb-3\">{check.message}</p>\r\n        \r\n        <div className=\"flex items-center justify-between text-sm\">\r\n          <span className=\"text-muted-foreground\">Latency</span>\r\n          <span className=\"font-mono\">{check.latencyMs.toFixed(2)}ms</span>\r\n        </div>\r\n\r\n        {check.details && Object.keys(check.details).length > 0 && (\r\n          <div className=\"mt-3 pt-3 border-t space-y-2\">\r\n            {Object.entries(check.details).map(([key, value]) => (\r\n              <div key={key} className=\"flex items-center justify-between text-sm\">\r\n                <span className=\"text-muted-foreground capitalize\">\r\n                  {key.replace(/_/g, ' ')}\r\n                </span>\r\n                <span className=\"font-mono\">\r\n                  {typeof value === 'number'\r\n                    ? value.toLocaleString()\r\n                    : String(value)}\r\n                </span>\r\n              </div>\r\n            ))}\r\n            \r\n            {check.details.utilization_percent !== undefined && (\r\n              <Progress\r\n                value={check.details.utilization_percent as number}\r\n                className=\"mt-2\"\r\n              />\r\n            )}\r\n            \r\n            {check.details.used_percent !== undefined && (\r\n              <Progress\r\n                value={check.details.used_percent as number}\r\n                className=\"mt-2\"\r\n              />\r\n            )}\r\n          </div>\r\n        )}\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n}\r\n\r\n// =============================================================================\r\n// Metric Card\r\n// =============================================================================\r\n\r\nfunction MetricCard({\r\n  title,\r\n  value,\r\n  description,\r\n  icon,\r\n}: {\r\n  title: string;\r\n  value: string;\r\n  description: string;\r\n  icon: React.ReactNode;\r\n}) {\r\n  return (\r\n    <Card>\r\n      <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n        <CardTitle className=\"text-sm font-medium\">{title}</CardTitle>\r\n        {icon}\r\n      </CardHeader>\r\n      <CardContent>\r\n        <div className=\"text-2xl font-bold\">{value}</div>\r\n        <p className=\"text-xs text-muted-foreground\">{description}</p>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n}\r\n\r\nexport default HealthDashboard;\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\enterprise\\LeadScoringDashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\enterprise\\NotificationCenter.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\enterprise\\PermissionManagement.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\enterprise\\RealtimeProvider.tsx","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`handleMessage` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nE:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\enterprise\\RealtimeProvider.tsx:119:11\n  117 |         try {\n  118 |           const message: RealtimeMessage = JSON.parse(event.data);\n> 119 |           handleMessage(message);\n      |           ^^^^^^^^^^^^^ `handleMessage` accessed before it is declared\n  120 |         } catch (error) {\n  121 |           console.error('[Realtime] Parse error:', error);\n  122 |         }\n\nE:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\enterprise\\RealtimeProvider.tsx:157:3\n  155 |\n  156 |   // Handle incoming messages\n> 157 |   const handleMessage = useCallback(\n      |   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 158 |     (message: RealtimeMessage) => {\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 159 |       const { type, channel, payload } = message;\n      …\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 198 |     [toast]\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 199 |   );\n      | ^^^^^ `handleMessage` is declared here\n  200 |\n  201 |   // Handle data updates from server\n  202 |   interface DataUpdatePayload {","line":119,"column":11,"nodeType":null,"endLine":119,"endColumn":24},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`connect` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nE:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\enterprise\\RealtimeProvider.tsx:143:11\n  141 |         setConnectionState('reconnecting');\n  142 |         reconnectTimeoutRef.current = setTimeout(() => {\n> 143 |           connect();\n      |           ^^^^^^^ `connect` accessed before it is declared\n  144 |         }, delay);\n  145 |       };\n  146 |\n\nE:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\enterprise\\RealtimeProvider.tsx:75:3\n   73 |\n   74 |   // Connect to WebSocket\n>  75 |   const connect = useCallback(() => {\n      |   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n>  76 |     const token = localStorage.getItem('auth_token');\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n>  77 |     if (!token) {\n      …\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 153 |     }\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 154 |   }, []);\n      | ^^^^^^^^^^ `connect` is declared here\n  155 |\n  156 |   // Handle incoming messages\n  157 |   const handleMessage = useCallback(","line":143,"column":11,"nodeType":null,"endLine":143,"endColumn":18},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'handleMessage'. Either include it or remove the dependency array.","line":154,"column":6,"nodeType":"ArrayExpression","endLine":154,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [handleMessage]","fix":{"range":[4564,4566],"text":"[handleMessage]"}}]},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`handleDataUpdate` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nE:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\enterprise\\RealtimeProvider.tsx:181:11\n  179 |         case 'data_update':\n  180 |           // Invalidate React Query cache\n> 181 |           handleDataUpdate(payload as DataUpdatePayload);\n      |           ^^^^^^^^^^^^^^^^ `handleDataUpdate` accessed before it is declared\n  182 |           break;\n  183 |\n  184 |         case 'notification':\n\nE:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\enterprise\\RealtimeProvider.tsx:208:3\n  206 |   }\n  207 |\n> 208 |   const handleDataUpdate = useCallback(\n      |   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 209 |     (payload: DataUpdatePayload) => {\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 210 |       const { entity, id, action } = payload;\n      …\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 233 |     [queryClient]\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 234 |   );\n      | ^^^^^ `handleDataUpdate` is declared here\n  235 |\n  236 |   // Subscribe to a channel\n  237 |   const subscribe = useCallback(","line":181,"column":11,"nodeType":null,"endLine":181,"endColumn":27},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'handleDataUpdate'. Either include it or remove the dependency array.","line":198,"column":5,"nodeType":"ArrayExpression","endLine":198,"endColumn":12,"suggestions":[{"desc":"Update the dependencies array to be: [handleDataUpdate, toast]","fix":{"range":[5847,5854],"text":"[handleDataUpdate, toast]"}}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'action' is assigned a value but never used.","line":210,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":210,"endColumn":33}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Real-Time Updates Provider\r\n * ===========================\r\n * \r\n * WebSocket-powered real-time data synchronization\r\n */\r\n\r\n'use client';\r\n\r\nimport React, {\r\n  createContext,\r\n  useCallback,\r\n  useContext,\r\n  useEffect,\r\n  useRef,\r\n  useState,\r\n} from 'react';\r\nimport { useQueryClient } from '@tanstack/react-query';\r\nimport { useToast } from '@/hooks/use-toast';\r\n\r\n// =============================================================================\r\n// Types\r\n// =============================================================================\r\n\r\ninterface RealtimeMessage {\r\n  type: string;\r\n  channel: string;\r\n  payload: unknown;\r\n  timestamp: string;\r\n}\r\n\r\ninterface PresenceUser {\r\n  id: string;\r\n  name: string;\r\n  avatar?: string;\r\n  status: 'online' | 'away' | 'busy' | 'offline';\r\n  lastSeen: Date;\r\n  currentPage?: string;\r\n}\r\n\r\ninterface RealtimeContextType {\r\n  isConnected: boolean;\r\n  connectionState: 'connecting' | 'connected' | 'disconnected' | 'reconnecting';\r\n  subscribe: (channel: string, callback: (data: unknown) => void) => () => void;\r\n  publish: (channel: string, data: unknown) => void;\r\n  presence: PresenceUser[];\r\n  setPresence: (status: PresenceUser['status'], currentPage?: string) => void;\r\n}\r\n\r\nconst RealtimeContext = createContext<RealtimeContextType | null>(null);\r\n\r\n// =============================================================================\r\n// Provider\r\n// =============================================================================\r\n\r\nexport function RealtimeProvider({ children }: { children: React.ReactNode }) {\r\n  const [isConnected, setIsConnected] = useState(false);\r\n  const [connectionState, setConnectionState] = useState<\r\n    'connecting' | 'connected' | 'disconnected' | 'reconnecting'\r\n  >('disconnected');\r\n  const [presence, setPresenceList] = useState<PresenceUser[]>([]);\r\n\r\n  const wsRef = useRef<WebSocket | null>(null);\r\n  const subscribersRef = useRef<Map<string, Set<(data: unknown) => void>>>(\r\n    new Map()\r\n  );\r\n  const reconnectTimeoutRef = useRef<NodeJS.Timeout | null>(null);\r\n  const reconnectAttemptsRef = useRef(0);\r\n  const heartbeatIntervalRef = useRef<NodeJS.Timeout | null>(null);\r\n\r\n  const queryClient = useQueryClient();\r\n  const { toast } = useToast();\r\n\r\n  // Connect to WebSocket\r\n  const connect = useCallback(() => {\r\n    const token = localStorage.getItem('auth_token');\r\n    if (!token) {\r\n      console.log('[Realtime] No auth token, skipping connection');\r\n      return;\r\n    }\r\n\r\n    const wsUrl = `${\r\n      process.env.NEXT_PUBLIC_WS_URL || 'ws://localhost:8000'\r\n    }/ws/realtime?token=${token}`;\r\n\r\n    setConnectionState('connecting');\r\n\r\n    try {\r\n      const ws = new WebSocket(wsUrl);\r\n      wsRef.current = ws;\r\n\r\n      ws.onopen = () => {\r\n        console.log('[Realtime] Connected');\r\n        setIsConnected(true);\r\n        setConnectionState('connected');\r\n        reconnectAttemptsRef.current = 0;\r\n\r\n        // Start heartbeat\r\n        heartbeatIntervalRef.current = setInterval(() => {\r\n          if (ws.readyState === WebSocket.OPEN) {\r\n            ws.send(JSON.stringify({ type: 'ping' }));\r\n          }\r\n        }, 30000);\r\n\r\n        // Subscribe to existing channels\r\n        subscribersRef.current.forEach((_, channel) => {\r\n          ws.send(\r\n            JSON.stringify({\r\n              type: 'subscribe',\r\n              channel,\r\n            })\r\n          );\r\n        });\r\n      };\r\n\r\n      ws.onmessage = (event) => {\r\n        try {\r\n          const message: RealtimeMessage = JSON.parse(event.data);\r\n          handleMessage(message);\r\n        } catch (error) {\r\n          console.error('[Realtime] Parse error:', error);\r\n        }\r\n      };\r\n\r\n      ws.onclose = () => {\r\n        console.log('[Realtime] Disconnected');\r\n        setIsConnected(false);\r\n        setConnectionState('disconnected');\r\n\r\n        if (heartbeatIntervalRef.current) {\r\n          clearInterval(heartbeatIntervalRef.current);\r\n        }\r\n\r\n        // Attempt reconnection with exponential backoff\r\n        const delay = Math.min(\r\n          1000 * Math.pow(2, reconnectAttemptsRef.current),\r\n          30000\r\n        );\r\n        reconnectAttemptsRef.current++;\r\n\r\n        setConnectionState('reconnecting');\r\n        reconnectTimeoutRef.current = setTimeout(() => {\r\n          connect();\r\n        }, delay);\r\n      };\r\n\r\n      ws.onerror = (error) => {\r\n        console.error('[Realtime] Error:', error);\r\n      };\r\n    } catch (error) {\r\n      console.error('[Realtime] Connection failed:', error);\r\n      setConnectionState('disconnected');\r\n    }\r\n  }, []);\r\n\r\n  // Handle incoming messages\r\n  const handleMessage = useCallback(\r\n    (message: RealtimeMessage) => {\r\n      const { type, channel, payload } = message;\r\n\r\n      switch (type) {\r\n        case 'pong':\r\n          // Heartbeat response\r\n          break;\r\n\r\n        case 'message':\r\n          // Dispatch to channel subscribers\r\n          const subscribers = subscribersRef.current.get(channel);\r\n          if (subscribers) {\r\n            subscribers.forEach((callback) => callback(payload));\r\n          }\r\n          break;\r\n\r\n        case 'presence':\r\n          // Update presence list\r\n          setPresenceList(payload as PresenceUser[]);\r\n          break;\r\n\r\n        case 'data_update':\r\n          // Invalidate React Query cache\r\n          handleDataUpdate(payload as DataUpdatePayload);\r\n          break;\r\n\r\n        case 'notification':\r\n          // Show toast notification\r\n          const notif = payload as { title: string; message: string; type?: string };\r\n          toast({\r\n            title: notif.title,\r\n            description: notif.message,\r\n            variant: notif.type === 'error' ? 'destructive' : 'default',\r\n          });\r\n          break;\r\n\r\n        default:\r\n          console.log('[Realtime] Unknown message type:', type);\r\n      }\r\n    },\r\n    [toast]\r\n  );\r\n\r\n  // Handle data updates from server\r\n  interface DataUpdatePayload {\r\n    entity: string;\r\n    id?: string;\r\n    action: 'create' | 'update' | 'delete';\r\n  }\r\n\r\n  const handleDataUpdate = useCallback(\r\n    (payload: DataUpdatePayload) => {\r\n      const { entity, id, action } = payload;\r\n\r\n      // Map entities to query keys\r\n      const queryKeyMap: Record<string, string[]> = {\r\n        lead: ['leads'],\r\n        contact: ['contacts'],\r\n        opportunity: ['opportunities'],\r\n        task: ['tasks'],\r\n        deal: ['deals'],\r\n        activity: ['activities'],\r\n      };\r\n\r\n      const queryKeys = queryKeyMap[entity];\r\n      if (queryKeys) {\r\n        // Invalidate list queries\r\n        queryClient.invalidateQueries({ queryKey: queryKeys });\r\n\r\n        // Invalidate specific entity query\r\n        if (id) {\r\n          queryClient.invalidateQueries({ queryKey: [...queryKeys, id] });\r\n        }\r\n      }\r\n    },\r\n    [queryClient]\r\n  );\r\n\r\n  // Subscribe to a channel\r\n  const subscribe = useCallback(\r\n    (channel: string, callback: (data: unknown) => void) => {\r\n      if (!subscribersRef.current.has(channel)) {\r\n        subscribersRef.current.set(channel, new Set());\r\n\r\n        // Send subscribe message if connected\r\n        if (wsRef.current?.readyState === WebSocket.OPEN) {\r\n          wsRef.current.send(\r\n            JSON.stringify({\r\n              type: 'subscribe',\r\n              channel,\r\n            })\r\n          );\r\n        }\r\n      }\r\n\r\n      subscribersRef.current.get(channel)!.add(callback);\r\n\r\n      // Return unsubscribe function\r\n      return () => {\r\n        const subscribers = subscribersRef.current.get(channel);\r\n        if (subscribers) {\r\n          subscribers.delete(callback);\r\n\r\n          // Unsubscribe from channel if no more listeners\r\n          if (subscribers.size === 0) {\r\n            subscribersRef.current.delete(channel);\r\n\r\n            if (wsRef.current?.readyState === WebSocket.OPEN) {\r\n              wsRef.current.send(\r\n                JSON.stringify({\r\n                  type: 'unsubscribe',\r\n                  channel,\r\n                })\r\n              );\r\n            }\r\n          }\r\n        }\r\n      };\r\n    },\r\n    []\r\n  );\r\n\r\n  // Publish to a channel\r\n  const publish = useCallback((channel: string, data: unknown) => {\r\n    if (wsRef.current?.readyState === WebSocket.OPEN) {\r\n      wsRef.current.send(\r\n        JSON.stringify({\r\n          type: 'message',\r\n          channel,\r\n          payload: data,\r\n        })\r\n      );\r\n    }\r\n  }, []);\r\n\r\n  // Set user presence\r\n  const setPresence = useCallback(\r\n    (status: PresenceUser['status'], currentPage?: string) => {\r\n      if (wsRef.current?.readyState === WebSocket.OPEN) {\r\n        wsRef.current.send(\r\n          JSON.stringify({\r\n            type: 'presence',\r\n            payload: { status, currentPage },\r\n          })\r\n        );\r\n      }\r\n    },\r\n    []\r\n  );\r\n\r\n  // Connect on mount\r\n  useEffect(() => {\r\n    connect();\r\n\r\n    return () => {\r\n      if (wsRef.current) {\r\n        wsRef.current.close();\r\n      }\r\n      if (reconnectTimeoutRef.current) {\r\n        clearTimeout(reconnectTimeoutRef.current);\r\n      }\r\n      if (heartbeatIntervalRef.current) {\r\n        clearInterval(heartbeatIntervalRef.current);\r\n      }\r\n    };\r\n  }, [connect]);\r\n\r\n  // Track page visibility for presence\r\n  useEffect(() => {\r\n    const handleVisibilityChange = () => {\r\n      if (document.hidden) {\r\n        setPresence('away');\r\n      } else {\r\n        setPresence('online', window.location.pathname);\r\n      }\r\n    };\r\n\r\n    document.addEventListener('visibilitychange', handleVisibilityChange);\r\n    return () => {\r\n      document.removeEventListener('visibilitychange', handleVisibilityChange);\r\n    };\r\n  }, [setPresence]);\r\n\r\n  return (\r\n    <RealtimeContext.Provider\r\n      value={{\r\n        isConnected,\r\n        connectionState,\r\n        subscribe,\r\n        publish,\r\n        presence,\r\n        setPresence,\r\n      }}\r\n    >\r\n      {children}\r\n    </RealtimeContext.Provider>\r\n  );\r\n}\r\n\r\n// =============================================================================\r\n// Hooks\r\n// =============================================================================\r\n\r\nexport function useRealtime() {\r\n  const context = useContext(RealtimeContext);\r\n  if (!context) {\r\n    throw new Error('useRealtime must be used within RealtimeProvider');\r\n  }\r\n  return context;\r\n}\r\n\r\nexport function useChannel<T = unknown>(\r\n  channel: string,\r\n  onMessage: (data: T) => void\r\n) {\r\n  const { subscribe } = useRealtime();\r\n\r\n  useEffect(() => {\r\n    const unsubscribe = subscribe(channel, onMessage as (data: unknown) => void);\r\n    return unsubscribe;\r\n  }, [channel, subscribe, onMessage]);\r\n}\r\n\r\nexport function usePresence() {\r\n  const { presence, setPresence } = useRealtime();\r\n  return { presence, setPresence };\r\n}\r\n\r\nexport function useConnectionStatus() {\r\n  const { isConnected, connectionState } = useRealtime();\r\n  return { isConnected, connectionState };\r\n}\r\n\r\n// =============================================================================\r\n// Collaborative Editing Hook\r\n// =============================================================================\r\n\r\ninterface CursorPosition {\r\n  userId: string;\r\n  userName: string;\r\n  color: string;\r\n  position: { x: number; y: number };\r\n  selection?: { start: number; end: number };\r\n}\r\n\r\nexport function useCollaborativeEditing(documentId: string) {\r\n  const { subscribe, publish } = useRealtime();\r\n  const [cursors, setCursors] = useState<Map<string, CursorPosition>>(new Map());\r\n\r\n  useEffect(() => {\r\n    const channel = `document:${documentId}`;\r\n\r\n    const unsubscribe = subscribe(channel, (data) => {\r\n      const cursorData = data as CursorPosition;\r\n      setCursors((prev) => {\r\n        const next = new Map(prev);\r\n        next.set(cursorData.userId, cursorData);\r\n        return next;\r\n      });\r\n    });\r\n\r\n    return unsubscribe;\r\n  }, [documentId, subscribe]);\r\n\r\n  const updateCursor = useCallback(\r\n    (position: { x: number; y: number }, selection?: { start: number; end: number }) => {\r\n      publish(`document:${documentId}`, {\r\n        type: 'cursor',\r\n        position,\r\n        selection,\r\n      });\r\n    },\r\n    [documentId, publish]\r\n  );\r\n\r\n  const publishChange = useCallback(\r\n    (change: unknown) => {\r\n      publish(`document:${documentId}`, {\r\n        type: 'change',\r\n        change,\r\n      });\r\n    },\r\n    [documentId, publish]\r\n  );\r\n\r\n  return {\r\n    cursors: Array.from(cursors.values()),\r\n    updateCursor,\r\n    publishChange,\r\n  };\r\n}\r\n\r\n// =============================================================================\r\n// Live Activity Feed Hook\r\n// =============================================================================\r\n\r\ninterface Activity {\r\n  id: string;\r\n  type: string;\r\n  user: {\r\n    id: string;\r\n    name: string;\r\n    avatar?: string;\r\n  };\r\n  action: string;\r\n  target: string;\r\n  timestamp: Date;\r\n  metadata?: Record<string, unknown>;\r\n}\r\n\r\nexport function useLiveActivityFeed(entityType?: string, entityId?: string) {\r\n  const { subscribe } = useRealtime();\r\n  const [activities, setActivities] = useState<Activity[]>([]);\r\n\r\n  useEffect(() => {\r\n    const channel = entityId\r\n      ? `activity:${entityType}:${entityId}`\r\n      : `activity:${entityType || 'global'}`;\r\n\r\n    const unsubscribe = subscribe(channel, (data) => {\r\n      const activity = data as Activity;\r\n      setActivities((prev) => [activity, ...prev].slice(0, 50));\r\n    });\r\n\r\n    return unsubscribe;\r\n  }, [entityType, entityId, subscribe]);\r\n\r\n  return activities;\r\n}\r\n\r\n// =============================================================================\r\n// Connection Status Indicator\r\n// =============================================================================\r\n\r\nexport function ConnectionIndicator() {\r\n  const { connectionState } = useConnectionStatus();\r\n\r\n  const statusConfig = {\r\n    connected: {\r\n      color: 'bg-green-500',\r\n      text: 'Connected',\r\n    },\r\n    connecting: {\r\n      color: 'bg-yellow-500',\r\n      text: 'Connecting...',\r\n    },\r\n    disconnected: {\r\n      color: 'bg-red-500',\r\n      text: 'Disconnected',\r\n    },\r\n    reconnecting: {\r\n      color: 'bg-yellow-500 animate-pulse',\r\n      text: 'Reconnecting...',\r\n    },\r\n  };\r\n\r\n  const config = statusConfig[connectionState];\r\n\r\n  return (\r\n    <div className=\"flex items-center gap-2 text-sm\">\r\n      <div className={`w-2 h-2 rounded-full ${config.color}`} />\r\n      <span className=\"text-muted-foreground\">{config.text}</span>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default RealtimeProvider;\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\enterprise\\SecurityDashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\enterprise\\WorkflowAutomation.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\enterprise\\WorkflowBuilder.tsx","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":25,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":25,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1184,1187],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1184,1187],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":33,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":33,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1326,1329],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1326,1329],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":321,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":321,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12096,12099],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12096,12099],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":343,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":343,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12872,12875],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12872,12875],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":529,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":529,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[19409,19412],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[19409,19412],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\enterprise\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\accordion.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\alert-dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\alert.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\animated\\AnimatedButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\animated\\AnimatedCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\animated\\PageTransition.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\aspect-ratio.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\avatar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\badge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\breadcrumb.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\calender.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\carousel.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\chart.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\checkbox.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\collapsible.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\command.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\context-menu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\data-table.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Filter' is defined but never used.","line":31,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":31,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MoreHorizontal' is defined but never used.","line":32,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":32,"endColumn":17},{"ruleId":"react-hooks/incompatible-library","severity":1,"message":"Compilation Skipped: Use of incompatible library\n\nThis API returns functions which cannot be memoized without leading to stale UI. To prevent this, by default React Compiler will skip memoizing this component/hook. However, you may see issues if values from this API are passed to other components/hooks that are memoized.\n\nE:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\data-table.tsx:147:17\n  145 |   const [globalFilter, setGlobalFilter] = React.useState('');\n  146 |\n> 147 |   const table = useReactTable({\n      |                 ^^^^^^^^^^^^^ TanStack Table's `useReactTable()` API returns functions that cannot be memoized safely\n  148 |     data,\n  149 |     columns,\n  150 |     onSortingChange: setSorting,","line":147,"column":17,"nodeType":null,"endLine":147,"endColumn":30}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * MyCRM DataTable Component\r\n *\r\n * A comprehensive, reusable data table with sorting, filtering,\r\n * pagination, selection, and customizable columns.\r\n */\r\n\r\n'use client';\r\n\r\nimport * as React from 'react';\r\nimport {\r\n  ColumnDef,\r\n  ColumnFiltersState,\r\n  SortingState,\r\n  VisibilityState,\r\n  flexRender,\r\n  getCoreRowModel,\r\n  getFilteredRowModel,\r\n  getPaginationRowModel,\r\n  getSortedRowModel,\r\n  useReactTable,\r\n} from '@tanstack/react-table';\r\nimport {\r\n  ArrowUpDown,\r\n  ChevronDown,\r\n  ChevronLeft,\r\n  ChevronRight,\r\n  ChevronsLeft,\r\n  ChevronsRight,\r\n  Download,\r\n  Filter,\r\n  MoreHorizontal,\r\n  Plus,\r\n  RefreshCw,\r\n  Search,\r\n  Settings2,\r\n  X,\r\n} from 'lucide-react';\r\n\r\nimport { cn } from '@/lib/utils';\r\n\r\n// ============================================================================\r\n// Types\r\n// ============================================================================\r\n\r\ninterface DataTableProps<TData, TValue> {\r\n  columns: ColumnDef<TData, TValue>[];\r\n  data: TData[];\r\n  isLoading?: boolean;\r\n  searchKey?: string;\r\n  searchPlaceholder?: string;\r\n  filterableColumns?: {\r\n    id: string;\r\n    title: string;\r\n    options: { label: string; value: string }[];\r\n  }[];\r\n  pagination?: {\r\n    pageIndex: number;\r\n    pageSize: number;\r\n    pageCount: number;\r\n    onPageChange: (page: number) => void;\r\n    onPageSizeChange: (size: number) => void;\r\n  };\r\n  onRowClick?: (row: TData) => void;\r\n  onSelectionChange?: (selectedRows: TData[]) => void;\r\n  onRefresh?: () => void;\r\n  onExport?: () => void;\r\n  onAdd?: () => void;\r\n  addButtonLabel?: string;\r\n  emptyState?: React.ReactNode;\r\n  className?: string;\r\n}\r\n\r\n// ============================================================================\r\n// Sub-components\r\n// ============================================================================\r\n\r\nfunction TableSkeleton({ columns }: { columns: number }) {\r\n  return (\r\n    <div className=\"space-y-3\">\r\n      {Array.from({ length: 5 }).map((_, i) => (\r\n        <div key={i} className=\"flex space-x-4\">\r\n          {Array.from({ length: columns }).map((_, j) => (\r\n            <div\r\n              key={j}\r\n              className=\"h-10 flex-1 animate-pulse rounded bg-gray-200 dark:bg-gray-700\"\r\n            />\r\n          ))}\r\n        </div>\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction EmptyState({ \r\n  title = 'No results found',\r\n  description = 'Try adjusting your search or filter to find what you\\'re looking for.',\r\n  action,\r\n}: {\r\n  title?: string;\r\n  description?: string;\r\n  action?: React.ReactNode;\r\n}) {\r\n  return (\r\n    <div className=\"flex flex-col items-center justify-center py-12 text-center\">\r\n      <div className=\"rounded-full bg-gray-100 p-3 dark:bg-gray-800\">\r\n        <Search className=\"h-6 w-6 text-gray-400\" />\r\n      </div>\r\n      <h3 className=\"mt-4 text-lg font-semibold text-gray-900 dark:text-gray-100\">\r\n        {title}\r\n      </h3>\r\n      <p className=\"mt-2 text-sm text-gray-500 dark:text-gray-400\">\r\n        {description}\r\n      </p>\r\n      {action && <div className=\"mt-6\">{action}</div>}\r\n    </div>\r\n  );\r\n}\r\n\r\n// ============================================================================\r\n// Main Component\r\n// ============================================================================\r\n\r\nexport function DataTable<TData, TValue>({\r\n  columns,\r\n  data,\r\n  isLoading = false,\r\n  searchKey,\r\n  searchPlaceholder = 'Search...',\r\n  filterableColumns = [],\r\n  pagination,\r\n  onRowClick,\r\n  onSelectionChange,\r\n  onRefresh,\r\n  onExport,\r\n  onAdd,\r\n  addButtonLabel = 'Add New',\r\n  emptyState,\r\n  className,\r\n}: DataTableProps<TData, TValue>) {\r\n  const [sorting, setSorting] = React.useState<SortingState>([]);\r\n  const [columnFilters, setColumnFilters] = React.useState<ColumnFiltersState>([]);\r\n  const [columnVisibility, setColumnVisibility] = React.useState<VisibilityState>({});\r\n  const [rowSelection, setRowSelection] = React.useState({});\r\n  const [globalFilter, setGlobalFilter] = React.useState('');\r\n\r\n  const table = useReactTable({\r\n    data,\r\n    columns,\r\n    onSortingChange: setSorting,\r\n    onColumnFiltersChange: setColumnFilters,\r\n    getCoreRowModel: getCoreRowModel(),\r\n    ...(pagination\r\n      ? {\r\n          manualPagination: true,\r\n          pageCount: pagination.pageCount,\r\n        }\r\n      : {\r\n          getPaginationRowModel: getPaginationRowModel(),\r\n        }),\r\n    getSortedRowModel: getSortedRowModel(),\r\n    getFilteredRowModel: getFilteredRowModel(),\r\n    onColumnVisibilityChange: setColumnVisibility,\r\n    onRowSelectionChange: setRowSelection,\r\n    onGlobalFilterChange: setGlobalFilter,\r\n    state: {\r\n      sorting,\r\n      columnFilters,\r\n      columnVisibility,\r\n      rowSelection,\r\n      globalFilter,\r\n      ...(pagination && {\r\n        pagination: {\r\n          pageIndex: pagination.pageIndex,\r\n          pageSize: pagination.pageSize,\r\n        },\r\n      }),\r\n    },\r\n  });\r\n\r\n  // Notify parent of selection changes\r\n  React.useEffect(() => {\r\n    if (onSelectionChange) {\r\n      const selectedRows = table\r\n        .getFilteredSelectedRowModel()\r\n        .rows.map((row) => row.original);\r\n      onSelectionChange(selectedRows);\r\n    }\r\n  }, [rowSelection, table, onSelectionChange]);\r\n\r\n  return (\r\n    <div className={cn('space-y-4', className)}>\r\n      {/* Toolbar */}\r\n      <div className=\"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between\">\r\n        {/* Search */}\r\n        <div className=\"flex flex-1 items-center gap-2\">\r\n          <div className=\"relative max-w-sm flex-1\">\r\n            <Search className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400\" />\r\n            <input\r\n              type=\"text\"\r\n              placeholder={searchPlaceholder}\r\n              value={searchKey \r\n                ? (table.getColumn(searchKey)?.getFilterValue() as string) ?? ''\r\n                : globalFilter\r\n              }\r\n              onChange={(e) => {\r\n                if (searchKey) {\r\n                  table.getColumn(searchKey)?.setFilterValue(e.target.value);\r\n                } else {\r\n                  setGlobalFilter(e.target.value);\r\n                }\r\n              }}\r\n              className=\"h-10 w-full rounded-md border border-gray-200 bg-white pl-10 pr-4 text-sm placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-100\"\r\n            />\r\n            {(globalFilter || (searchKey && !!table.getColumn(searchKey)?.getFilterValue())) && (\r\n              <button\r\n                onClick={() => {\r\n                  if (searchKey) {\r\n                    table.getColumn(searchKey)?.setFilterValue('');\r\n                  } else {\r\n                    setGlobalFilter('');\r\n                  }\r\n                }}\r\n                className=\"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600\"\r\n              >\r\n                <X className=\"h-4 w-4\" />\r\n              </button>\r\n            )}\r\n          </div>\r\n\r\n          {/* Filter dropdowns */}\r\n          {filterableColumns.map((column) => (\r\n            <select\r\n              key={column.id}\r\n              value={(table.getColumn(column.id)?.getFilterValue() as string) ?? ''}\r\n              onChange={(e) =>\r\n                table.getColumn(column.id)?.setFilterValue(e.target.value || undefined)\r\n              }\r\n              className=\"h-10 rounded-md border border-gray-200 bg-white px-3 text-sm dark:border-gray-700 dark:bg-gray-900\"\r\n            >\r\n              <option value=\"\">{column.title}</option>\r\n              {column.options.map((option) => (\r\n                <option key={option.value} value={option.value}>\r\n                  {option.label}\r\n                </option>\r\n              ))}\r\n            </select>\r\n          ))}\r\n        </div>\r\n\r\n        {/* Actions */}\r\n        <div className=\"flex items-center gap-2\">\r\n          {onRefresh && (\r\n            <button\r\n              onClick={onRefresh}\r\n              className=\"inline-flex h-10 items-center justify-center rounded-md border border-gray-200 bg-white px-3 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 dark:hover:bg-gray-800\"\r\n            >\r\n              <RefreshCw className=\"h-4 w-4\" />\r\n            </button>\r\n          )}\r\n\r\n          {onExport && (\r\n            <button\r\n              onClick={onExport}\r\n              className=\"inline-flex h-10 items-center justify-center rounded-md border border-gray-200 bg-white px-3 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 dark:hover:bg-gray-800\"\r\n            >\r\n              <Download className=\"mr-2 h-4 w-4\" />\r\n              Export\r\n            </button>\r\n          )}\r\n\r\n          {/* Column visibility */}\r\n          <div className=\"relative\">\r\n            <button\r\n              className=\"inline-flex h-10 items-center justify-center rounded-md border border-gray-200 bg-white px-3 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 dark:hover:bg-gray-800\"\r\n            >\r\n              <Settings2 className=\"mr-2 h-4 w-4\" />\r\n              Columns\r\n              <ChevronDown className=\"ml-2 h-4 w-4\" />\r\n            </button>\r\n          </div>\r\n\r\n          {onAdd && (\r\n            <button\r\n              onClick={onAdd}\r\n              className=\"inline-flex h-10 items-center justify-center rounded-md bg-blue-600 px-4 text-sm font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2\"\r\n            >\r\n              <Plus className=\"mr-2 h-4 w-4\" />\r\n              {addButtonLabel}\r\n            </button>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Selection info */}\r\n      {Object.keys(rowSelection).length > 0 && (\r\n        <div className=\"flex items-center gap-2 rounded-md bg-blue-50 px-4 py-2 text-sm text-blue-700 dark:bg-blue-900/20 dark:text-blue-400\">\r\n          <span>\r\n            {Object.keys(rowSelection).length} of {data.length} row(s) selected\r\n          </span>\r\n          <button\r\n            onClick={() => setRowSelection({})}\r\n            className=\"ml-auto text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\r\n          >\r\n            Clear selection\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {/* Table */}\r\n      <div className=\"overflow-hidden rounded-lg border border-gray-200 dark:border-gray-700\">\r\n        <div className=\"overflow-x-auto\">\r\n          <table className=\"w-full\">\r\n            <thead className=\"bg-gray-50 dark:bg-gray-800\">\r\n              {table.getHeaderGroups().map((headerGroup) => (\r\n                <tr key={headerGroup.id}>\r\n                  {headerGroup.headers.map((header) => (\r\n                    <th\r\n                      key={header.id}\r\n                      className=\"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400\"\r\n                      style={{ width: header.getSize() }}\r\n                    >\r\n                      {header.isPlaceholder ? null : (\r\n                        <div\r\n                          className={cn(\r\n                            'flex items-center gap-2',\r\n                            header.column.getCanSort() &&\r\n                              'cursor-pointer select-none hover:text-gray-700 dark:hover:text-gray-200'\r\n                          )}\r\n                          onClick={header.column.getToggleSortingHandler()}\r\n                        >\r\n                          {flexRender(\r\n                            header.column.columnDef.header,\r\n                            header.getContext()\r\n                          )}\r\n                          {header.column.getCanSort() && (\r\n                            <ArrowUpDown className=\"h-4 w-4\" />\r\n                          )}\r\n                        </div>\r\n                      )}\r\n                    </th>\r\n                  ))}\r\n                </tr>\r\n              ))}\r\n            </thead>\r\n            <tbody className=\"divide-y divide-gray-200 bg-white dark:divide-gray-700 dark:bg-gray-900\">\r\n              {isLoading ? (\r\n                <tr>\r\n                  <td colSpan={columns.length} className=\"px-4 py-8\">\r\n                    <TableSkeleton columns={columns.length} />\r\n                  </td>\r\n                </tr>\r\n              ) : table.getRowModel().rows?.length ? (\r\n                table.getRowModel().rows.map((row) => (\r\n                  <tr\r\n                    key={row.id}\r\n                    data-state={row.getIsSelected() && 'selected'}\r\n                    className={cn(\r\n                      'transition-colors hover:bg-gray-50 dark:hover:bg-gray-800',\r\n                      row.getIsSelected() && 'bg-blue-50 dark:bg-blue-900/20',\r\n                      onRowClick && 'cursor-pointer'\r\n                    )}\r\n                    onClick={() => onRowClick?.(row.original)}\r\n                  >\r\n                    {row.getVisibleCells().map((cell) => (\r\n                      <td\r\n                        key={cell.id}\r\n                        className=\"whitespace-nowrap px-4 py-3 text-sm text-gray-900 dark:text-gray-100\"\r\n                      >\r\n                        {flexRender(\r\n                          cell.column.columnDef.cell,\r\n                          cell.getContext()\r\n                        )}\r\n                      </td>\r\n                    ))}\r\n                  </tr>\r\n                ))\r\n              ) : (\r\n                <tr>\r\n                  <td colSpan={columns.length} className=\"px-4 py-8\">\r\n                    {emptyState || <EmptyState />}\r\n                  </td>\r\n                </tr>\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Pagination */}\r\n      <div className=\"flex items-center justify-between px-2\">\r\n        <div className=\"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400\">\r\n          <span>Rows per page:</span>\r\n          <select\r\n            value={pagination?.pageSize ?? table.getState().pagination.pageSize}\r\n            onChange={(e) => {\r\n              const size = Number(e.target.value);\r\n              if (pagination) {\r\n                pagination.onPageSizeChange(size);\r\n              } else {\r\n                table.setPageSize(size);\r\n              }\r\n            }}\r\n            className=\"h-8 rounded-md border border-gray-200 bg-white px-2 text-sm dark:border-gray-700 dark:bg-gray-900\"\r\n          >\r\n            {[10, 20, 30, 40, 50].map((pageSize) => (\r\n              <option key={pageSize} value={pageSize}>\r\n                {pageSize}\r\n              </option>\r\n            ))}\r\n          </select>\r\n        </div>\r\n\r\n        <div className=\"flex items-center gap-2\">\r\n          <span className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n            Page {(pagination?.pageIndex ?? table.getState().pagination.pageIndex) + 1} of{' '}\r\n            {pagination?.pageCount ?? table.getPageCount()}\r\n          </span>\r\n\r\n          <div className=\"flex items-center gap-1\">\r\n            <button\r\n              onClick={() => {\r\n                if (pagination) {\r\n                  pagination.onPageChange(0);\r\n                } else {\r\n                  table.setPageIndex(0);\r\n                }\r\n              }}\r\n              disabled={\r\n                pagination\r\n                  ? pagination.pageIndex === 0\r\n                  : !table.getCanPreviousPage()\r\n              }\r\n              className=\"inline-flex h-8 w-8 items-center justify-center rounded-md border border-gray-200 bg-white text-gray-500 hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-700 dark:bg-gray-900\"\r\n            >\r\n              <ChevronsLeft className=\"h-4 w-4\" />\r\n            </button>\r\n            <button\r\n              onClick={() => {\r\n                if (pagination) {\r\n                  pagination.onPageChange(pagination.pageIndex - 1);\r\n                } else {\r\n                  table.previousPage();\r\n                }\r\n              }}\r\n              disabled={\r\n                pagination\r\n                  ? pagination.pageIndex === 0\r\n                  : !table.getCanPreviousPage()\r\n              }\r\n              className=\"inline-flex h-8 w-8 items-center justify-center rounded-md border border-gray-200 bg-white text-gray-500 hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-700 dark:bg-gray-900\"\r\n            >\r\n              <ChevronLeft className=\"h-4 w-4\" />\r\n            </button>\r\n            <button\r\n              onClick={() => {\r\n                if (pagination) {\r\n                  pagination.onPageChange(pagination.pageIndex + 1);\r\n                } else {\r\n                  table.nextPage();\r\n                }\r\n              }}\r\n              disabled={\r\n                pagination\r\n                  ? pagination.pageIndex >= pagination.pageCount - 1\r\n                  : !table.getCanNextPage()\r\n              }\r\n              className=\"inline-flex h-8 w-8 items-center justify-center rounded-md border border-gray-200 bg-white text-gray-500 hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-700 dark:bg-gray-900\"\r\n            >\r\n              <ChevronRight className=\"h-4 w-4\" />\r\n            </button>\r\n            <button\r\n              onClick={() => {\r\n                const lastPage = pagination\r\n                  ? pagination.pageCount - 1\r\n                  : table.getPageCount() - 1;\r\n                if (pagination) {\r\n                  pagination.onPageChange(lastPage);\r\n                } else {\r\n                  table.setPageIndex(lastPage);\r\n                }\r\n              }}\r\n              disabled={\r\n                pagination\r\n                  ? pagination.pageIndex >= pagination.pageCount - 1\r\n                  : !table.getCanNextPage()\r\n              }\r\n              className=\"inline-flex h-8 w-8 items-center justify-center rounded-md border border-gray-200 bg-white text-gray-500 hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-700 dark:bg-gray-900\"\r\n            >\r\n              <ChevronsRight className=\"h-4 w-4\" />\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default DataTable;\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\drawer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\dropdown-menu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\form.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\hover-card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\input-otp.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\input.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\kanban-board.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'arrayMove' is defined but never used.","line":25,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":25,"endColumn":12},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":189,"column":15,"nodeType":"JSXOpeningElement","endLine":193,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * MyCRM Kanban Board Component\r\n *\r\n * A drag-and-drop Kanban board for managing opportunities across pipeline stages.\r\n * Uses @dnd-kit for accessible drag-and-drop functionality.\r\n */\r\n\r\n'use client';\r\n\r\nimport * as React from 'react';\r\nimport {\r\n  DndContext,\r\n  DragEndEvent,\r\n  DragOverEvent,\r\n  DragOverlay,\r\n  DragStartEvent,\r\n  KeyboardSensor,\r\n  PointerSensor,\r\n  closestCorners,\r\n  useSensor,\r\n  useSensors,\r\n} from '@dnd-kit/core';\r\nimport {\r\n  SortableContext,\r\n  arrayMove,\r\n  sortableKeyboardCoordinates,\r\n  useSortable,\r\n  verticalListSortingStrategy,\r\n} from '@dnd-kit/sortable';\r\nimport { CSS } from '@dnd-kit/utilities';\r\nimport {\r\n  Building2,\r\n  Calendar,\r\n  DollarSign,\r\n  GripVertical,\r\n  MoreHorizontal,\r\n  Plus,\r\n  User,\r\n} from 'lucide-react';\r\n\r\nimport { cn, formatCurrency, formatDate } from '@/lib/utils';\r\nimport type { Opportunity, PipelineStage } from '@/types';\r\n\r\n// ============================================================================\r\n// Types\r\n// ============================================================================\r\n\r\ninterface KanbanBoardProps {\r\n  stages: PipelineStage[];\r\n  opportunities: Opportunity[];\r\n  onMoveOpportunity: (\r\n    opportunityId: string,\r\n    sourceStageId: string,\r\n    targetStageId: string\r\n  ) => void;\r\n  onOpportunityClick?: (opportunity: Opportunity) => void;\r\n  onAddOpportunity?: (stageId: string) => void;\r\n  isLoading?: boolean;\r\n  className?: string;\r\n}\r\n\r\ninterface KanbanColumnProps {\r\n  stage: PipelineStage;\r\n  opportunities: Opportunity[];\r\n  onOpportunityClick?: (opportunity: Opportunity) => void;\r\n  onAddOpportunity?: () => void;\r\n}\r\n\r\ninterface KanbanCardProps {\r\n  opportunity: Opportunity;\r\n  onClick?: () => void;\r\n  isDragging?: boolean;\r\n}\r\n\r\n// ============================================================================\r\n// Kanban Card Component\r\n// ============================================================================\r\n\r\nfunction KanbanCard({ opportunity, onClick, isDragging }: KanbanCardProps) {\r\n  const {\r\n    attributes,\r\n    listeners,\r\n    setNodeRef,\r\n    transform,\r\n    transition,\r\n    isDragging: isSortableDragging,\r\n  } = useSortable({\r\n    id: opportunity.id,\r\n    data: {\r\n      type: 'opportunity',\r\n      opportunity,\r\n    },\r\n  });\r\n\r\n  const style = {\r\n    transform: CSS.Transform.toString(transform),\r\n    transition,\r\n  };\r\n\r\n  const isCurrentlyDragging = isDragging || isSortableDragging;\r\n\r\n  return (\r\n    <div\r\n      ref={setNodeRef}\r\n      style={style}\r\n      className={cn(\r\n        'group cursor-pointer rounded-lg border border-gray-200 bg-white p-4 shadow-sm transition-all hover:shadow-md dark:border-gray-700 dark:bg-gray-800',\r\n        isCurrentlyDragging && 'opacity-50 shadow-lg ring-2 ring-blue-500'\r\n      )}\r\n      onClick={onClick}\r\n    >\r\n      {/* Drag Handle & Actions */}\r\n      <div className=\"mb-3 flex items-center justify-between\">\r\n        <button\r\n          className=\"cursor-grab touch-none rounded p-1 text-gray-400 hover:bg-gray-100 hover:text-gray-600 active:cursor-grabbing dark:hover:bg-gray-700\"\r\n          {...attributes}\r\n          {...listeners}\r\n        >\r\n          <GripVertical className=\"h-4 w-4\" />\r\n        </button>\r\n        <button\r\n          className=\"rounded p-1 text-gray-400 opacity-0 hover:bg-gray-100 hover:text-gray-600 group-hover:opacity-100 dark:hover:bg-gray-700\"\r\n          onClick={(e) => {\r\n            e.stopPropagation();\r\n            // Open actions menu\r\n          }}\r\n        >\r\n          <MoreHorizontal className=\"h-4 w-4\" />\r\n        </button>\r\n      </div>\r\n\r\n      {/* Opportunity Name */}\r\n      <h4 className=\"mb-2 font-medium text-gray-900 dark:text-gray-100\">\r\n        {opportunity.name}\r\n      </h4>\r\n\r\n      {/* Company */}\r\n      {opportunity.company && (\r\n        <div className=\"mb-2 flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400\">\r\n          <Building2 className=\"h-4 w-4\" />\r\n          <span className=\"truncate\">{opportunity.company.name}</span>\r\n        </div>\r\n      )}\r\n\r\n      {/* Contact */}\r\n      {opportunity.contact && (\r\n        <div className=\"mb-2 flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400\">\r\n          <User className=\"h-4 w-4\" />\r\n          <span className=\"truncate\">{opportunity.contact.full_name}</span>\r\n        </div>\r\n      )}\r\n\r\n      {/* Value */}\r\n      <div className=\"mb-2 flex items-center gap-2 text-sm font-semibold text-green-600 dark:text-green-400\">\r\n        <DollarSign className=\"h-4 w-4\" />\r\n        <span>{formatCurrency(opportunity.value, opportunity.currency)}</span>\r\n      </div>\r\n\r\n      {/* Close Date */}\r\n      {opportunity.expected_close_date && (\r\n        <div className=\"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400\">\r\n          <Calendar className=\"h-4 w-4\" />\r\n          <span>{formatDate(opportunity.expected_close_date)}</span>\r\n        </div>\r\n      )}\r\n\r\n      {/* Probability Badge */}\r\n      <div className=\"mt-3 flex items-center justify-between\">\r\n        <span\r\n          className={cn(\r\n            'inline-flex items-center rounded-full px-2 py-1 text-xs font-medium',\r\n            opportunity.probability >= 0.7\r\n              ? 'bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400'\r\n              : opportunity.probability >= 0.4\r\n              ? 'bg-yellow-100 text-yellow-700 dark:bg-yellow-900/20 dark:text-yellow-400'\r\n              : 'bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300'\r\n          )}\r\n        >\r\n          {Math.round(opportunity.probability * 100)}% likely\r\n        </span>\r\n\r\n        {/* Owner Avatar */}\r\n        {opportunity.owner && (\r\n          <div\r\n            className=\"h-6 w-6 overflow-hidden rounded-full bg-blue-500\"\r\n            title={opportunity.owner.full_name}\r\n          >\r\n            {opportunity.owner.avatar_url ? (\r\n              <img\r\n                src={opportunity.owner.avatar_url}\r\n                alt={opportunity.owner.full_name}\r\n                className=\"h-full w-full object-cover\"\r\n              />\r\n            ) : (\r\n              <span className=\"flex h-full w-full items-center justify-center text-xs font-medium text-white\">\r\n                {opportunity.owner.first_name?.[0]}\r\n                {opportunity.owner.last_name?.[0]}\r\n              </span>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// ============================================================================\r\n// Kanban Column Component\r\n// ============================================================================\r\n\r\nfunction KanbanColumn({\r\n  stage,\r\n  opportunities,\r\n  onOpportunityClick,\r\n  onAddOpportunity,\r\n}: KanbanColumnProps) {\r\n  const totalValue = opportunities.reduce((sum, opp) => sum + opp.value, 0);\r\n\r\n  return (\r\n    <div className=\"flex h-full w-80 flex-shrink-0 flex-col rounded-lg bg-gray-50 dark:bg-gray-900\">\r\n      {/* Column Header */}\r\n      <div\r\n        className=\"sticky top-0 z-10 rounded-t-lg border-b border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-900\"\r\n        style={{ borderTopColor: stage.color, borderTopWidth: '3px' }}\r\n      >\r\n        <div className=\"flex items-center justify-between\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <h3 className=\"font-semibold text-gray-900 dark:text-gray-100\">\r\n              {stage.name}\r\n            </h3>\r\n            <span className=\"inline-flex h-5 min-w-5 items-center justify-center rounded-full bg-gray-200 px-1.5 text-xs font-medium text-gray-700 dark:bg-gray-700 dark:text-gray-300\">\r\n              {opportunities.length}\r\n            </span>\r\n          </div>\r\n          {onAddOpportunity && (\r\n            <button\r\n              onClick={onAddOpportunity}\r\n              className=\"rounded p-1 text-gray-400 hover:bg-gray-200 hover:text-gray-600 dark:hover:bg-gray-700\"\r\n            >\r\n              <Plus className=\"h-4 w-4\" />\r\n            </button>\r\n          )}\r\n        </div>\r\n        <div className=\"mt-1 text-sm text-gray-500 dark:text-gray-400\">\r\n          {formatCurrency(totalValue)} • {stage.probability}% probability\r\n        </div>\r\n      </div>\r\n\r\n      {/* Column Content */}\r\n      <div className=\"flex-1 overflow-y-auto p-2\">\r\n        <SortableContext\r\n          items={opportunities.map((o) => o.id)}\r\n          strategy={verticalListSortingStrategy}\r\n        >\r\n          <div className=\"space-y-3\">\r\n            {opportunities.map((opportunity) => (\r\n              <KanbanCard\r\n                key={opportunity.id}\r\n                opportunity={opportunity}\r\n                onClick={() => onOpportunityClick?.(opportunity)}\r\n              />\r\n            ))}\r\n          </div>\r\n        </SortableContext>\r\n\r\n        {opportunities.length === 0 && (\r\n          <div className=\"flex flex-col items-center justify-center py-8 text-center\">\r\n            <p className=\"text-sm text-gray-400\">No opportunities</p>\r\n            {onAddOpportunity && (\r\n              <button\r\n                onClick={onAddOpportunity}\r\n                className=\"mt-2 text-sm text-blue-500 hover:text-blue-600\"\r\n              >\r\n                + Add opportunity\r\n              </button>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// ============================================================================\r\n// Kanban Board Component\r\n// ============================================================================\r\n\r\nexport function KanbanBoard({\r\n  stages,\r\n  opportunities,\r\n  onMoveOpportunity,\r\n  onOpportunityClick,\r\n  onAddOpportunity,\r\n  isLoading = false,\r\n  className,\r\n}: KanbanBoardProps) {\r\n  const [activeOpportunity, setActiveOpportunity] = React.useState<Opportunity | null>(null);\r\n  const [localOpportunities, setLocalOpportunities] = React.useState(opportunities);\r\n\r\n  // Update local state when props change\r\n  React.useEffect(() => {\r\n    setLocalOpportunities(opportunities);\r\n  }, [opportunities]);\r\n\r\n  // Group opportunities by stage\r\n  const opportunitiesByStage = React.useMemo(() => {\r\n    const grouped: Record<string, Opportunity[]> = {};\r\n    stages.forEach((stage) => {\r\n      grouped[stage.id] = localOpportunities.filter(\r\n        (opp) => opp.stage_id === stage.id\r\n      );\r\n    });\r\n    return grouped;\r\n  }, [stages, localOpportunities]);\r\n\r\n  // DnD Sensors\r\n  const sensors = useSensors(\r\n    useSensor(PointerSensor, {\r\n      activationConstraint: {\r\n        distance: 8,\r\n      },\r\n    }),\r\n    useSensor(KeyboardSensor, {\r\n      coordinateGetter: sortableKeyboardCoordinates,\r\n    })\r\n  );\r\n\r\n  // Handle drag start\r\n  const handleDragStart = (event: DragStartEvent) => {\r\n    const { active } = event;\r\n    const opportunity = localOpportunities.find((o) => o.id === active.id);\r\n    if (opportunity) {\r\n      setActiveOpportunity(opportunity);\r\n    }\r\n  };\r\n\r\n  // Handle drag over (for moving between columns)\r\n  const handleDragOver = (event: DragOverEvent) => {\r\n    const { active, over } = event;\r\n    if (!over) return;\r\n\r\n    const activeId = active.id as string;\r\n    const overId = over.id as string;\r\n\r\n    // Find the active opportunity\r\n    const activeOpportunity = localOpportunities.find((o) => o.id === activeId);\r\n    if (!activeOpportunity) return;\r\n\r\n    // Find target stage (could be dropping on another card or on a stage)\r\n    let targetStageId: string | null = null;\r\n\r\n    // Check if dropping on a stage\r\n    const targetStage = stages.find((s) => s.id === overId);\r\n    if (targetStage) {\r\n      targetStageId = targetStage.id;\r\n    } else {\r\n      // Check if dropping on another opportunity\r\n      const overOpportunity = localOpportunities.find((o) => o.id === overId);\r\n      if (overOpportunity) {\r\n        targetStageId = overOpportunity.stage_id;\r\n      }\r\n    }\r\n\r\n    // Update local state for immediate feedback\r\n    if (targetStageId && activeOpportunity.stage_id !== targetStageId) {\r\n      setLocalOpportunities((prev) =>\r\n        prev.map((opp) =>\r\n          opp.id === activeId ? { ...opp, stage_id: targetStageId! } : opp\r\n        )\r\n      );\r\n    }\r\n  };\r\n\r\n  // Handle drag end\r\n  const handleDragEnd = (event: DragEndEvent) => {\r\n    const { active, over } = event;\r\n    setActiveOpportunity(null);\r\n\r\n    if (!over) {\r\n      // Reset to original state if dropped outside\r\n      setLocalOpportunities(opportunities);\r\n      return;\r\n    }\r\n\r\n    const activeId = active.id as string;\r\n    const activeOpportunity = localOpportunities.find((o) => o.id === activeId);\r\n    const originalOpportunity = opportunities.find((o) => o.id === activeId);\r\n\r\n    if (!activeOpportunity || !originalOpportunity) return;\r\n\r\n    // Only trigger callback if stage actually changed\r\n    if (activeOpportunity.stage_id !== originalOpportunity.stage_id) {\r\n      onMoveOpportunity(\r\n        activeId,\r\n        originalOpportunity.stage_id,\r\n        activeOpportunity.stage_id\r\n      );\r\n    }\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className={cn('flex gap-4 overflow-x-auto p-4', className)}>\r\n        {stages.map((stage) => (\r\n          <div\r\n            key={stage.id}\r\n            className=\"h-[600px] w-80 flex-shrink-0 animate-pulse rounded-lg bg-gray-100 dark:bg-gray-800\"\r\n          />\r\n        ))}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <DndContext\r\n      sensors={sensors}\r\n      collisionDetection={closestCorners}\r\n      onDragStart={handleDragStart}\r\n      onDragOver={handleDragOver}\r\n      onDragEnd={handleDragEnd}\r\n    >\r\n      <div className={cn('flex gap-4 overflow-x-auto p-4', className)}>\r\n        {stages.map((stage) => (\r\n          <KanbanColumn\r\n            key={stage.id}\r\n            stage={stage}\r\n            opportunities={opportunitiesByStage[stage.id] || []}\r\n            onOpportunityClick={onOpportunityClick}\r\n            onAddOpportunity={\r\n              onAddOpportunity ? () => onAddOpportunity(stage.id) : undefined\r\n            }\r\n          />\r\n        ))}\r\n      </div>\r\n\r\n      {/* Drag Overlay */}\r\n      <DragOverlay dropAnimation={null}>\r\n        {activeOpportunity && (\r\n          <KanbanCard opportunity={activeOpportunity} isDragging />\r\n        )}\r\n      </DragOverlay>\r\n    </DndContext>\r\n  );\r\n}\r\n\r\nexport default KanbanBoard;\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\label.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\menubar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\navigation-menu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\pagination.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\popover.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\progress.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\radio-group.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\resizable.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\scroll-area.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\select.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\separator.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\sheet.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\sidebar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\skeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\slider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\sooner.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\switch.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\table.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\tabs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\tag-input.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\textarea.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\toast.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\toaster.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\toggle-group.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\toggle.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\tooltip.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\components\\ui\\use-toast.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\constants\\badge_variant.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\constants\\button_variant.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\constants\\form-context.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\constants\\metadata.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\constants\\nav-menu.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\constants\\sonner-utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\constants\\toggle-variant.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\contexts\\AuthContext.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\hooks\\use-api.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\hooks\\use-enterprise.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\hooks\\use-mobile.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\hooks\\use-toast.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\hooks\\useAnimations.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\hooks\\useApi.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'QueryKey' is defined but never used.","line":15,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ContactFilters' is defined but never used.","line":23,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":23,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * MyCRM React Query Hooks\r\n *\r\n * Comprehensive data fetching hooks using TanStack React Query.\r\n * Provides caching, optimistic updates, and error handling.\r\n */\r\n\r\nimport {\r\n  useQuery,\r\n  useMutation,\r\n  useQueryClient,\r\n  useInfiniteQuery,\r\n  UseQueryOptions,\r\n  UseMutationOptions,\r\n  QueryKey,\r\n} from '@tanstack/react-query';\r\nimport { toast } from 'sonner';\r\nimport api from '@/lib/api';\r\nimport type {\r\n  Contact,\r\n  ContactCreatePayload,\r\n  ContactUpdatePayload,\r\n  ContactFilters,\r\n  Lead,\r\n  LeadConvertPayload,\r\n  Opportunity,\r\n  OpportunityCreatePayload,\r\n  OpportunityMovePayload,\r\n  Task,\r\n  TaskCreatePayload,\r\n  Pipeline,\r\n  PipelineStage,\r\n  DashboardMetrics,\r\n  PaginatedResponse,\r\n  SearchParams,\r\n  User,\r\n  Team,\r\n} from '@/types';\r\n\r\n// ============================================================================\r\n// Query Keys Factory\r\n// ============================================================================\r\n\r\nexport const queryKeys = {\r\n  // Contacts\r\n  contacts: {\r\n    all: ['contacts'] as const,\r\n    lists: () => [...queryKeys.contacts.all, 'list'] as const,\r\n    list: (params: SearchParams) => [...queryKeys.contacts.lists(), params] as const,\r\n    details: () => [...queryKeys.contacts.all, 'detail'] as const,\r\n    detail: (id: string) => [...queryKeys.contacts.details(), id] as const,\r\n    analytics: () => [...queryKeys.contacts.all, 'analytics'] as const,\r\n  },\r\n\r\n  // Leads\r\n  leads: {\r\n    all: ['leads'] as const,\r\n    lists: () => [...queryKeys.leads.all, 'list'] as const,\r\n    list: (params: SearchParams) => [...queryKeys.leads.lists(), params] as const,\r\n    details: () => [...queryKeys.leads.all, 'detail'] as const,\r\n    detail: (id: string) => [...queryKeys.leads.details(), id] as const,\r\n    analytics: () => [...queryKeys.leads.all, 'analytics'] as const,\r\n  },\r\n\r\n  // Opportunities\r\n  opportunities: {\r\n    all: ['opportunities'] as const,\r\n    lists: () => [...queryKeys.opportunities.all, 'list'] as const,\r\n    list: (params: SearchParams) => [...queryKeys.opportunities.lists(), params] as const,\r\n    details: () => [...queryKeys.opportunities.all, 'detail'] as const,\r\n    detail: (id: string) => [...queryKeys.opportunities.details(), id] as const,\r\n    byPipeline: (pipelineId: string) => [...queryKeys.opportunities.all, 'pipeline', pipelineId] as const,\r\n  },\r\n\r\n  // Pipelines\r\n  pipelines: {\r\n    all: ['pipelines'] as const,\r\n    lists: () => [...queryKeys.pipelines.all, 'list'] as const,\r\n    detail: (id: string) => [...queryKeys.pipelines.all, 'detail', id] as const,\r\n    stages: (pipelineId: string) => [...queryKeys.pipelines.all, pipelineId, 'stages'] as const,\r\n  },\r\n\r\n  // Tasks\r\n  tasks: {\r\n    all: ['tasks'] as const,\r\n    lists: () => [...queryKeys.tasks.all, 'list'] as const,\r\n    list: (params: SearchParams) => [...queryKeys.tasks.lists(), params] as const,\r\n    details: () => [...queryKeys.tasks.all, 'detail'] as const,\r\n    detail: (id: string) => [...queryKeys.tasks.details(), id] as const,\r\n    myTasks: () => [...queryKeys.tasks.all, 'my'] as const,\r\n    overdue: () => [...queryKeys.tasks.all, 'overdue'] as const,\r\n  },\r\n\r\n  // Dashboard\r\n  dashboard: {\r\n    all: ['dashboard'] as const,\r\n    metrics: () => [...queryKeys.dashboard.all, 'metrics'] as const,\r\n    activities: () => [...queryKeys.dashboard.all, 'activities'] as const,\r\n    performance: () => [...queryKeys.dashboard.all, 'performance'] as const,\r\n  },\r\n\r\n  // Users & Teams\r\n  users: {\r\n    all: ['users'] as const,\r\n    list: () => [...queryKeys.users.all, 'list'] as const,\r\n    detail: (id: string) => [...queryKeys.users.all, 'detail', id] as const,\r\n    me: () => [...queryKeys.users.all, 'me'] as const,\r\n  },\r\n  teams: {\r\n    all: ['teams'] as const,\r\n    list: () => [...queryKeys.teams.all, 'list'] as const,\r\n    detail: (id: string) => [...queryKeys.teams.all, 'detail', id] as const,\r\n  },\r\n} as const;\r\n\r\n// ============================================================================\r\n// Contact Hooks\r\n// ============================================================================\r\n\r\nexport function useContacts(params: SearchParams = {}) {\r\n  return useQuery({\r\n    queryKey: queryKeys.contacts.list(params),\r\n    queryFn: () => api.get<PaginatedResponse<Contact>>('/contacts/', { params }).then(res => res.data),\r\n    staleTime: 30000, // 30 seconds\r\n  });\r\n}\r\n\r\nexport function useContact(id: string, options?: UseQueryOptions<Contact>) {\r\n  return useQuery({\r\n    queryKey: queryKeys.contacts.detail(id),\r\n    queryFn: () => api.get<Contact>(`/contacts/${id}/`).then(res => res.data),\r\n    enabled: !!id,\r\n    ...options,\r\n  });\r\n}\r\n\r\nexport function useContactsInfinite(params: Omit<SearchParams, 'page'> = {}) {\r\n  return useInfiniteQuery({\r\n    queryKey: queryKeys.contacts.list(params),\r\n    queryFn: ({ pageParam = 1 }) =>\r\n      api.get<PaginatedResponse<Contact>>('/contacts/', {\r\n        params: { ...params, page: pageParam },\r\n      }).then(res => res.data),\r\n    getNextPageParam: (lastPage, allPages) => {\r\n      if (!lastPage.next) return undefined;\r\n      return allPages.length + 1;\r\n    },\r\n    initialPageParam: 1,\r\n  });\r\n}\r\n\r\nexport function useCreateContact(\r\n  options?: UseMutationOptions<Contact, Error, ContactCreatePayload>\r\n) {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: (data: ContactCreatePayload) =>\r\n      api.post<Contact>('/contacts/', data).then(res => res.data),\r\n    onSuccess: (newContact) => {\r\n      queryClient.invalidateQueries({ queryKey: queryKeys.contacts.lists() });\r\n      queryClient.setQueryData(\r\n        queryKeys.contacts.detail(newContact.id),\r\n        newContact\r\n      );\r\n      toast.success('Contact created successfully');\r\n    },\r\n    onError: (error) => {\r\n      toast.error(`Failed to create contact: ${error.message}`);\r\n    },\r\n    ...options,\r\n  });\r\n}\r\n\r\nexport function useUpdateContact(\r\n  options?: UseMutationOptions<Contact, Error, { id: string; data: ContactUpdatePayload }, { previousContact: Contact | undefined }>\r\n) {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: ({ id, data }) =>\r\n      api.patch<Contact>(`/contacts/${id}/`, data).then(res => res.data),\r\n    onMutate: async ({ id, data }) => {\r\n      // Cancel outgoing refetches\r\n      await queryClient.cancelQueries({ queryKey: queryKeys.contacts.detail(id) });\r\n\r\n      // Snapshot previous value\r\n      const previousContact = queryClient.getQueryData<Contact>(\r\n        queryKeys.contacts.detail(id)\r\n      );\r\n\r\n      // Optimistically update\r\n      if (previousContact) {\r\n        queryClient.setQueryData(queryKeys.contacts.detail(id), {\r\n          ...previousContact,\r\n          ...data,\r\n        });\r\n      }\r\n\r\n      return { previousContact };\r\n    },\r\n    onError: (error, variables, context) => {\r\n      // Rollback on error\r\n      if (context?.previousContact) {\r\n        queryClient.setQueryData(\r\n          queryKeys.contacts.detail(variables.id),\r\n          context.previousContact\r\n        );\r\n      }\r\n      toast.error(`Failed to update contact: ${error.message}`);\r\n    },\r\n    onSettled: (_, __, { id }) => {\r\n      queryClient.invalidateQueries({ queryKey: queryKeys.contacts.detail(id) });\r\n      queryClient.invalidateQueries({ queryKey: queryKeys.contacts.lists() });\r\n    },\r\n    ...options,\r\n  });\r\n}\r\n\r\nexport function useDeleteContact(\r\n  options?: UseMutationOptions<void, Error, string>\r\n) {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: (id: string) => api.delete(`/contacts/${id}/`).then(() => { }),\r\n    onSuccess: (_, id) => {\r\n      queryClient.invalidateQueries({ queryKey: queryKeys.contacts.lists() });\r\n      queryClient.removeQueries({ queryKey: queryKeys.contacts.detail(id) });\r\n      toast.success('Contact deleted successfully');\r\n    },\r\n    onError: (error) => {\r\n      toast.error(`Failed to delete contact: ${error.message}`);\r\n    },\r\n    ...options,\r\n  });\r\n}\r\n\r\nexport function useContactAnalytics() {\r\n  return useQuery({\r\n    queryKey: queryKeys.contacts.analytics(),\r\n    queryFn: () => api.get('/contacts/analytics/').then(res => res.data),\r\n    staleTime: 60000, // 1 minute\r\n  });\r\n}\r\n\r\n// ============================================================================\r\n// Lead Hooks\r\n// ============================================================================\r\n\r\nexport function useLeads(params: SearchParams = {}) {\r\n  return useQuery({\r\n    queryKey: queryKeys.leads.list(params),\r\n    queryFn: () => api.get<PaginatedResponse<Lead>>('/leads/', { params }).then(res => res.data),\r\n    staleTime: 30000,\r\n  });\r\n}\r\n\r\nexport function useLead(id: string) {\r\n  return useQuery({\r\n    queryKey: queryKeys.leads.detail(id),\r\n    queryFn: () => api.get<Lead>(`/leads/${id}/`).then(res => res.data),\r\n    enabled: !!id,\r\n  });\r\n}\r\n\r\nexport function useCreateLead() {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: (data: Partial<Lead>) => api.post<Lead>('/leads/', data).then(res => res.data),\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: queryKeys.leads.lists() });\r\n      toast.success('Lead created successfully');\r\n    },\r\n    onError: (error: Error) => {\r\n      toast.error(`Failed to create lead: ${error.message}`);\r\n    },\r\n  });\r\n}\r\n\r\nexport function useUpdateLead() {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: ({ id, data }: { id: string; data: Partial<Lead> }) =>\r\n      api.patch<Lead>(`/leads/${id}/`, data).then(res => res.data),\r\n    onSuccess: (_, { id }) => {\r\n      queryClient.invalidateQueries({ queryKey: queryKeys.leads.detail(id) });\r\n      queryClient.invalidateQueries({ queryKey: queryKeys.leads.lists() });\r\n      toast.success('Lead updated successfully');\r\n    },\r\n    onError: (error: Error) => {\r\n      toast.error(`Failed to update lead: ${error.message}`);\r\n    },\r\n  });\r\n}\r\n\r\nexport function useConvertLead() {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: ({ id, data }: { id: string; data: LeadConvertPayload }) =>\r\n      api.post(`/leads/${id}/convert/`, data).then(res => res.data),\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: queryKeys.leads.lists() });\r\n      queryClient.invalidateQueries({ queryKey: queryKeys.contacts.lists() });\r\n      queryClient.invalidateQueries({ queryKey: queryKeys.opportunities.lists() });\r\n      toast.success('Lead converted successfully');\r\n    },\r\n    onError: (error: Error) => {\r\n      toast.error(`Failed to convert lead: ${error.message}`);\r\n    },\r\n  });\r\n}\r\n\r\nexport function useLeadAnalytics() {\r\n  return useQuery({\r\n    queryKey: queryKeys.leads.analytics(),\r\n    queryFn: () => api.get('/leads/analytics/').then(res => res.data),\r\n    staleTime: 60000,\r\n  });\r\n}\r\n\r\n// ============================================================================\r\n// Opportunity Hooks\r\n// ============================================================================\r\n\r\nexport function useOpportunities(params: SearchParams = {}) {\r\n  return useQuery({\r\n    queryKey: queryKeys.opportunities.list(params),\r\n    queryFn: () =>\r\n      api.get<PaginatedResponse<Opportunity>>('/opportunities/', { params }).then(res => res.data),\r\n    staleTime: 30000,\r\n  });\r\n}\r\n\r\nexport function useOpportunity(id: string) {\r\n  return useQuery({\r\n    queryKey: queryKeys.opportunities.detail(id),\r\n    queryFn: () => api.get<Opportunity>(`/opportunities/${id}/`).then(res => res.data),\r\n    enabled: !!id,\r\n  });\r\n}\r\n\r\nexport function useOpportunitiesByPipeline(pipelineId: string) {\r\n  return useQuery({\r\n    queryKey: queryKeys.opportunities.byPipeline(pipelineId),\r\n    queryFn: () =>\r\n      api.get<Opportunity[]>(`/pipelines/${pipelineId}/opportunities/`).then(res => res.data),\r\n    enabled: !!pipelineId,\r\n  });\r\n}\r\n\r\nexport function useCreateOpportunity() {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: (data: OpportunityCreatePayload) =>\r\n      api.post<Opportunity>('/opportunities/', data).then(res => res.data),\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: queryKeys.opportunities.lists() });\r\n      queryClient.invalidateQueries({ queryKey: queryKeys.pipelines.all });\r\n      toast.success('Opportunity created successfully');\r\n    },\r\n    onError: (error: Error) => {\r\n      toast.error(`Failed to create opportunity: ${error.message}`);\r\n    },\r\n  });\r\n}\r\n\r\nexport function useMoveOpportunity() {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: ({ id, data }: { id: string; data: OpportunityMovePayload }) =>\r\n      api.patch<Opportunity>(`/opportunities/${id}/move/`, data).then(res => res.data),\r\n    onMutate: async ({ id, data }) => {\r\n      await queryClient.cancelQueries({\r\n        queryKey: queryKeys.opportunities.detail(id),\r\n      });\r\n\r\n      const previousOpportunity = queryClient.getQueryData<Opportunity>(\r\n        queryKeys.opportunities.detail(id)\r\n      );\r\n\r\n      // Optimistic update\r\n      if (previousOpportunity) {\r\n        queryClient.setQueryData(queryKeys.opportunities.detail(id), {\r\n          ...previousOpportunity,\r\n          stage_id: data.stage_id,\r\n          status: data.status || previousOpportunity.status,\r\n        });\r\n      }\r\n\r\n      return { previousOpportunity };\r\n    },\r\n    onError: (error: Error, variables, context) => {\r\n      if (context?.previousOpportunity) {\r\n        queryClient.setQueryData(\r\n          queryKeys.opportunities.detail(variables.id),\r\n          context.previousOpportunity\r\n        );\r\n      }\r\n      toast.error(`Failed to move opportunity: ${error.message}`);\r\n    },\r\n    onSettled: () => {\r\n      queryClient.invalidateQueries({ queryKey: queryKeys.opportunities.all });\r\n      queryClient.invalidateQueries({ queryKey: queryKeys.pipelines.all });\r\n    },\r\n  });\r\n}\r\n\r\nexport function useDeleteOpportunity() {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: (id: string) => api.delete(`/opportunities/${id}/`).then(() => { }),\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: queryKeys.opportunities.lists() });\r\n      toast.success('Opportunity deleted successfully');\r\n    },\r\n    onError: (error: Error) => {\r\n      toast.error(`Failed to delete opportunity: ${error.message}`);\r\n    },\r\n  });\r\n}\r\n\r\n// ============================================================================\r\n// Pipeline Hooks\r\n// ============================================================================\r\n\r\nexport function usePipelines() {\r\n  return useQuery({\r\n    queryKey: queryKeys.pipelines.lists(),\r\n    queryFn: () => api.get<Pipeline[]>('/pipelines/').then(res => res.data),\r\n    staleTime: 60000,\r\n  });\r\n}\r\n\r\nexport function usePipeline(id: string) {\r\n  return useQuery({\r\n    queryKey: queryKeys.pipelines.detail(id),\r\n    queryFn: () => api.get<Pipeline>(`/pipelines/${id}/`).then(res => res.data),\r\n    enabled: !!id,\r\n  });\r\n}\r\n\r\nexport function usePipelineStages(pipelineId: string) {\r\n  return useQuery({\r\n    queryKey: queryKeys.pipelines.stages(pipelineId),\r\n    queryFn: () => api.get<PipelineStage[]>(`/pipelines/${pipelineId}/stages/`).then(res => res.data),\r\n    enabled: !!pipelineId,\r\n  });\r\n}\r\n\r\n// ============================================================================\r\n// Task Hooks\r\n// ============================================================================\r\n\r\nexport function useTasks(params: SearchParams = {}) {\r\n  return useQuery({\r\n    queryKey: queryKeys.tasks.list(params),\r\n    queryFn: () => api.get<PaginatedResponse<Task>>('/tasks/', { params }).then(res => res.data),\r\n    staleTime: 30000,\r\n  });\r\n}\r\n\r\nexport function useTask(id: string) {\r\n  return useQuery({\r\n    queryKey: queryKeys.tasks.detail(id),\r\n    queryFn: () => api.get<Task>(`/tasks/${id}/`).then(res => res.data),\r\n    enabled: !!id,\r\n  });\r\n}\r\n\r\nexport function useMyTasks() {\r\n  return useQuery({\r\n    queryKey: queryKeys.tasks.myTasks(),\r\n    queryFn: () => api.get<Task[]>('/tasks/my/').then(res => res.data),\r\n    staleTime: 30000,\r\n  });\r\n}\r\n\r\nexport function useOverdueTasks() {\r\n  return useQuery({\r\n    queryKey: queryKeys.tasks.overdue(),\r\n    queryFn: () => api.get<Task[]>('/tasks/overdue/').then(res => res.data),\r\n    staleTime: 30000,\r\n    refetchInterval: 60000, // Refetch every minute\r\n  });\r\n}\r\n\r\nexport function useCreateTask() {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: (data: TaskCreatePayload) => api.post<Task>('/tasks/', data).then(res => res.data),\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: queryKeys.tasks.all });\r\n      toast.success('Task created successfully');\r\n    },\r\n    onError: (error: Error) => {\r\n      toast.error(`Failed to create task: ${error.message}`);\r\n    },\r\n  });\r\n}\r\n\r\nexport function useUpdateTask() {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: ({ id, data }: { id: string; data: Partial<Task> }) =>\r\n      api.patch<Task>(`/tasks/${id}/`, data).then(res => res.data),\r\n    onSuccess: (_, { id }) => {\r\n      queryClient.invalidateQueries({ queryKey: queryKeys.tasks.detail(id) });\r\n      queryClient.invalidateQueries({ queryKey: queryKeys.tasks.lists() });\r\n    },\r\n    onError: (error: Error) => {\r\n      toast.error(`Failed to update task: ${error.message}`);\r\n    },\r\n  });\r\n}\r\n\r\nexport function useCompleteTask() {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: ({ id, outcome }: { id: string; outcome?: string }) =>\r\n      api.post(`/tasks/${id}/complete/`, { outcome }).then(res => res.data),\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: queryKeys.tasks.all });\r\n      toast.success('Task completed');\r\n    },\r\n    onError: (error: Error) => {\r\n      toast.error(`Failed to complete task: ${error.message}`);\r\n    },\r\n  });\r\n}\r\n\r\n// ============================================================================\r\n// Dashboard Hooks\r\n// ============================================================================\r\n\r\nexport function useDashboardMetrics() {\r\n  return useQuery({\r\n    queryKey: queryKeys.dashboard.metrics(),\r\n    queryFn: () => api.get<DashboardMetrics>('/dashboard/metrics/').then(res => res.data),\r\n    staleTime: 60000,\r\n    refetchInterval: 300000, // Refetch every 5 minutes\r\n  });\r\n}\r\n\r\nexport function useRecentActivities(limit = 10) {\r\n  return useQuery({\r\n    queryKey: [...queryKeys.dashboard.activities(), limit],\r\n    queryFn: () => api.get('/activities/recent/', { params: { limit } }).then(res => res.data),\r\n    staleTime: 30000,\r\n  });\r\n}\r\n\r\nexport function useTeamPerformance(period: 'week' | 'month' | 'quarter' = 'month') {\r\n  return useQuery({\r\n    queryKey: [...queryKeys.dashboard.performance(), period],\r\n    queryFn: () => api.get('/reports/team-performance/', { params: { period } }).then(res => res.data),\r\n    staleTime: 60000,\r\n  });\r\n}\r\n\r\n// ============================================================================\r\n// User & Team Hooks\r\n// ============================================================================\r\n\r\nexport function useCurrentUser() {\r\n  return useQuery({\r\n    queryKey: queryKeys.users.me(),\r\n    queryFn: () => api.get<User>('/users/me/').then(res => res.data),\r\n    staleTime: 300000, // 5 minutes\r\n  });\r\n}\r\n\r\nexport function useUsers() {\r\n  return useQuery({\r\n    queryKey: queryKeys.users.list(),\r\n    queryFn: () => api.get<User[]>('/users/').then(res => res.data),\r\n    staleTime: 60000,\r\n  });\r\n}\r\n\r\nexport function useTeams() {\r\n  return useQuery({\r\n    queryKey: queryKeys.teams.list(),\r\n    queryFn: () => api.get<Team[]>('/teams/').then(res => res.data),\r\n    staleTime: 60000,\r\n  });\r\n}\r\n\r\nexport function useTeam(id: string) {\r\n  return useQuery({\r\n    queryKey: queryKeys.teams.detail(id),\r\n    queryFn: () => api.get<Team>(`/teams/${id}/`).then(res => res.data),\r\n    enabled: !!id,\r\n  });\r\n}\r\n\r\n// ============================================================================\r\n// Utility Hooks\r\n// ============================================================================\r\n\r\n/**\r\n * Hook to prefetch data for better UX\r\n */\r\nexport function usePrefetch() {\r\n  const queryClient = useQueryClient();\r\n\r\n  return {\r\n    prefetchContact: (id: string) => {\r\n      queryClient.prefetchQuery({\r\n        queryKey: queryKeys.contacts.detail(id),\r\n        queryFn: () => api.get<Contact>(`/contacts/${id}/`).then(res => res.data),\r\n      });\r\n    },\r\n    prefetchLead: (id: string) => {\r\n      queryClient.prefetchQuery({\r\n        queryKey: queryKeys.leads.detail(id),\r\n        queryFn: () => api.get<Lead>(`/leads/${id}/`).then(res => res.data),\r\n      });\r\n    },\r\n    prefetchOpportunity: (id: string) => {\r\n      queryClient.prefetchQuery({\r\n        queryKey: queryKeys.opportunities.detail(id),\r\n        queryFn: () => api.get<Opportunity>(`/opportunities/${id}/`).then(res => res.data),\r\n      });\r\n    },\r\n  };\r\n}\r\n\r\n/**\r\n * Hook to invalidate related queries after bulk operations\r\n */\r\nexport function useInvalidateRelated() {\r\n  const queryClient = useQueryClient();\r\n\r\n  return {\r\n    invalidateAll: () => {\r\n      queryClient.invalidateQueries();\r\n    },\r\n    invalidateSalesData: () => {\r\n      queryClient.invalidateQueries({ queryKey: queryKeys.contacts.all });\r\n      queryClient.invalidateQueries({ queryKey: queryKeys.leads.all });\r\n      queryClient.invalidateQueries({ queryKey: queryKeys.opportunities.all });\r\n      queryClient.invalidateQueries({ queryKey: queryKeys.dashboard.all });\r\n    },\r\n  };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\lib\\ai-workflow-api.ts","messages":[{"ruleId":"import/no-anonymous-default-export","severity":1,"message":"Assign object to a variable before exporting as module default","line":462,"column":1,"nodeType":"ExportDefaultDeclaration","endLine":469,"endColumn":3}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * AI Workflow Automation API - Email Sequence Automation, Predictive Lead Routing,\r\n * Smart Scheduling AI, Data Enrichment, and Voice Intelligence\r\n */\r\n\r\nimport axios from 'axios';\r\n\r\nconst API_BASE_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000/api';\r\n\r\n// Create axios instance with interceptors\r\nconst apiClient = axios.create({\r\n  baseURL: API_BASE_URL,\r\n  timeout: 30000,\r\n  headers: {\r\n    'Content-Type': 'application/json',\r\n  },\r\n});\r\n\r\n// Request interceptor to add auth token\r\napiClient.interceptors.request.use(\r\n  (config) => {\r\n    const token = localStorage.getItem('access_token');\r\n    if (token) {\r\n      config.headers.Authorization = `Bearer ${token}`;\r\n    }\r\n    return config;\r\n  },\r\n  (error) => Promise.reject(error)\r\n);\r\n\r\n// Response interceptor to handle token refresh\r\napiClient.interceptors.response.use(\r\n  (response) => response,\r\n  async (error) => {\r\n    const originalRequest = error.config;\r\n    if (error.response?.status === 401 && !originalRequest._retry) {\r\n      originalRequest._retry = true;\r\n      try {\r\n        const refreshToken = localStorage.getItem('refresh_token');\r\n        if (refreshToken) {\r\n          const response = await axios.post(`${API_BASE_URL}/auth/refresh/`, {\r\n            refresh: refreshToken,\r\n          });\r\n          const { access } = response.data;\r\n          localStorage.setItem('access_token', access);\r\n          originalRequest.headers.Authorization = `Bearer ${access}`;\r\n          return apiClient(originalRequest);\r\n        }\r\n      } catch {\r\n        localStorage.removeItem('access_token');\r\n        localStorage.removeItem('refresh_token');\r\n        window.location.href = '/login';\r\n      }\r\n    }\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// ==================== Email Sequence Automation API ====================\r\nexport const emailSequenceAPI = {\r\n  // Sequences\r\n  getSequences: (params?: Record<string, unknown>) =>\r\n    apiClient.get('/v1/email-sequences/sequences/', { params }),\r\n  getSequence: (id: string) =>\r\n    apiClient.get(`/v1/email-sequences/sequences/${id}/`),\r\n  createSequence: (data: Record<string, unknown>) =>\r\n    apiClient.post('/v1/email-sequences/sequences/', data),\r\n  updateSequence: (id: string, data: Record<string, unknown>) =>\r\n    apiClient.patch(`/v1/email-sequences/sequences/${id}/`, data),\r\n  deleteSequence: (id: string) =>\r\n    apiClient.delete(`/v1/email-sequences/sequences/${id}/`),\r\n  activateSequence: (id: string) =>\r\n    apiClient.post(`/v1/email-sequences/sequences/${id}/activate/`),\r\n  pauseSequence: (id: string) =>\r\n    apiClient.post(`/v1/email-sequences/sequences/${id}/pause/`),\r\n  cloneSequence: (id: string) =>\r\n    apiClient.post(`/v1/email-sequences/sequences/${id}/clone/`),\r\n  getSequenceAnalytics: (id: string) =>\r\n    apiClient.get(`/v1/email-sequences/sequences/${id}/analytics/`),\r\n\r\n  // Sequence Steps\r\n  getSteps: (sequenceId: string) =>\r\n    apiClient.get(`/v1/email-sequences/sequences/${sequenceId}/steps/`),\r\n  createStep: (sequenceId: string, data: Record<string, unknown>) =>\r\n    apiClient.post(`/v1/email-sequences/sequences/${sequenceId}/steps/`, data),\r\n  updateStep: (sequenceId: string, stepId: string, data: Record<string, unknown>) =>\r\n    apiClient.patch(`/v1/email-sequences/sequences/${sequenceId}/steps/${stepId}/`, data),\r\n  deleteStep: (sequenceId: string, stepId: string) =>\r\n    apiClient.delete(`/v1/email-sequences/sequences/${sequenceId}/steps/${stepId}/`),\r\n  reorderSteps: (sequenceId: string, data: { step_ids: string[] }) =>\r\n    apiClient.post(`/v1/email-sequences/sequences/${sequenceId}/reorder_steps/`, data),\r\n\r\n  // Enrollments\r\n  getEnrollments: (params?: Record<string, unknown>) =>\r\n    apiClient.get('/v1/email-sequences/enrollments/', { params }),\r\n  enrollContact: (data: { sequence_id: string; contact_id?: string; lead_id?: string }) =>\r\n    apiClient.post('/v1/email-sequences/enrollments/', data),\r\n  bulkEnroll: (data: { sequence_id: string; contact_ids?: string[]; lead_ids?: string[] }) =>\r\n    apiClient.post('/v1/email-sequences/enrollments/bulk_enroll/', data),\r\n  unenroll: (enrollmentId: string) =>\r\n    apiClient.post(`/v1/email-sequences/enrollments/${enrollmentId}/unenroll/`),\r\n  pauseEnrollment: (enrollmentId: string) =>\r\n    apiClient.post(`/v1/email-sequences/enrollments/${enrollmentId}/pause/`),\r\n  resumeEnrollment: (enrollmentId: string) =>\r\n    apiClient.post(`/v1/email-sequences/enrollments/${enrollmentId}/resume/`),\r\n\r\n  // A/B Tests\r\n  getABTests: (params?: Record<string, unknown>) =>\r\n    apiClient.get('/v1/email-sequences/ab-tests/', { params }),\r\n  createABTest: (data: Record<string, unknown>) =>\r\n    apiClient.post('/v1/email-sequences/ab-tests/', data),\r\n  getABTestResults: (id: string) =>\r\n    apiClient.get(`/v1/email-sequences/ab-tests/${id}/results/`),\r\n  selectWinner: (id: string, data: { variant: 'A' | 'B' }) =>\r\n    apiClient.post(`/v1/email-sequences/ab-tests/${id}/select_winner/`, data),\r\n\r\n  // Automated Triggers\r\n  getTriggers: (params?: Record<string, unknown>) =>\r\n    apiClient.get('/v1/email-sequences/triggers/', { params }),\r\n  createTrigger: (data: Record<string, unknown>) =>\r\n    apiClient.post('/v1/email-sequences/triggers/', data),\r\n  updateTrigger: (id: string, data: Record<string, unknown>) =>\r\n    apiClient.patch(`/v1/email-sequences/triggers/${id}/`, data),\r\n  deleteTrigger: (id: string) =>\r\n    apiClient.delete(`/v1/email-sequences/triggers/${id}/`),\r\n\r\n  // AI Content\r\n  generateContent: (data: { step_id: string; context?: Record<string, unknown> }) =>\r\n    apiClient.post('/v1/email-sequences/generate-content/', data),\r\n  previewPersonalization: (data: { template: string; contact_id?: string; lead_id?: string }) =>\r\n    apiClient.post('/v1/email-sequences/preview-personalization/', data),\r\n};\r\n\r\n// ==================== Predictive Lead Routing API ====================\r\nexport const leadRoutingAPI = {\r\n  // Sales Rep Profiles\r\n  getRepProfiles: (params?: Record<string, unknown>) =>\r\n    apiClient.get('/v1/lead-routing/rep-profiles/', { params }),\r\n  getRepProfile: (id: string) =>\r\n    apiClient.get(`/v1/lead-routing/rep-profiles/${id}/`),\r\n  createRepProfile: (data: Record<string, unknown>) =>\r\n    apiClient.post('/v1/lead-routing/rep-profiles/', data),\r\n  updateRepProfile: (id: string, data: Record<string, unknown>) =>\r\n    apiClient.patch(`/v1/lead-routing/rep-profiles/${id}/`, data),\r\n  getRepPerformance: (id: string) =>\r\n    apiClient.get(`/v1/lead-routing/rep-profiles/${id}/performance/`),\r\n  updateAvailability: (id: string, data: { is_available: boolean }) =>\r\n    apiClient.post(`/v1/lead-routing/rep-profiles/${id}/update_availability/`, data),\r\n\r\n  // Routing Rules\r\n  getRoutingRules: (params?: Record<string, unknown>) =>\r\n    apiClient.get('/v1/lead-routing/rules/', { params }),\r\n  getRoutingRule: (id: string) =>\r\n    apiClient.get(`/v1/lead-routing/rules/${id}/`),\r\n  createRoutingRule: (data: Record<string, unknown>) =>\r\n    apiClient.post('/v1/lead-routing/rules/', data),\r\n  updateRoutingRule: (id: string, data: Record<string, unknown>) =>\r\n    apiClient.patch(`/v1/lead-routing/rules/${id}/`, data),\r\n  deleteRoutingRule: (id: string) =>\r\n    apiClient.delete(`/v1/lead-routing/rules/${id}/`),\r\n  testRule: (id: string, data: { lead_id: string }) =>\r\n    apiClient.post(`/v1/lead-routing/rules/${id}/test/`, data),\r\n  reorderRules: (data: { rule_ids: string[] }) =>\r\n    apiClient.post('/v1/lead-routing/rules/reorder/', data),\r\n\r\n  // Lead Assignments\r\n  getAssignments: (params?: Record<string, unknown>) =>\r\n    apiClient.get('/v1/lead-routing/assignments/', { params }),\r\n  getAssignment: (id: string) =>\r\n    apiClient.get(`/v1/lead-routing/assignments/${id}/`),\r\n  routeLead: (data: { lead_id: string }) =>\r\n    apiClient.post('/v1/lead-routing/assignments/route_lead/', data),\r\n  reassignLead: (id: string, data: { new_rep_id: string; reason?: string }) =>\r\n    apiClient.post(`/v1/lead-routing/assignments/${id}/reassign/`, data),\r\n  acceptAssignment: (id: string) =>\r\n    apiClient.post(`/v1/lead-routing/assignments/${id}/accept/`),\r\n  rejectAssignment: (id: string, data: { reason: string }) =>\r\n    apiClient.post(`/v1/lead-routing/assignments/${id}/reject/`, data),\r\n\r\n  // Escalation Rules\r\n  getEscalationRules: (params?: Record<string, unknown>) =>\r\n    apiClient.get('/v1/lead-routing/escalations/', { params }),\r\n  createEscalationRule: (data: Record<string, unknown>) =>\r\n    apiClient.post('/v1/lead-routing/escalations/', data),\r\n  updateEscalationRule: (id: string, data: Record<string, unknown>) =>\r\n    apiClient.patch(`/v1/lead-routing/escalations/${id}/`, data),\r\n\r\n  // Analytics\r\n  getRoutingAnalytics: (params?: Record<string, unknown>) =>\r\n    apiClient.get('/v1/lead-routing/analytics/', { params }),\r\n  getRoutingDashboard: () =>\r\n    apiClient.get('/v1/lead-routing/dashboard/'),\r\n};\r\n\r\n// ==================== Smart Scheduling AI API ====================\r\nexport const schedulingAIAPI = {\r\n  // AI Preferences\r\n  getAIPreferences: () =>\r\n    apiClient.get('/v1/scheduling/ai/preferences/'),\r\n  getPreferences: () =>\r\n    apiClient.get('/v1/scheduling/ai/preferences/'),\r\n  updatePreferences: (data: Record<string, unknown>) =>\r\n    apiClient.patch('/v1/scheduling/ai/preferences/', data),\r\n\r\n  // Optimal Time Finder\r\n  findOptimalSlots: (duration: number, date: string) =>\r\n    apiClient.get('/v1/scheduling/ai/find-optimal-slots/', { params: { duration, date } }),\r\n  findOptimalTimes: (data: {\r\n    contact_id?: string;\r\n    lead_id?: string;\r\n    meeting_type?: string;\r\n    duration_minutes?: number;\r\n    date_range_days?: number;\r\n  }) => apiClient.post('/v1/scheduling/ai/find-optimal-times/', data),\r\n\r\n  // Meeting Prep\r\n  getMeetingPreps: (params?: Record<string, unknown>) =>\r\n    apiClient.get('/v1/scheduling/ai/meeting-prep/', { params }),\r\n  getMeetingPrep: (meetingId: string) =>\r\n    apiClient.get(`/v1/scheduling/ai/meeting-prep/${meetingId}/`),\r\n  generateMeetingPrep: (meetingId: number) =>\r\n    apiClient.post(`/v1/scheduling/ai/meeting-prep/${meetingId}/generate/`),\r\n  regenerateMeetingPrep: (meetingId: string) =>\r\n    apiClient.post(`/v1/scheduling/ai/meeting-prep/${meetingId}/regenerate/`),\r\n\r\n  // No-Show Predictions\r\n  getNoShowPredictions: (params?: Record<string, unknown>) =>\r\n    apiClient.get('/v1/scheduling/ai/no-show-predictions/', { params }),\r\n  predictNoShow: (meetingId: string) =>\r\n    apiClient.post(`/v1/scheduling/ai/no-show-predictions/predict/${meetingId}/`),\r\n\r\n  // Smart Reminders\r\n  getSmartReminders: (params?: Record<string, unknown>) =>\r\n    apiClient.get('/v1/scheduling/ai/smart-reminders/', { params }),\r\n  sendReminder: (reminderId: string) =>\r\n    apiClient.post(`/v1/scheduling/ai/smart-reminders/${reminderId}/send/`),\r\n\r\n  // Meeting Insights\r\n  getMeetingInsights: (params?: Record<string, unknown>) =>\r\n    apiClient.get('/v1/scheduling/ai/insights/', { params }),\r\n  getMeetingInsight: (id: string) =>\r\n    apiClient.get(`/v1/scheduling/ai/insights/${id}/`),\r\n  generateInsights: (meetingId: string, data: { notes?: string }) =>\r\n    apiClient.post(`/v1/scheduling/ai/insights/generate/${meetingId}/`, data),\r\n\r\n  // Meeting Follow-Ups\r\n  getFollowUps: (params?: Record<string, unknown>) =>\r\n    apiClient.get('/v1/scheduling/ai/follow-ups/', { params }),\r\n  generateFollowUp: (meetingId: string) =>\r\n    apiClient.post(`/v1/scheduling/ai/follow-ups/generate/${meetingId}/`),\r\n  sendFollowUp: (followUpId: string) =>\r\n    apiClient.post(`/v1/scheduling/ai/follow-ups/${followUpId}/send/`),\r\n\r\n  // Schedule Optimization\r\n  getOptimizations: () =>\r\n    apiClient.get('/v1/scheduling/ai/optimizations/'),\r\n  applyOptimization: (id: string) =>\r\n    apiClient.post(`/v1/scheduling/ai/optimizations/${id}/apply/`),\r\n\r\n  // Booking Suggestions\r\n  getBookingSuggestions: (params?: Record<string, unknown>) =>\r\n    apiClient.get('/v1/scheduling/ai/booking-suggestions/', { params }),\r\n};\r\n\r\n// ==================== Data Enrichment API ====================\r\nexport const dataEnrichmentAPI = {\r\n  // Providers\r\n  getProviders: (params?: Record<string, unknown>) =>\r\n    apiClient.get('/v1/data-enrichment/providers/', { params }),\r\n  getProvider: (id: string) =>\r\n    apiClient.get(`/v1/data-enrichment/providers/${id}/`),\r\n  configureProvider: (id: string, data: Record<string, unknown>) =>\r\n    apiClient.patch(`/v1/data-enrichment/providers/${id}/`, data),\r\n  testProvider: (id: string) =>\r\n    apiClient.post(`/v1/data-enrichment/providers/${id}/test/`),\r\n\r\n  // Enrichment Profiles\r\n  getProfiles: (params?: Record<string, unknown>) =>\r\n    apiClient.get('/v1/data-enrichment/profiles/', { params }),\r\n  getEnrichmentProfiles: (params?: Record<string, unknown>) =>\r\n    apiClient.get('/v1/data-enrichment/profiles/', { params }),\r\n  getEnrichmentProfile: (id: string) =>\r\n    apiClient.get(`/v1/data-enrichment/profiles/${id}/`),\r\n  createProfile: (data: Record<string, unknown>) =>\r\n    apiClient.post('/v1/data-enrichment/profiles/', data),\r\n  updateProfile: (id: string, data: Record<string, unknown>) =>\r\n    apiClient.patch(`/v1/data-enrichment/profiles/${id}/`, data),\r\n  deleteProfile: (id: string) =>\r\n    apiClient.delete(`/v1/data-enrichment/profiles/${id}/`),\r\n  triggerEnrichment: (profileId: number, recordType: string, recordIds: number[]) =>\r\n    apiClient.post(`/v1/data-enrichment/profiles/${profileId}/trigger/`, { record_type: recordType, record_ids: recordIds }),\r\n  enrichContact: (contactId: string) =>\r\n    apiClient.post(`/v1/data-enrichment/profiles/enrich-contact/${contactId}/`),\r\n  enrichLead: (leadId: string) =>\r\n    apiClient.post(`/v1/data-enrichment/profiles/enrich-lead/${leadId}/`),\r\n  bulkEnrich: (data: { contact_ids?: string[]; lead_ids?: string[] }) =>\r\n    apiClient.post('/v1/data-enrichment/profiles/bulk-enrich/', data),\r\n  refreshEnrichment: (id: string) =>\r\n    apiClient.post(`/v1/data-enrichment/profiles/${id}/refresh/`),\r\n\r\n  // Enrichment Jobs\r\n  getJobs: (params?: Record<string, unknown>) =>\r\n    apiClient.get('/v1/data-enrichment/jobs/', { params }),\r\n  getEnrichmentJobs: (params?: Record<string, unknown>) =>\r\n    apiClient.get('/v1/data-enrichment/jobs/', { params }),\r\n  getEnrichmentJob: (id: string) =>\r\n    apiClient.get(`/v1/data-enrichment/jobs/${id}/`),\r\n  createEnrichmentJob: (data: Record<string, unknown>) =>\r\n    apiClient.post('/v1/data-enrichment/jobs/', data),\r\n  cancelJob: (id: string) =>\r\n    apiClient.post(`/v1/data-enrichment/jobs/${id}/cancel/`),\r\n\r\n  // Company Enrichment\r\n  getCompanyEnrichments: (params?: Record<string, unknown>) =>\r\n    apiClient.get('/v1/data-enrichment/companies/', { params }),\r\n  getCompanyEnrichment: (id: string) =>\r\n    apiClient.get(`/v1/data-enrichment/companies/${id}/`),\r\n  enrichCompany: (data: { domain?: string; company_name?: string }) =>\r\n    apiClient.post('/v1/data-enrichment/companies/enrich/', data),\r\n\r\n  // Technographics\r\n  getTechnographics: (params?: Record<string, unknown>) =>\r\n    apiClient.get('/v1/data-enrichment/technographics/', { params }),\r\n  getTechnographic: (id: string) =>\r\n    apiClient.get(`/v1/data-enrichment/technographics/${id}/`),\r\n\r\n  // Intent Signals\r\n  getIntentSignals: (params?: Record<string, unknown>) =>\r\n    apiClient.get('/v1/data-enrichment/intent-signals/', { params }),\r\n  getIntentSignal: (id: string) =>\r\n    apiClient.get(`/v1/data-enrichment/intent-signals/${id}/`),\r\n  markSignalActioned: (id: string) =>\r\n    apiClient.post(`/v1/data-enrichment/intent-signals/${id}/mark-actioned/`),\r\n\r\n  // News Alerts\r\n  getNewsAlerts: (params?: Record<string, unknown>) =>\r\n    apiClient.get('/v1/data-enrichment/news/', { params }),\r\n  dismissAlert: (id: string) =>\r\n    apiClient.post(`/v1/data-enrichment/news/${id}/dismiss/`),\r\n\r\n  // Social Profiles\r\n  getSocialProfiles: (params?: Record<string, unknown>) =>\r\n    apiClient.get('/v1/data-enrichment/social/', { params }),\r\n\r\n  // Data Quality\r\n  getDataQualityScores: (params?: Record<string, unknown>) =>\r\n    apiClient.get('/v1/data-enrichment/quality-scores/', { params }),\r\n  getDataQualityScore: (id: string) =>\r\n    apiClient.get(`/v1/data-enrichment/quality-scores/${id}/`),\r\n  calculateQualityScore: (data: { contact_id?: string; lead_id?: string }) =>\r\n    apiClient.post('/v1/data-enrichment/quality-scores/calculate/', data),\r\n\r\n  // Dashboard & Analytics\r\n  getDashboard: () =>\r\n    apiClient.get('/v1/data-enrichment/dashboard/'),\r\n  getAnalytics: (params?: Record<string, unknown>) =>\r\n    apiClient.get('/v1/data-enrichment/analytics/', { params }),\r\n};\r\n\r\n// ==================== Voice Intelligence API ====================\r\nexport const voiceIntelligenceAPI = {\r\n  // Recordings\r\n  getRecordings: (params?: Record<string, unknown>) =>\r\n    apiClient.get('/v1/voice-intelligence/recordings/', { params }),\r\n  getRecording: (id: string) =>\r\n    apiClient.get(`/v1/voice-intelligence/recordings/${id}/`),\r\n  uploadRecording: (formData: FormData) =>\r\n    apiClient.post('/v1/voice-intelligence/recordings/', formData, {\r\n      headers: { 'Content-Type': 'multipart/form-data' },\r\n    }),\r\n  deleteRecording: (id: string) =>\r\n    apiClient.delete(`/v1/voice-intelligence/recordings/${id}/`),\r\n  processRecording: (id: string, options?: Record<string, boolean>) =>\r\n    apiClient.post(`/v1/voice-intelligence/recordings/${id}/process/`, options),\r\n  transcribeRecording: (id: string) =>\r\n    apiClient.post(`/v1/voice-intelligence/recordings/${id}/transcribe/`),\r\n  analyzeRecording: (id: string) =>\r\n    apiClient.post(`/v1/voice-intelligence/recordings/${id}/analyze/`),\r\n\r\n  // Transcription\r\n  getTranscription: (recordingId: string) =>\r\n    apiClient.get(`/v1/voice-intelligence/recordings/${recordingId}/transcription/`),\r\n  editTranscription: (recordingId: string, data: { full_text: string; segments?: Record<string, unknown>[] }) =>\r\n    apiClient.patch(`/v1/voice-intelligence/recordings/${recordingId}/edit_transcription/`, data),\r\n\r\n  // Summaries\r\n  getSummaries: (recordingId: string) =>\r\n    apiClient.get(`/v1/voice-intelligence/recordings/${recordingId}/summaries/`),\r\n  generateSummary: (recordingId: string, data: { summary_type: string }) =>\r\n    apiClient.post(`/v1/voice-intelligence/recordings/${recordingId}/generate_summary/`, data),\r\n\r\n  // Action Items\r\n  getActionItems: (params?: Record<string, unknown>) =>\r\n    apiClient.get('/v1/voice-intelligence/action-items/', { params }),\r\n  getRecordingActionItems: (recordingId: string) =>\r\n    apiClient.get(`/v1/voice-intelligence/recordings/${recordingId}/action_items/`),\r\n  updateActionItem: (id: string, data: Record<string, unknown>) =>\r\n    apiClient.patch(`/v1/voice-intelligence/action-items/${id}/`, data),\r\n  confirmActionItem: (id: string) =>\r\n    apiClient.post(`/v1/voice-intelligence/action-items/${id}/confirm/`),\r\n  createTaskFromActionItem: (id: string) =>\r\n    apiClient.post(`/v1/voice-intelligence/action-items/${id}/create_task/`),\r\n  bulkUpdateActionItems: (data: {\r\n    action_item_ids: string[];\r\n    status?: string;\r\n    priority?: string;\r\n    assigned_to?: string;\r\n  }) => apiClient.post('/v1/voice-intelligence/action-items/bulk_update/', data),\r\n\r\n  // Key Moments\r\n  getKeyMoments: (recordingId: string) =>\r\n    apiClient.get(`/v1/voice-intelligence/recordings/${recordingId}/key_moments/`),\r\n  addKeyMoment: (recordingId: string, data: Record<string, unknown>) =>\r\n    apiClient.post(`/v1/voice-intelligence/recordings/${recordingId}/add_key_moment/`, data),\r\n\r\n  // Call Scores\r\n  getCallScore: (recordingId: string) =>\r\n    apiClient.get(`/v1/voice-intelligence/recordings/${recordingId}/call_score/`),\r\n\r\n  // Voice Notes\r\n  getVoiceNotes: (params?: Record<string, unknown>) =>\r\n    apiClient.get('/v1/voice-intelligence/voice-notes/', { params }),\r\n  getVoiceNote: (id: string) =>\r\n    apiClient.get(`/v1/voice-intelligence/voice-notes/${id}/`),\r\n  createVoiceNote: (formData: FormData) =>\r\n    apiClient.post('/v1/voice-intelligence/voice-notes/', formData, {\r\n      headers: { 'Content-Type': 'multipart/form-data' },\r\n    }),\r\n  deleteVoiceNote: (id: string) =>\r\n    apiClient.delete(`/v1/voice-intelligence/voice-notes/${id}/`),\r\n  getVoiceNotesForContact: (contactId: string) =>\r\n    apiClient.get('/v1/voice-intelligence/voice-notes/for_contact/', { params: { contact_id: contactId } }),\r\n  getVoiceNotesForLead: (leadId: string) =>\r\n    apiClient.get('/v1/voice-intelligence/voice-notes/for_lead/', { params: { lead_id: leadId } }),\r\n\r\n  // Categories\r\n  getCategories: (params?: Record<string, unknown>) =>\r\n    apiClient.get('/v1/voice-intelligence/categories/', { params }),\r\n  createCategory: (data: Record<string, unknown>) =>\r\n    apiClient.post('/v1/voice-intelligence/categories/', data),\r\n  getCategoryTree: () =>\r\n    apiClient.get('/v1/voice-intelligence/categories/tree/'),\r\n  categorizeRecording: (recordingId: string, data: { category_ids: string[] }) =>\r\n    apiClient.post(`/v1/voice-intelligence/recordings/${recordingId}/categorize/`, data),\r\n\r\n  // Settings\r\n  getSettings: () =>\r\n    apiClient.get('/v1/voice-intelligence/settings/'),\r\n  updateSettings: (data: Record<string, unknown>) =>\r\n    apiClient.patch('/v1/voice-intelligence/settings/', data),\r\n\r\n  // Search & Analytics\r\n  searchRecordings: (params: Record<string, unknown>) =>\r\n    apiClient.get('/v1/voice-intelligence/recordings/search/', { params }),\r\n  getAnalytics: (params?: Record<string, unknown>) =>\r\n    apiClient.get('/v1/voice-intelligence/recordings/analytics/', { params }),\r\n};\r\n\r\n// Alias for backward compatibility\r\nexport const smartSchedulingAIAPI = schedulingAIAPI;\r\n\r\nexport default {\r\n  emailSequence: emailSequenceAPI,\r\n  leadRouting: leadRoutingAPI,\r\n  schedulingAI: schedulingAIAPI,\r\n  smartSchedulingAI: schedulingAIAPI,\r\n  dataEnrichment: dataEnrichmentAPI,\r\n  voiceIntelligence: voiceIntelligenceAPI,\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\lib\\animations.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\lib\\api.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\lib\\design-api.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":55,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":55,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1442,1445],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1442,1445],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":72,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":72,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1963,1966],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1963,1966],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":86,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":86,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2416,2419],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2416,2419],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":88,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":88,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2514,2517],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2514,2517],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":102,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":102,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2870,2873],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2870,2873],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\lib\\enterprise-api.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":8,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[228,231],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[228,231],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":24,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":24,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[716,719],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[716,719],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":35,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":35,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1012,1015],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1012,1015],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":64,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":64,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1819,1822],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1819,1822],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":69,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":69,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1987,1990],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1987,1990],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":82,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":82,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2342,2345],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2342,2345],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\lib\\graphql-client.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\lib\\new-features-api.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\lib\\premium-features-api.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\lib\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\providers\\QueryProvider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\src\\types\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\SaaS_Tools\\MyCRM\\frontend\\tailwind.config.enhanced.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":268,"column":5,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":268,"endColumn":35,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":270,"column":5,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":270,"endColumn":39,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":272,"column":5,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":272,"endColumn":39,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":274,"column":5,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":274,"endColumn":34,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":276,"column":5,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":276,"endColumn":41,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]